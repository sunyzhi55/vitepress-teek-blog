---
title: ç¬¬å››è®² Â· æ•°å­¦çŸ¥è¯†
date: 2025-10-21 22:01:00
titleTag: åŸåˆ›
top: true
coverImg: /home/bg4.webp
permalink: /algorithms/acwing-base/math-knowledge
categories:
  - ç®—æ³•ç¬”è®°
  - AcWingBase
tags:
  - ç®—æ³•ç¬”è®°
  - AcWingBase
  - C++
  - Algorithm
  - Number Theory
  - Math
---



<p align="center">
  <img src="https://capsule-render.vercel.app/api?type=waving&color=0:89D6FB,35:A3E4DB,75:FFD5B8,100:FFB085&height=230&text=ğŸ§®%20ç¬¬å››è®²%20Â·%20æ•°å­¦çŸ¥è¯†&desc=Mathematics%20is%20the%20queen%20of%20the%20sciences...&descAlign=50&descAlignY=75&fontSize=54&fontColor=D4AF37&fontAlignY=42&animation=twinkling" alt="ç¬¬å››è®² Â· æ•°å­¦çŸ¥è¯† Banner"/>
</p>





<p align="center">
  <img src="https://capsule-render.vercel.app/api?type=waving&color=0:89D6FB,35:A3E4DB,75:FFD5B8,100:FFB085&height=230&text=ğŸ§®%20ç¬¬å››è®²%20Â·%20æ•°å­¦çŸ¥è¯†&desc=Mathematics%20is%20the%20queen%20of%20the%20sciences...&descAlign=50&descAlignY=75&fontSize=54&fontColor=9B59B6&fontAlignY=42&animation=twinkling" alt="ç¬¬å››è®² Â· æ•°å­¦çŸ¥è¯† Banner"/>
</p>




<p align="center">
  <img src="https://capsule-render.vercel.app/api?type=waving&color=0:A3E4DB,40:FFDAB3,100:FFB085&height=220&text=ğŸ“%20AcWing%20ç®—æ³•åŸºç¡€è¯¾&desc=å°†æŠ½è±¡çš„ç†è®ºè½¬åŒ–ä¸ºè§£å†³é—®é¢˜çš„å¼ºå¤§æ­¦å™¨&descAlign=50&descAlignY=75&fontSize=50&fontColor=D4AFD7&fontAlignY=42&animation=twinkling" alt="AcWing ç®—æ³•åŸºç¡€è¯¾ Banner">
</p>




<p align="center">
  <img src="https://capsule-render.vercel.app/api?type=waving&color=0:A3E4DB,40:FFDAB3,100:FFB085&height=220&text=ğŸ“%20AcWing%20ç®—æ³•åŸºç¡€è¯¾&desc=å°†æŠ½è±¡çš„ç†è®ºè½¬åŒ–ä¸ºè§£å†³é—®é¢˜çš„å¼ºå¤§æ­¦å™¨&descAlign=50&descAlignY=75&fontSize=50&fontColor=9B59B6&fontAlignY=42&animation=twinkling" alt="AcWing ç®—æ³•åŸºç¡€è¯¾ Banner">
</p>






<p align="center">
  <img src="https://img.shields.io/badge/Language-C%2B%2B-5B8FF9?style=for-the-badge&logo=c%2B%2B&logoColor=white"/>
  <img src="https://img.shields.io/badge/Topic-Math%20%26%20Number%20Theory-9B59B6?style=for-the-badge&logo=googlesheets&logoColor=white"/>
  <img src="https://img.shields.io/badge/License-MIT-F7B267?style=for-the-badge&logo=openaccess&logoColor=white"/>
  <img src="https://img.shields.io/badge/Created-2025--10--22-95A5A6?style=for-the-badge&logo=clockify&logoColor=white"/>
</p>



![Language](https://img.shields.io/badge/Language-C%2B%2B-00599C?style=flat-square&logo=c%2B%2B)![Topic](https://img.shields.io/badge/Topic-Math%20%26%20Number%20Theory-purple?style=flat-square)![License](https://img.shields.io/badge/License-MIT-lightgrey?style=flat-square)![Created](https://img.shields.io/badge/Created-2025--10--22-lightgrey?style=flat-square)




> "Mathematics is the queen of the sciencesâ€”and number theory is the queen of mathematics." -- Carl Friedrich Gauss
>
> ---
>
> æœ¬ç¬”è®°ä¸º **ç¬¬å››è®² Â· æ•°å­¦çŸ¥è¯†** çš„ C++ æ¨¡æ¿ä¸é¢˜è§£ï¼Œå†…å®¹æ¶µç›–è´¨æ•°ã€çº¦æ•°ã€æ¬§æ‹‰å‡½æ•°ã€å¿«é€Ÿå¹‚ã€æ‰©å±•æ¬§å‡ é‡Œå¾—ã€ç»„åˆè®¡æ•°ã€å®¹æ–¥åŸç†ä¸åšå¼ˆè®ºç­‰ç®—æ³•ç«èµ›ä¸­çš„æ ¸å¿ƒæ•°å­¦å·¥å…·ã€‚
>
> ---
>
> åœ¨ç®—æ³•çš„ä¸–ç•Œé‡Œï¼Œæ•°å­¦çŸ¥è¯†æ˜¯é‚£åº§è¿æ¥é—®é¢˜ä¸æœ€ä¼˜è§£çš„æ¡¥æ¢ã€‚ä»åˆ¤æ–­ä¸€ä¸ªæ•°çš„ç´ æ€§ï¼Œåˆ°æ±‚è§£å¤æ‚çš„ç»„åˆé—®é¢˜ï¼Œæ¯ä¸€ä¸ªæ¦‚å¿µéƒ½æ˜¯ä¸€å—åšå®çš„åŸºçŸ³ã€‚æœ¬ç« å°†å¼•å¯¼ä½ æ¢ç´¢æ•°å­—èƒŒåçš„å¥¥ç§˜ï¼ŒæŒæ¡é‚£äº›èƒ½è®©ä»£ç æ•ˆç‡äº§ç”Ÿè´¨çš„é£è·ƒçš„æ•°å­¦æŠ€å·§ï¼Œå°†æŠ½è±¡çš„ç†è®ºè½¬åŒ–ä¸ºè§£å†³å®é™…é—®é¢˜çš„å¼ºå¤§æ­¦å™¨ã€‚

---

## ğŸ“‹ æœ¬ç« ç›®å½•

[[toc]]

<!-- * [ğŸ§® ç¬¬å››è®² æ•°å­¦çŸ¥è¯†](#-ç¬¬å››è®²-æ•°å­¦çŸ¥è¯†)
  * [ğŸ“š 0. æ€»ã€æ‚](#-0-æ€»æ‚)
  * [âœ¨ 1. è´¨æ•°](#-1-è´¨æ•°)
    * [ğŸ“œ 1.0 æ´›è°· & LeetCode é¢˜å•](#-10-æ´›è°·--leetcode-é¢˜å•)
    * [ğŸ” 1.1 è¯•é™¤æ³•åˆ¤å®šè´¨æ•°](#-11-è¯•é™¤æ³•åˆ¤å®šè´¨æ•°)
    * [ğŸ§© 1.2 åˆ†è§£è´¨å› æ•°](#-12-åˆ†è§£è´¨å› æ•°)
    * [â³ 1.3 ç­›è´¨æ•°](#-13-ç­›è´¨æ•°)
  * [ğŸ“ 2. çº¦æ•°](#-2-çº¦æ•°)
    * [ğŸ“œ 2.0 æ´›è°· & ç‰›å®¢é¢˜å•](#-20-æ´›è°·--ç‰›å®¢é¢˜å•)
    * [ğŸ” 2.1 è¯•é™¤æ³•æ±‚çº¦æ•°](#-21-è¯•é™¤æ³•æ±‚çº¦æ•°)
    * [â• 2.2 çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ](#-22-çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ)
    * [ğŸ¤ 2.3 æœ€å¤§å…¬çº¦æ•° (GCD)](#-23-æœ€å¤§å…¬çº¦æ•°-gcd)
  * [Ï† 3. æ¬§æ‹‰å‡½æ•°](#-3-æ¬§æ‹‰å‡½æ•°)
    * [ğŸ“œ 3.0 æ´›è°· & ç‰›å®¢é¢˜å•](#-30-æ´›è°·--ç‰›å®¢é¢˜å•)
    * [ğŸ“ 3.1 å®šä¹‰æ³•æ±‚æ¬§æ‹‰å‡½æ•°](#-31-å®šä¹‰æ³•æ±‚æ¬§æ‹‰å‡½æ•°)
    * [â³ 3.2 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°](#-32-ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°)
    * [ğŸ‘‘ 3.3 æ¬§æ‹‰å®šç†å’Œè´¹é©¬å°å®šç†](#-33-æ¬§æ‹‰å®šç†å’Œè´¹é©¬å°å®šç†)
  * [ğŸš€ 4. å¿«é€Ÿå¹‚](#-4-å¿«é€Ÿå¹‚)
    * [ğŸ“œ 4.0 æ´›è°· & ç‰›å®¢é¢˜å•](#-40-æ´›è°·--ç‰›å®¢é¢˜å•)
    * [âš¡ 4.1 å¿«é€Ÿå¹‚](#-41-å¿«é€Ÿå¹‚)
    * [ğŸ”„ 4.2 å¿«é€Ÿå¹‚æ±‚é€†å…ƒ](#-42-å¿«é€Ÿå¹‚æ±‚é€†å…ƒ)
  * [ğŸ“ 5. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•](#-5-æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•)
    * [ğŸ“œ 5.0 æ´›è°·é¢˜å•](#-50-æ´›è°·é¢˜å•)
    * [âœ’ï¸ 5.1 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•](#-51-æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•)
    * [â›“ï¸ 5.2 çº¿æ€§åŒä½™æ–¹ç¨‹](#-52-çº¿æ€§åŒä½™æ–¹ç¨‹)
  * [ğŸ‡¨ğŸ‡³ 6. ä¸­å›½å‰©ä½™å®šç† (*)](#-6-ä¸­å›½å‰©ä½™å®šç†-)
    * [ğŸ“œ 6.0 æ´›è°· & ç‰›å®¢é¢˜å•](#-60-æ´›è°·--ç‰›å®¢é¢˜å•)
    * [â“ 6.1 è¡¨è¾¾æ•´æ•°çš„å¥‡æ€ªæ–¹å¼](#-61-è¡¨è¾¾æ•´æ•°çš„å¥‡æ€ªæ–¹å¼)
    * [ğŸ“œ 6.2 ä¸­å›½å‰©ä½™å®šç†ï¼ˆçº¯æ¨¡æ¿ï¼‰](#-62-ä¸­å›½å‰©ä½™å®šç†çº¯æ¨¡æ¿)
  * [ğŸŒ€ 7. é«˜æ–¯æ¶ˆå…ƒ (*)](#-7-é«˜æ–¯æ¶ˆå…ƒ-)
    * [ğŸ“œ 7.0 æ´›è°· & ç‰›å®¢é¢˜å•](#-70-æ´›è°·--ç‰›å®¢é¢˜å•)
    * [ğŸ”¢ 7.1 é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„](#-71-é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„)
    * [ğŸ’¡ 7.2 é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„](#-72-é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„)
  * [ğŸ² 8. æ±‚ç»„åˆæ•°](#-8-æ±‚ç»„åˆæ•°)
    * [ğŸ“œ 8.0 æ´›è°· & ç‰›å®¢é¢˜å•](#-80-æ´›è°·--ç‰›å®¢é¢˜å•)
    * [ğŸªœ 8.1 æ–¹æ³•ä¸€ï¼šé€’æ¨æ³•](#-81-æ–¹æ³•ä¸€é€’æ¨æ³•)
    * [ğŸ­ 8.2 æ–¹æ³•äºŒï¼šé¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒ](#-82-æ–¹æ³•äºŒé¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒ)
    * [ğŸŒŸ 8.3 æ–¹æ³•ä¸‰ï¼šå¢å¡æ–¯å®šç† (Lucas Theorem)](#-83-æ–¹æ³•ä¸‰å¢å¡æ–¯å®šç†-lucas-theorem)
    * [ğŸ”¬ 8.4 æ–¹æ³•å››ï¼šé«˜ç²¾åº¦è®¡ç®—](#-84-æ–¹æ³•å››é«˜ç²¾åº¦è®¡ç®—)
    * [ğŸŒ³ 8.5 å¡ç‰¹å…°æ•°](#-85-å¡ç‰¹å…°æ•°)
  * [âˆªâˆ© 9. å®¹æ–¥åŸç†](#-9-å®¹æ–¥åŸç†)
    * [ğŸ“œ 9.0 æ´›è°·é¢˜å•](#-90-æ´›è°·é¢˜å•)
    * [âœ… 9.1 èƒ½è¢«æ•´é™¤çš„æ•°](#-91-èƒ½è¢«æ•´é™¤çš„æ•°)
  * [ğŸ•¹ï¸ 10. åšå¼ˆè®º](#-10-åšå¼ˆè®º)
    * [ğŸ“œ 10.0 æ´›è°· & LeetCode é¢˜å•](#-100-æ´›è°·--leetcode-é¢˜å•)
    * [ğŸ—¿ 10.1 Nim æ¸¸æˆ](#-101-nim-æ¸¸æˆ)
    * [ğŸªœ 10.2 å°é˜¶-Nim æ¸¸æˆ](#-102-å°é˜¶-nim-æ¸¸æˆ)
    * [ğŸ§© 10.3 é›†åˆ-Nim æ¸¸æˆ (SG å‡½æ•°)](#-103-é›†åˆ-nim-æ¸¸æˆ-sg-å‡½æ•°)
    * [ğŸ’¥ 10.4 æ‹†åˆ†-Nim æ¸¸æˆ (SG å‡½æ•°)](#-104-æ‹†åˆ†-nim-æ¸¸æˆ-sg-å‡½æ•°) -->

---

# ğŸ§® ç¬¬å››è®² æ•°å­¦çŸ¥è¯†

## ğŸ“š 0. æ€»ã€æ‚

| æ¥æº | é¢˜ç›®/é¢˜å•                                | è¯´æ˜                         |
| :--- | :--------------------------------------- | :--------------------------- |
| æ´›è°· | https://www.luogu.com.cn/training/637552 | è´¨æ•°ï¼Œçº¦æ•°ï¼Œæ¬§æ‹‰å‡½æ•°ï¼Œå¿«é€Ÿå¹‚ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/17933  | åˆç­‰æ•°è®ºï¼ˆé¢˜å•ï¼‰             |
| æ´›è°· | https://www.luogu.com.cn/training/234164 | æ•°è®ºä¸“é¢˜ Iï¼ˆé¢˜å•ï¼‰           |
| æ´›è°· | https://www.luogu.com.cn/training/236965 | æ•°è®ºä¸“é¢˜ IIï¼ˆé¢˜å•ï¼‰          |


## âœ¨ 1. è´¨æ•°

> **æ ¸å¿ƒæ€æƒ³**ï¼šè´¨æ•°ï¼Œåˆç§°ç´ æ•°ï¼Œæ˜¯æŒ‡åœ¨å¤§äº1çš„è‡ªç„¶æ•°ä¸­ï¼Œé™¤äº†1å’Œå®ƒè‡ªèº«ä»¥å¤–ä¸å†æœ‰å…¶ä»–å› æ•°çš„è‡ªç„¶æ•°ã€‚è´¨æ•°æ˜¯æ•°è®ºçš„åŸºçŸ³ï¼Œç›¸å…³çš„ç®—æ³•åŒ…æ‹¬è´¨æ•°çš„åˆ¤å®šã€åˆ†è§£è´¨å› æ•°ä»¥åŠé«˜æ•ˆåœ°ç­›é€‰å‡ºä¸€å®šèŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•°ã€‚


### ğŸ“œ 1.0 æ´›è°· & LeetCode é¢˜å•

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| leetcode | [204. è®¡æ•°è´¨æ•°](https://leetcode.cn/problems/count-primes/) | è®¡æ•°è´¨æ•° |
| ç‰›å®¢ | [åˆ¤æ–­è´¨æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/9f418ff48b5e4e879f398352bed6118d) | **åˆ¤æ–­è´¨æ•°** |
| ç‰›å®¢ | [åˆ†è§£è´¨å› æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/35723516d6f841ca8869ecbcf3ddacaf) | **åˆ†è§£è´¨å› æ•°** |
| ç‰›å®¢ | [ç­›æ³•åˆ¤æ–­è´¨æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/8afab457ef11456d8602ce6dc30db776) | **ç­›æ³•åˆ¤æ–­è´¨æ•°** |
| æ´›è°· | [P3383 ã€æ¨¡æ¿ã€‘çº¿æ€§ç­›ç´ æ•°](https://www.luogu.com.cn/problem/P3383) | P3383 ã€æ¨¡æ¿ã€‘çº¿æ€§ç­›ç´ æ•° |
| æ´›è°· | [P1075 [NOIP 2012 æ™®åŠç»„] è´¨å› æ•°åˆ†è§£](https://www.luogu.com.cn/problem/P1075) | P1075 è´¨å› æ•°åˆ†è§£ |
| æ´›è°· | [https://www.luogu.com.cn/training/436457](https://www.luogu.com.cn/training/436457) | è´¨æ•°é¢˜ç›®å¤§å…¨ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | [https://www.luogu.com.cn/training/689368](https://www.luogu.com.cn/training/689368) | è´¨æ•°ä¸ç­›æ³•ç»ƒä¹ ï¼ˆé¢˜å•ï¼‰ |



### ğŸ” 1.1 è¯•é™¤æ³•åˆ¤å®šè´¨æ•°

> **è§£æ³•æ€è·¯**ï¼š
>
> åˆ¤æ–­ä¸€ä¸ªæ•° `x` æ˜¯å¦ä¸ºè´¨æ•°ï¼Œæœ€ç›´è§‚çš„æ–¹æ³•æ˜¯**è¯•é™¤æ³•**ã€‚
>
> 1.  **åŸºæœ¬åŸç†**ï¼šæ£€æŸ¥ä» `2` åˆ° `x-1` æ˜¯å¦æœ‰æ•°èƒ½æ•´é™¤ `x`ã€‚
> 2.  **ä¼˜åŒ–**ï¼šä¸€ä¸ªæ•°çš„å› æ•°æ€»æ˜¯æˆå¯¹å‡ºç°çš„ã€‚å¦‚æœ `i` æ˜¯ `x` çš„ä¸€ä¸ªå› æ•°ï¼Œé‚£ä¹ˆ `x/i` ä¹Ÿæ˜¯ã€‚å…¶ä¸­ä¸€ä¸ªå¿…ç„¶å°äºç­‰äº `sqrt(x)`ï¼Œå¦ä¸€ä¸ªå¤§äºç­‰äº `sqrt(x)`ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æŸ¥ä» `2` åˆ° `sqrt(x)` çš„æ•°å³å¯ã€‚
> 3.  **ä»£ç å®ç°**ï¼šå¾ªç¯æ¡ä»¶ `i <= x / i` ç­‰ä»·äº `i * i <= x`ï¼Œä½†å¯ä»¥æœ‰æ•ˆé¿å… `i*i` æº¢å‡ºã€‚
> 4.  **æ—¶é—´å¤æ‚åº¦**ï¼šO(âˆšn)ã€‚



<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>



| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| ç‰›å®¢ | [åˆ¤æ–­è´¨æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/9f418ff48b5e4e879f398352bed6118d) | **åˆ¤æ–­è´¨æ•°** |
| æ´›è°· | https://www.luogu.com.cn/problem/T409608 | T409608 ã€æ¨¡æ¿ã€‘è¯•é™¤æ³•åˆ¤æ–­è´¨æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/U203147 | U203147 è¯•é™¤æ³•åˆ¤å®šè´¨æ•° |
| æ´›è°· | [https://www.luogu.com.cn/training/384711](https://www.luogu.com.cn/training/384711) | åˆ¤æ–­è´¨æ•°ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | [https://www.luogu.com.cn/training/436457](https://www.luogu.com.cn/training/436457) | è´¨æ•°é¢˜ç›®å¤§å…¨ï¼ˆé¢˜å•ï¼‰ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240208154627833](assets/image-20240208154627833.png)



> **æ ¸å¿ƒä»£ç å‡½æ•°**

```c++
bool is_prime(int x)
{
    if (x < 2) return false;
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0)
            return false;
    return true;
}
```

> **AcWing é¢˜è§£**

```cpp
#include <iostream>
#include <algorithm>

using namespace std;

bool is_prime(int x)
{
    if (x < 2) return false;
    // x çš„ä¸€ä¸ªæ›´å°çš„å› å­ä¸º i ï¼Œå¦ä¸€ä¸ªæ›´å¤§çš„å› å­ä¸º x / i ï¼Œéå†æ‰€æœ‰æ›´å°çš„å› å­å³å¯
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0)
            return false;
            
    return true;
}

int main()
{
    int n;
    cin >> n;

    while (n -- )
    {
        int x;
        cin >> x;
        if (is_prime(x)) puts("Yes");
        else puts("No");
    }

    return 0;
}
```
</details>

### ğŸ§© 1.2 åˆ†è§£è´¨å› æ•°



> [!note]
>
> **é‡è¦æ€§è´¨**ï¼šä¸€ä¸ªæ­£æ•´æ•°`n`ä¸­æœ€å¤šåªåŒ…å«`ä¸€ä¸ª`å¤§äº$\sqrt(n)$çš„è´¨å› æ•°
>
> **è§£æ³•æ€è·¯**ï¼š
>
> åŒæ ·åˆ©ç”¨è¯•é™¤æ³•ï¼Œä» `2` å¼€å§‹ä¾æ¬¡å°è¯• `x` çš„è´¨å› å­ã€‚
>
> 1.  **éå†**ï¼šä» `i = 2` å¾ªç¯åˆ° `x / i`ã€‚
> 2.  **æå–å› å­**ï¼šå¦‚æœ `i` èƒ½æ•´é™¤ `x`ï¼Œè¯´æ˜ `i` æ˜¯ `x` çš„ä¸€ä¸ªè´¨å› å­ã€‚ç”¨ä¸€ä¸ª `while` å¾ªç¯å°† `x` ä¸­æ‰€æœ‰çš„å› å­ `i` é™¤å°½ï¼Œå¹¶è®¡æ•°ã€‚
> 3.  **æ­£ç¡®æ€§**ï¼šå› ä¸ºæˆ‘ä»¬æ˜¯ä»å°åˆ°å¤§æšä¸¾ `i`ï¼Œæ‰€ä»¥å½“æ‰¾åˆ°ä¸€ä¸ªå› å­ `i` æ—¶ï¼Œå®ƒä¸€å®šæ˜¯è´¨æ•°ã€‚å› ä¸ºå¦‚æœ `i` æ˜¯åˆæ•°ï¼Œå®ƒçš„è´¨å› å­ï¼ˆæ¯” `i` å°ï¼‰å¿…ç„¶åœ¨ä¹‹å‰å°±è¢«é™¤å°½äº†ã€‚
> 4.  **ç‰¹æ®Šæƒ…å†µ**ï¼šå¾ªç¯ç»“æŸåï¼Œå¦‚æœ `x > 1`ï¼Œè¯´æ˜å‰©ä¸‹çš„ `x` æ˜¯ä¸€ä¸ªå¤§äº `sqrt(åŸx)` çš„è´¨å› å­ã€‚
> 5.  **æ—¶é—´å¤æ‚åº¦**ï¼šO(âˆšn)ã€‚



<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| ç‰›å®¢ | [åˆ†è§£è´¨å› æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/35723516d6f841ca8869ecbcf3ddacaf) | **åˆ†è§£è´¨å› æ•°**                      |
| æ´›è°· | https://www.luogu.com.cn/problem/P1075                       | P1075 [NOIP 2012 æ™®åŠç»„] è´¨å› æ•°åˆ†è§£ |
| æ´›è°· | https://www.luogu.com.cn/problem/T159080                     | T159080 åˆ†è§£è´¨å› æ•°                  |
| æ´›è°· | https://www.luogu.com.cn/problem/P2043                       | P2043 è´¨å› å­åˆ†è§£                    |
| æ´›è°· | https://www.luogu.com.cn/training/561479                     | ã€”Fancy Zoneã€•è´¨æ•°ä¸çº¦æ•°ï¼ˆé¢˜å•ï¼‰    |
| æ´›è°· | https://www.luogu.com.cn/training/826945                     | åˆ†è§£è´¨å› æ•°ï¼ˆé¢˜å•ï¼‰                  |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240208162404221](assets/image-20240208162404221.png)



> **æ ¸å¿ƒä»£ç å‡½æ•°**

```c++
void divide(int x)
{
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0)
        {
            int s = 0;
            while (x % i == 0) x /= i, s ++ ;
            cout << i << ' ' << s << endl;
        }
    if (x > 1) cout << x << ' ' << 1 << endl;
    cout << endl;
}
```



> **AcWing é¢˜è§£**

```cpp
#include <iostream>
#include <algorithm>

using namespace std;

void divide(int x)
{
	/*è¿™é‡Œéå†çš„ i è‚¯å®šæ‰€æœ‰éƒ½æ˜¯è´¨æ•°ï¼Œå‡å¦‚ i æ˜¯åˆæ•°é‚£ä¹ˆ i è‚¯å®šä¹Ÿå¯åˆ†è§£ä¸ºæ›´å°çš„è´¨æ•°ç›¸ä¹˜ï¼Œç”±äºå¾ªç¯æ˜¯ä»å°åˆ°å¤§éå†çš„
	æ‰€ä»¥ i åˆ†è§£çš„æ›´å°çš„è´¨æ•°è‚¯å®šæ˜¯éå†è¿‡ï¼Œ x é™¤è¿‡äº†çš„ï¼Œæ‰€ä»¥ä¸å¯èƒ½éå†åˆ°åˆæ•°*/
	//å› æœ€å¤šåªæœ‰ä¸€ä¸ªå¤§äº sqrt(n) çš„è´¨å› å­ï¼Œæ‰€ä»¥å…ˆéå†å°äº sqrt(n) çš„ 
    for (int i = 2; i <= x / i; i ++ )
    	//æ¯æœ‰ä¸€ä¸ªè´¨å› å­ 
        if (x % i == 0)
        {
            int s = 0;
            while (x % i == 0) x /= i, s ++ ;
            cout << i << ' ' << s << endl;
        }
    //å¦‚æœæœ€å x > 1 ï¼Œé‚£æ­¤æ—¶çš„ x å°±æ˜¯é‚£ä¸ªå¤§äº sqrt(n) çš„è´¨å› å­ 
    if (x > 1) cout << x << ' ' << 1 << endl;
    cout << endl;
}

int main()
{
    int n;
    cin >> n;
    while (n -- )
    {
        int x;
        cin >> x;
        divide(x);
    }

    return 0;
}
```




> å†™æ³•2ï¼ˆé¢˜ç›®ï¼š[åˆ†è§£è´¨å› æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/35723516d6f841ca8869ecbcf3ddacaf)ï¼‰ï¼š

```c++
#include<iostream>
using namespace std;
void handle(long n) {
    while (n % 2 == 0) {
        printf("2 ");
        n /= 2;
    }
    for (int i = 3; i <= n / i; i += 2) {
        while (n % i == 0) {
            printf("%d ", i);
            n /= i;
        }
    }
    if (n > 1) {
        printf("%ld ", n);
    }
}
int main () {
    long n;
    cin >> n;
    handle(n);
    return 0;
}
```




</details>

### â³ 1.3 ç­›è´¨æ•°

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| leetcode | [204. è®¡æ•°è´¨æ•°](https://leetcode.cn/problems/count-primes/)  | 204. è®¡æ•°è´¨æ•°                          |
| ç‰›å®¢     | [ç´ æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/7f4be54b37a04fdaa4ee545819151114) | **ç´ æ•°**                               |
| ç‰›å®¢     | [ç­›æ³•åˆ¤æ–­è´¨æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/8afab457ef11456d8602ce6dc30db776) | **ç­›æ³•åˆ¤æ–­è´¨æ•°**                       |
| ç‰›å®¢     | [è´¨æ•°çš„è®¡æ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/190167d1990442da9adb133980259a27) | **è´¨æ•°çš„è®¡æ•°**                         |
| æ´›è°·     | https://www.luogu.com.cn/problem/P5736                       | P5736 ã€æ·±åŸº7.ä¾‹2ã€‘è´¨æ•°ç­›              |
| æ´›è°· | https://www.luogu.com.cn/problem/U208323 | U208323 åŸƒæ°ç­›è´¨æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/P3383 | P3383 ã€æ¨¡æ¿ã€‘çº¿æ€§ç­›ç´ æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/P3912 | P3912 ç´ æ•°ä¸ªæ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/U127482 | **U127482 çº¿æ€§ç­›ï¼ˆç›®å‰0æäº¤ 0 é€šè¿‡ï¼‰** |
| æ´›è°· | https://www.luogu.com.cn/training/530241 | ç»ƒä¹ ç´ æ•°ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/305627 | æ•°å­¦è®¡æ•°â€”â€”åŸºç¡€ç­›æ³•ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/689368 | è´¨æ•°ä¸ç­›æ³•ç»ƒä¹ ï¼ˆé¢˜å•ï¼‰ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240208165154655](assets/image-20240208165154655.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> å½“éœ€è¦æ‰¾å‡ºä¸€å®šèŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•°æ—¶ï¼Œå•ä¸ªåˆ¤æ–­æ•ˆç‡å¤ªä½ï¼Œéœ€è¦ä½¿ç”¨ç­›æ³•ã€‚
>
> 1. æœ´ç´ ç­›æ³•ï¼ˆæŠŠæ‰€æœ‰æ•°çš„æ‰€æœ‰å€æ•°ç­›æ‰ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n logn)$ï¼‰
>
> 2. **åŸƒæ°ç­›æ³• (Sieve of Eratosthenes)**ï¼š
>
>    -   ä» `2` å¼€å§‹ï¼Œå¦‚æœä¸€ä¸ªæ•° `i` æ²¡æœ‰è¢«æ ‡è®°ï¼Œåˆ™ `i` æ˜¯è´¨æ•°ã€‚
>
>    -   ç„¶åå°† `i` çš„æ‰€æœ‰å€æ•° `2i, 3i, ...` æ ‡è®°ä¸ºåˆæ•°ã€‚
>
>    -   ç»§ç»­æ£€æŸ¥ä¸‹ä¸€ä¸ªæœªè¢«æ ‡è®°çš„æ•°ã€‚
>
>    -   **æ—¶é—´å¤æ‚åº¦**ï¼šO(n log log n)ã€‚
>
> 3. **çº¿æ€§ç­›æ³• (Euler's Sieve)**ï¼š
>
>    -   åŸƒæ°ç­›æ³•ä¼šé‡å¤æ ‡è®°åˆæ•°ï¼ˆå¦‚ 12 ä¼šè¢« 2 å’Œ 3 åˆ†åˆ«æ ‡è®°ï¼‰ã€‚
>
>    -   çº¿æ€§ç­›çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**è®©æ¯ä¸ªåˆæ•°åªè¢«å…¶æœ€å°çš„è´¨å› å­ç­›æ‰**ã€‚
>
>    -   éå† `2`åˆ° `n`ï¼Œå¦‚æœ `i` æœªè¢«æ ‡è®°ï¼Œåˆ™ä¸ºè´¨æ•°ã€‚
>
>    -   å†…å±‚å¾ªç¯éå†å·²æ‰¾åˆ°çš„è´¨æ•° `primes[j]`ï¼Œå°† `i * primes[j]` æ ‡è®°ä¸ºåˆæ•°ã€‚
>
>    -   **å…³é”®**ï¼šå½“ `i % primes[j] == 0` æ—¶ `break`ã€‚å› ä¸º `primes[j]` æ˜¯ `i` çš„æœ€å°è´¨å› å­ï¼Œé‚£ä¹ˆ `primes[j]` ä¹Ÿæ˜¯ `i * primes[j]` çš„æœ€å°è´¨å› å­ã€‚å¯¹äºæ›´å¤§çš„è´¨æ•° `primes[k]`ï¼Œ`i * primes[k]` çš„æœ€å°è´¨å› å­ä»ç„¶æ˜¯ `primes[j]`ï¼Œåº”è¯¥ç”± `(i * primes[k] / primes[j]) * primes[j]` æ¥ç­›ï¼Œè€Œä¸æ˜¯ç°åœ¨ç­›ï¼Œä»è€Œä¿è¯æ¯ä¸ªæ•°åªè¢«ç­›ä¸€æ¬¡ã€‚
>
>    -   **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)ã€‚

> **AcWing é¢˜è§£ (çº¿æ€§ç­›æ³•)**
```cpp
#include <iostream>
#include <vector>

using namespace std;

const int N = 1000010;

int primes[N], cnt; // å­˜å‚¨è´¨æ•°
bool st[N];         // æ ‡è®°æ˜¯å¦ä¸ºåˆæ•°

void get_primes(int n)
{
    for (int i = 2; i <= n; i ++ )
    {
        if (!st[i]) primes[cnt ++ ] = i; // iæ˜¯è´¨æ•°
        
        // ç”¨å·²æ‰¾åˆ°çš„è´¨æ•°å»ç­›æ‰åˆæ•°
        // ä¿è¯ primes[j] * i ä¸è¶Šç•Œ
        for (int j = 0; primes[j] <= n / i; j ++ )
        {
            // primes[j] æ˜¯ primes[j] * i çš„æœ€å°è´¨å› å­
            st[primes[j] * i] = true;
            
            // å¦‚æœ i æ˜¯ primes[j] çš„å€æ•°ï¼Œè¯´æ˜ primes[j] æ˜¯ i çš„æœ€å°è´¨å› å­
            // å†å¾€åçš„ primes[k] * i çš„æœ€å°è´¨å› å­ä¹Ÿæ˜¯ primes[j]ï¼Œåº”è¯¥ç”±å…¶ä»–æ•°æ¥ç­›
            // åŠæ—¶ breakï¼Œä¿è¯æ¯ä¸ªåˆæ•°åªè¢«å…¶æœ€å°è´¨å› å­ç­›ä¸€æ¬¡
            if (i % primes[j] == 0) break;
        }
    }
}

int main()
{
    int n;
    cin >> n;
    get_primes(n);
    cout << cnt << endl;
    return 0;
}
```


> [!Tip]
>
> ä»¥ä¸‹æ˜¯å…¶ä»–å„ç§ç­›æ³•çš„ä»£ç å®ç°ï¼š
>
> 1ã€æœ´ç´ ç­›æ³•ï¼ˆæŠŠæ‰€æœ‰æ•°çš„æ‰€æœ‰å€æ•°ç­›æ‰ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n logn)$ï¼‰
>
> ```c++
> int primes[N], cnt;// primes æ˜¯å­˜å‚¨è´¨æ•°çš„æ•°ç»„ï¼Œ cnt æ˜¯è´¨æ•°çš„æ•°é‡ 
> bool st[N];
> 
> void get_primes(int n)
> {
>     for (int i = 2; i <= n; i ++ ){
>         if(!st[i]){
>         	primes[cnt ++ ] = i;
> 		}
>         //æŠŠæ‰€æœ‰æ•°çš„æ‰€æœ‰å€æ•°ç­›æ‰ 
>         for (int j = i + i; j <= n; j += i) st[j] = true;
>     }
> }
> ```
>
> 2ã€åŸƒæ°ç­›æ³•ï¼ˆ**æŠŠæ‰€æœ‰è´¨æ•°çš„æ‰€æœ‰å€æ•°ç­›æ‰** ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(nloglogn)$ï¼‰
>
> ```c++
> int primes[N], cnt;// primes æ˜¯å­˜å‚¨è´¨æ•°çš„æ•°ç»„ï¼Œ cnt æ˜¯è´¨æ•°çš„æ•°é‡ 
> bool st[N];
> 
> void get_primes(int n)
> {
>     for (int i = 2; i <= n; i ++ ){
>         if(!st[i]){
>         	primes[cnt ++ ] = i;
>         	//æŠŠæ­¤è´¨æ•°çš„æ‰€æœ‰å€æ•°ç­›æ‰ 
>         	for (int j = i + i; j <= n; j += i) st[j] = true;
> 		}
>     }
> }
> ```
>
> åŸƒæ°ç­›çš„å¦ä¸€ç§å†™æ³•ï¼š
>
> ```c++
> int primes[N], cnt;// primes æ˜¯å­˜å‚¨è´¨æ•°çš„æ•°ç»„ï¼Œ cnt æ˜¯è´¨æ•°çš„æ•°é‡ 
> bool st[N];
> 
> void get_primes(int n)
> {
>     for (int i = 2; i <= n / i; i ++ ){
>         if(!st[i]){
>         	primes[cnt ++ ] = i;
>         	//æŠŠæ­¤è´¨æ•°çš„æ‰€æœ‰å€æ•°ç­›æ‰ 
>         	for (int j = i * i; j <= n; j += i) st[j] = true;
> 		}
>     }
> }
> ```
>
> åŸƒæ°ç­›çš„å®Œæ•´ä»£ç 
>
> ```c++
> 
> //åŸƒæ°ç­›æ³• 
> 
> #include <iostream>
> #include <algorithm>
> 
> using namespace std;
> 
> const int N= 1000010;
> 
> int primes[N], cnt;// primes æ˜¯å­˜å‚¨è´¨æ•°çš„æ•°ç»„ï¼Œ cnt æ˜¯è´¨æ•°çš„æ•°é‡ 
> bool st[N];
> 
> void get_primes(int n)
> {
>     for (int i = 2; i <= n; i ++ ){
>         if(!st[i]){
>         	primes[cnt ++ ] = i;
>         	//æŠŠæ­¤è´¨æ•°çš„æ‰€æœ‰å€æ•°ç­›æ‰ 
>         	for (int j = i + i; j <= n; j += i) st[j] = true;
> 		}
>     }
> }
> 
> int main()
> {
>     int n;
>     cin >> n;
> 
>     get_primes(n);
> 
>     cout << cnt << endl;
> 
>     return 0;
> }
> ```
>
> 3ã€çº¿æ€§ç­›æ³•ï¼ˆ**ä¸€ä¸ªæ•°åªè¢«å…¶æœ€å°è´¨å› å­ç­›æ‰**ï¼‰
>
> æ ¸å¿ƒä»£ç 
>
> ```c++
> int primes[N], cnt;     // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°
> bool st[N];         // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰
> 
> void get_primes(int n)
> {
>     for (int i = 2; i <= n; i ++ )
>     {
>         if (!st[i]) primes[cnt ++ ] = i;
>         for (int j = 0; primes[j] <= n / i; j ++ )
>         {
>             st[primes[j] * i] = true;
>             if (i % primes[j] == 0) break;
>         }
>     }
> }
> 
> ```
>
> å®Œæ•´ä»£ç ï¼š
>
> ```c++
> 
> //çº¿æ€§ç­›æ³•ï¼Œæ•°æ®å¤§æ—¶ä¼šå¿«å¾ˆå¤š
> //è¯¦è§£å‚è€ƒï¼šhttps://blog.csdn.net/littlegengjie/article/details/134164936
> 
> #include <iostream>
> #include <algorithm>
> 
> using namespace std;
> 
> const int N= 1000010;
> 
> int primes[N], cnt;
> bool st[N];//st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ï¼Œéè´¨æ•°è¦è¢«ç­›æ‰ï¼Œèµ·åˆå…¨ä¸º false ï¼Œå…¨ä¸ºè´¨æ•°
> 
> void get_primes(int n)
> {
>     for (int i = 2; i <= n; i ++ )
>     {
>         //å½“ i æ˜¯è´¨æ•°
>         if (!st[i]) primes[cnt ++ ] = i;
>         
>         //åœ¨ç­› i çš„æœ€å°è´¨å› å­çš„è¿‡ç¨‹ä¸­æŠŠ primes[j] * i <= n çš„æ‰€æœ‰åˆæ•°ç­›å‡ºæ¥ 
>         for (int j = 0; primes[j] <= n / i; j ++ )
>         {
>         	/*
> 			å½“  i % primes[j] != 0  æ—¶ï¼š
> 			primes[j]ä¸€å®šå°äº i çš„æœ€å°è´¨å› å­ï¼Œè€Œä¸” primes[j] ä¸€å®šæ˜¯primes[j] * içš„æœ€å°è´¨å› å­ã€‚
> 			æŠŠå¯¹åº” primes[j] çš„åˆæ•°ç­›æ‰
> 			*/
>             st[primes[j] * i] = true;
>             /*
>             å½“  i % primes[j] == 0  æ—¶ï¼š
> 			å°±è¯´æ˜æšä¸¾åˆ° i çš„æœ€å°è´¨å› å­ï¼Œé€€å‡ºå¾ªç¯ 
> 			*/
>             if (i % primes[j] == 0) break;
>         }
>     }
> }
> 
> int main()
> {
>     int n;
>     cin >> n;
> 
>     get_primes(n);
> 
>     cout << cnt << endl;
> 
>     return 0;
> }
> 
> ```



</details>

---

## ğŸ“ 2. çº¦æ•°

> **æ ¸å¿ƒæ€æƒ³**ï¼šçº¦æ•°ï¼Œåˆç§°å› æ•°ï¼Œæ˜¯æŒ‡èƒ½æ•´é™¤ç»™å®šæ•´æ•°çš„æ•´æ•°ã€‚å›´ç»•çº¦æ•°çš„é—®é¢˜é€šå¸¸åŒ…æ‹¬æ±‚ä¸€ä¸ªæ•°çš„æ‰€æœ‰çº¦æ•°ã€çº¦æ•°çš„ä¸ªæ•°ã€çº¦æ•°ä¹‹å’Œä»¥åŠä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°ç­‰ã€‚

### ğŸ“œ 2.0 æ´›è°· & ç‰›å®¢é¢˜å•



**ï¼ˆ1ï¼‰è¯•é™¤æ³•æ±‚çº¦æ•°ã€çº¦æ•°ä¸ªæ•°ã€çº¦æ•°ä¹‹å’Œ**



| æ¥æº | é¢˜ç›®/é¢˜å•                                                    | è¯´æ˜                              |
| :--- | :----------------------------------------------------------- | :-------------------------------- |
| æ´›è°· | https://www.luogu.com.cn/problem/U576695                     | U576695 è¯•é™¤æ³•æ±‚çº¦æ•°              |
| æ´›è°· | https://www.luogu.com.cn/problem/U203210                     | U203210 çº¦æ•°ä¸ªæ•°                  |
| ç‰›å®¢ | [çº¦æ•°çš„ä¸ªæ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/04c8a5ea209d41798d23b59f053fa4d6) | **çº¦æ•°çš„ä¸ªæ•°**                    |
| æ´›è°· | https://www.luogu.com.cn/problem/P3327                       | P3327 [SDOI2015] çº¦æ•°ä¸ªæ•°å’Œ       |
| æ´›è°· | https://www.luogu.com.cn/problem/U492051                     | U492051 æ±‚çº¦æ•°ä¸ªæ•°                |
| æ´›è°· | https://www.luogu.com.cn/problem/P1403                       | P1403 [AHOI2005] çº¦æ•°ç ”ç©¶         |
| æ´›è°· | https://www.luogu.com.cn/problem/U506557                     | U506557 çº¦æ•°ä¹‹å’Œ                  |
| æ´›è°· | https://www.luogu.com.cn/problem/U507255                     | U507255 çº¦æ•°ä¹‹å’Œâ…¡                 |
| ç‰›å®¢ | [çº¦æ•°ä¹‹å’Œ](https://ac.nowcoder.com/acm/problem/22196)        | **çº¦æ•°ä¹‹å’Œ**                      |
| æ´›è°· | https://www.luogu.com.cn/problem/P2424                       | P2424 çº¦æ•°å’Œ                      |
| æ´›è°· | https://www.luogu.com.cn/training/601405                     | CSP-J-åˆ†è§£è´¨å› æ•°ã€GCD/LCMï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/456009                     | ç­›é€‰æ³• åˆ†è§£è´¨å› æ•° GCD/LCMï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/509126                     | çº¦æ•°ç›¸å…³ï¼ˆé¢˜å•ï¼‰                  |





**ï¼ˆ2ï¼‰æœ€å¤§å…¬çº¦æ•°**



| æ¥æº     | é¢˜ç›®/é¢˜å•                                                    | è¯´æ˜                                |
| :------- | :----------------------------------------------------------- | :---------------------------------- |
| leetcode | [1979. æ‰¾å‡ºæ•°ç»„çš„æœ€å¤§å…¬çº¦æ•°](https://leetcode.cn/problems/find-greatest-common-divisor-of-array/) | 1979. æ‰¾å‡ºæ•°ç»„çš„æœ€å¤§å…¬çº¦æ•°          |
| ç‰›å®¢     | [æœ€å¤§å…¬çº¦æ•°](https://www.nowcoder.com/practice/cf4091ca75ca47958182dae85369c82c) | **æœ€å¤§å…¬çº¦æ•°**                      |
| æ´›è°·     | https://www.luogu.com.cn/problem/B4025                       | B4025 æœ€å¤§å…¬çº¦æ•°                    |
| æ´›è°·     | https://www.luogu.com.cn/training/492388                     | æœ€å¤§å…¬çº¦æ•° GCDï¼ˆé¢˜å•ï¼‰              |
| æ´›è°·     | https://www.luogu.com.cn/training/387666                     | æ•°å­¦-æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•°ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°·     | https://www.luogu.com.cn/training/681959                     | æœ€å¤§å…¬çº¦æ•°ç»ƒä¹ é¢˜ï¼ˆé¢˜å•ï¼‰            |



### ğŸ” 2.1 è¯•é™¤æ³•æ±‚çº¦æ•°

<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240217104638829](assets/image-20240217104638829.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> ç±»ä¼¼äºè¯•é™¤æ³•åˆ¤å®šè´¨æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡éå†åˆ° `sqrt(x)` æ¥æ‰¾åˆ°æ‰€æœ‰çº¦æ•°ã€‚
>
> 1.  **éå†**ï¼šå¾ªç¯ `i` ä» `1` åˆ° `x / i`ã€‚
> 2.  **æˆå¯¹æ·»åŠ **ï¼šå¦‚æœ `i` èƒ½æ•´é™¤ `x`ï¼Œé‚£ä¹ˆ `i` å’Œ `x / i` éƒ½æ˜¯ `x` çš„çº¦æ•°ã€‚å°†å®ƒä»¬éƒ½åŠ å…¥ç»“æœåˆ—è¡¨ã€‚
> 3.  **å»é‡**ï¼šå½“ `x` æ˜¯å®Œå…¨å¹³æ–¹æ•°æ—¶ï¼Œ`i` å’Œ `x / i` ä¼šç›¸ç­‰ï¼Œæ­¤æ—¶åªæ·»åŠ ä¸€ä¸ª `i` å³å¯ã€‚
> 4.  **æ’åº**ï¼šæœ€åå¯¹ç»“æœè¿›è¡Œæ’åºï¼Œä»¥ç¡®ä¿è¾“å‡ºé¡ºåºæ­£ç¡®ã€‚
> 5.  **æ—¶é—´å¤æ‚åº¦**ï¼šO(âˆšn)ã€‚



> **å‡½æ•°å…³é”®ä»£ç **

```c++
vector<int> get_divisors(int x)
{
    vector<int> res;
    for (int i = 1; i <= x / i; i ++ )
        if (x % i == 0)
        {
            res.push_back(i);
            if (i != x / i) res.push_back(x / i);
        }
    sort(res.begin(), res.end());
    return res;
}
```

> **AcWing é¢˜è§£**

```cpp
#include <iostream>
#include <algorithm>
#include <vector>

using namespace std;

vector<int> get_divisors(int x)
{
    vector<int> res;
    // éå†åˆ° sqrt(x)
    for (int i = 1; i <= x / i; i ++ )
        if (x % i == 0)
        {
            res.push_back(i);
            // å¦‚æœ i != x / i, é¿å…é‡å¤æ·»åŠ 
            if (i != x / i) res.push_back(x / i);
        }
    sort(res.begin(), res.end());
    return res;
}

int main()
{
    int n;
    cin >> n;

    while (n -- )
    {
        int x;
        cin >> x;
        vector<int> res = get_divisors(x);

        for (int val : res) cout << val << ' ';
        cout << endl;
    }

    return 0;
}
```
</details>

### â• 2.2 çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ

> **æ ¸å¿ƒå…¬å¼**ï¼š
>
> è®¾æ­£æ•´æ•° $N$ çš„æ ‡å‡†è´¨å› æ•°åˆ†è§£ä¸ºï¼š $N = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$
>
> 1. **çº¦æ•°ä¸ªæ•°**ï¼š 
>    $$
>    \tau(N) = (a_1 + 1)(a_2 + 1) \cdots (a_k + 1) = \prod_{i=1}^{k} (a_i + 1)
>    $$
>    
>
>    > æ¯ä¸ªè´¨å› å­ $p_i$ å¯ä»¥é€‰ $0, 1, \dots, a_i$ æ¬¡ï¼Œå…± $a_i+1$ ç§é€‰æ‹©ï¼Œæ ¹æ®ä¹˜æ³•åŸç†å¾—å‡ºã€‚
>
> 2. **çº¦æ•°ä¹‹å’Œ**ï¼š 
>    $$
>    \sigma(N) = (p_1^0 + p_1^1 + p_1^2 + \cdots + p_1^{a_1}) \cdot (p_2^0 + p_2^1 + p_2^2 + \cdots + p_2^{a_2}) \cdots (p_k^0 + p_k^1 + p_k^2 + \cdots + p_k^{a_k})
>    $$
>    
>
>    > è¿™æ˜¯æ‰€æœ‰çº¦æ•°å±•å¼€åçš„å½¢å¼ï¼Œåˆ©ç”¨ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼å¯ä»¥ç®€åŒ–ä¸ºï¼š
>    > $$
>    > \sigma(N) = \prod_{i=1}^{k} \left( \sum_{j=0}^{a_i} p_i^j \right) = \prod_{i=1}^{k} \frac{p_i^{a_i + 1} - 1}{p_i - 1} \quad (p_i 
>    > eq 1)
>    > $$
>    > 

#### ğŸ”¢ 2.2.1 çº¦æ•°ä¸ªæ•°


<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>


| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U203210 | U203210 çº¦æ•°ä¸ªæ•° |
| ç‰›å®¢ | [çº¦æ•°çš„ä¸ªæ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/04c8a5ea209d41798d23b59f053fa4d6) | **çº¦æ•°çš„ä¸ªæ•°**              |
| æ´›è°· | https://www.luogu.com.cn/problem/P3327                       | P3327 [SDOI2015] çº¦æ•°ä¸ªæ•°å’Œ |
| æ´›è°· | https://www.luogu.com.cn/problem/U492051                     | U492051 æ±‚çº¦æ•°ä¸ªæ•°          |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240217153842909](assets/image-20240217153842909.png)

> **AcWing é¢˜è§£**
```cpp

//çº¦æ•°ä¸ªæ•°å®šç†ï¼šä¸€ä¸ªæ­£æ•´æ•°çš„çº¦æ•°ä¸ªæ•°ç­‰äºå…¶è´¨å› å­åˆ†è§£ä¸­æ¯ä¸ªè´¨æ•°æŒ‡æ•°åŠ 1çš„ä¹˜ç§¯ã€‚
/*
ä¾‹å¦‚ï¼š 
å°†378000åˆ†è§£è´¨å› æ•°378000=2^4Ã—3^3Ã—5^3Ã—7^1
ç”±çº¦æ•°ä¸ªæ•°å®šç†å¯çŸ¥378000å…±æœ‰æ­£çº¦æ•°(4+1)Ã—(3+1)Ã—(3+1)Ã—(1+1)=160ä¸ªã€‚
*/

#include <iostream>
#include <algorithm>
#include <unordered_map>
#include <vector>

using namespace std;

typedef long long LL;

const int N = 110, mod = 1e9 + 7;

int main()
{
    int n;
    cin >> n;

    unordered_map<int, int> primes;//primes[i] è¡¨ç¤º i è¿™ä¸ªè´¨å› å­å¯¹åº”çš„æŒ‡æ•° 

    while (n -- )
    {
        int x;
        cin >> x;
		//åˆ†è§£è´¨å› æ•°
        for (int i = 2; i <= x / i; i ++ )
            while (x % i == 0)
            {
                x /= i;
                primes[i] ++ ;
            }
		//æœ€å¤šåªæœ‰ä¸€ä¸ªå¤§äº sqrt(n) çš„è´¨å› å­ï¼Œè¦è€ƒè™‘è¿™ä¸ªå¤§äº sqrt(n) çš„è´¨å› å­
        if (x > 1) primes[x] ++ ;
    }

    LL res = 1;
    
    for (pair<int,int> p : primes) res = res * (p.second + 1) % mod;

    cout << res << endl;

    return 0;
}
```
</details>



#### ğŸ’° 2.2.2 çº¦æ•°ä¹‹å’Œ


<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U506557 | U506557 çº¦æ•°ä¹‹å’Œ |
| æ´›è°· | https://www.luogu.com.cn/problem/U507255 | U507255 çº¦æ•°ä¹‹å’Œâ…¡ |
| ç‰›å®¢ | [çº¦æ•°ä¹‹å’Œ](https://ac.nowcoder.com/acm/problem/22196) | **çº¦æ•°ä¹‹å’Œ** |
| æ´›è°· | https://www.luogu.com.cn/problem/P2424 | P2424 çº¦æ•°å’Œ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240217162152651](assets/image-20240217162152651.png)

> **AcWing é¢˜è§£**
```cpp

/*
ä¾‹ï¼š 
å°† 37800 åˆ†è§£è´¨å› æ•°å¯å¾—

360=2^4*3^3*5^3+7^1

1.ç”±çº¦æ•°ä¸ªæ•°å®šç†å¯çŸ¥ 378000 å…±æœ‰æ­£çº¦æ•°(4+1)Ã—(3+1)Ã—(3+1)Ã—(1+1)=160ä¸ªã€‚
2.ç”±çº¦æ•°å’Œå®šç†å¯çŸ¥ï¼Œ 378000 æ‰€æœ‰æ­£çº¦æ•°çš„å’Œä¸º
(2^0+2^1+2^2+2^3+2^4)Ã—(3^0+3^1+3^2+3^3)Ã—(5^0+5^1+5^2+5^3) x (7^0+7^1)
=(1+2+4+8+16)(1+3+9+27)(1+5+25+125)(1+7)=31Ã—40Ã—156 x8 =1537920
*/

#include <iostream>
#include <algorithm>
#include <unordered_map>
#include <vector>

using namespace std;

typedef long long LL;

const int N = 110, mod = 1e9 + 7;

int main()
{
    int n;
    cin >> n;

    unordered_map<int, int> primes;

    while (n -- )
    {
        int x;
        cin >> x;
		//åˆ†è§£è´¨å› æ•°
        for (int i = 2; i <= x / i; i ++ )
            while (x % i == 0)
            {
                x /= i;
                primes[i] ++ ;
            }

        if (x > 1) primes[x] ++ ;
    }

    LL res = 1;
    for (pair<int,int> p : primes)
    {
        LL a = p.first, b = p.second;
        LL t = 1;
        while (b -- ) t = (t * a + 1) % mod;//ç®—å‡ºå¼€å¤´ä¾‹å­çš„æ‹¬å·é¡¹ 
        res = res * t % mod;//æŠŠæ‹¬å·é¡¹ä¹˜èµ·æ¥ 
    }

    cout << res << endl;

    return 0;
}
```
</details>


### ğŸ¤ 2.3 æœ€å¤§å…¬çº¦æ•° (GCD)

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| leetcode | [1979. æ‰¾å‡ºæ•°ç»„çš„æœ€å¤§å…¬çº¦æ•°](https://leetcode.cn/problems/find-greatest-common-divisor-of-array/) | 1979. æ‰¾å‡ºæ•°ç»„çš„æœ€å¤§å…¬çº¦æ•° |
| ç‰›å®¢ | [æœ€å¤§å…¬çº¦æ•°](https://www.nowcoder.com/practice/cf4091ca75ca47958182dae85369c82c) | **æœ€å¤§å…¬çº¦æ•°** |
| æ´›è°· | https://www.luogu.com.cn/problem/B4025 | B4025 æœ€å¤§å…¬çº¦æ•° |
| æ´›è°· | https://www.luogu.com.cn/training/492388 | æœ€å¤§å…¬çº¦æ•° GCDï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/387666 | æ•°å­¦-æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•°ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/681959 | æœ€å¤§å…¬çº¦æ•°ç»ƒä¹ é¢˜ï¼ˆé¢˜å•ï¼‰ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240217165505252](assets/image-20240217165505252.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> æ±‚è§£æœ€å¤§å…¬çº¦æ•°æœ€ç»å…¸å’Œé«˜æ•ˆçš„ç®—æ³•æ˜¯**æ¬§å‡ é‡Œå¾—ç®—æ³•**ï¼ˆåˆç§°è¾—è½¬ç›¸é™¤æ³•ï¼‰ã€‚
>
> **æ ¸å¿ƒåŸç†**ï¼š`gcd(a, b) = gcd(b, a % b)`ã€‚
>
> **é€’å½’ç»ˆæ­¢æ¡ä»¶**ï¼šå½“ `b` ä¸º `0` æ—¶ï¼Œ`a` å°±æ˜¯æœ€å¤§å…¬çº¦æ•°ã€‚
>
> **æ—¶é—´å¤æ‚åº¦**ï¼šO(log(min(a,b)))ã€‚

> **AcWing é¢˜è§£**

```c++

//æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè¾—è½¬ç›¸é™¤æ³•ï¼‰ 

#include <iostream>

using namespace std;

int gcd(int a, int b)
{
    return b ? gcd(b, a % b) : a;//å¦‚æœ b ä¸ä¸º0ï¼Œåˆ™è¿”å› gcd(b, a % b)ï¼Œå¦åˆ™è¿”å› aã€‚
}

int main()
{
    int n;
    cin >> n;
    while (n -- )
    {
        int a, b;
        cin>>a>>b;
        cout<<gcd(a,b)<<endl;
    }

    return 0;
}
```



> **æ‹“å±•**
>
> 1ã€æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆé€’å½’ï¼‰
>
> ```c++
> int gcd1(int a, int b) {
>     if (b == 0) {
>         return a;
>     } else {
>         return gcd(b, a % b);
>     }
> }
> ```
>
> 2ã€æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè¿­ä»£ï¼‰
>
> ```c++
> int gcd2(int a, int b) {
>     while (b != 0) {
>         int temp = a % b;
>         a = b;
>         b = temp;
>     }
>     return a;
> }
> ```
>
> 3ã€æ›´ç›¸å‡æŸæ³•
>
> ```c++
> int gcd3(int a, int b) {
>     while (a != b) {
>         if (a > b) {
>             a -= b;
>         } else {
>             b -= a;
>         }
>     }
>     return a;
> }
> ```



</details>

---

## Ï† 3. æ¬§æ‹‰å‡½æ•°

> **æ ¸å¿ƒæ€æƒ³**ï¼šæ¬§æ‹‰å‡½æ•° $\varphi(n)$ï¼ˆæˆ– $\phi(n)$ï¼‰è¡¨ç¤ºåœ¨ $1$ åˆ° $n$ çš„æ­£æ•´æ•°ä¸­ï¼Œä¸ $n$ **äº’è´¨**ï¼ˆæœ€å¤§å…¬çº¦æ•°ä¸º1ï¼‰çš„æ•°çš„ä¸ªæ•°ã€‚
>
> **è®¡ç®—å…¬å¼**ï¼š
>
> è‹¥ $n$ çš„æ ‡å‡†è´¨å› æ•°åˆ†è§£ä¸º $n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$ï¼Œåˆ™ï¼š
>
> 
> $$
> \varphi(n) = n \cdot \left(1 - \frac{1}{p_1}\right) \cdot \left(1 - \frac{1}{p_2}\right) \cdots \left(1 - \frac{1}{p_k}\right) = n \cdot \prod_{i=1}^{k} \left(1 - \frac{1}{p_i}\right)
> $$
> 

### ğŸ“œ 3.0 æ´›è°· & ç‰›å®¢é¢˜å•



| æ¥æº | é¢˜ç›®/é¢˜å•                                                    | è¯´æ˜                                                |
| :--- | :----------------------------------------------------------- | :-------------------------------------------------- |
| ç‰›å®¢ | [ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°â…  â€– å•ä¸ªæ•´æ•°](https://www.nowcoder.com/practice/6a22f91ad3904c6cbd624ae5ff6a4eac) | **ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°â…  â€– å•ä¸ªæ•´æ•°**                    |
| æ´›è°· | https://www.luogu.com.cn/problem/T618140                     | T618140 ã€å¾ªç¯åµŒå¥—ã€‘æ¬§æ‹‰å‡½æ•°                        |
| æ´›è°· | https://www.luogu.com.cn/problem/T349567                     | T349567 æ¬§æ‹‰å‡½æ•°                                    |
| æ´›è°· | https://www.luogu.com.cn/problem/U203244                     | U203244 æ¬§æ‹‰å‡½æ•°                                    |
| æ´›è°· | https://www.luogu.com.cn/problem/T349752                     | T349752 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°                              |
| æ´›è°· | https://www.luogu.com.cn/problem/U398681                     | U398681 ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°çº¿æ€§ç­›/phi                  |
| æ´›è°· | https://www.luogu.com.cn/problem/U546927                     | U546927 çº¿æ€§ç­›æ±‚æ¬§æ‹‰å‡½æ•°                            |
| æ´›è°· | https://www.luogu.com.cn/problem/U231250                     | **U231250 ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°ï¼ˆæé«˜+/çœé€‰âˆ’ï¼‰**         |
| æ´›è°· | https://www.luogu.com.cn/problem/T291051                     | **T291051 ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°ï¼ˆæ™®åŠ+/æé«˜ï¼‰**          |
| æ´›è°· | https://www.luogu.com.cn/problem/U578745                     | U578745  çº¿æ€§ç­›æ±‚æ¬§æ‹‰å‡½æ•° å¼±åŒ–ç‰ˆ                    |
| æ´›è°· | https://www.luogu.com.cn/problem/U578687                     | U578687 æ¬§æ‹‰å‡½æ•°ï¼ˆåŠ å¼ºç‰ˆï¼‰~~å¯èƒ½æœ‰ç‚¹æ¯’ç˜¤~~          |
| æ´›è°· | https://www.luogu.com.cn/problem/P5091                       | **P5091 ã€æ¨¡æ¿ã€‘æ‰©å±•æ¬§æ‹‰å®šç†ï¼ˆéš¾åº¦ï¼šæé«˜+/çœé€‰âˆ’ï¼‰** |
| æ´›è°· | https://www.luogu.com.cn/problem/U523821                     | **U523821 ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°ï¼ˆæé«˜+/çœé€‰âˆ’ï¼‰**         |
| æ´›è°· | https://www.luogu.com.cn/training/7052                       | æ¬§æ‹‰å‡½æ•°ä¸æ¬§æ‹‰å®šç†ï¼ˆé¢˜å•ï¼‰                          |



### ğŸ“ 3.1 å®šä¹‰æ³•æ±‚æ¬§æ‹‰å‡½æ•°

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å•                                                    | è¯´æ˜                             |
| :--- | :----------------------------------------------------------- | :------------------------------- |
| ç‰›å®¢ | [ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°â…  â€– å•ä¸ªæ•´æ•°](https://www.nowcoder.com/practice/6a22f91ad3904c6cbd624ae5ff6a4eac) | **ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°â…  â€– å•ä¸ªæ•´æ•°** |
| æ´›è°· | https://www.luogu.com.cn/problem/T618140                     | T618140 ã€å¾ªç¯åµŒå¥—ã€‘æ¬§æ‹‰å‡½æ•°     |
| æ´›è°· | https://www.luogu.com.cn/problem/T349567                     | T349567 æ¬§æ‹‰å‡½æ•°                 |
| æ´›è°· | https://www.luogu.com.cn/problem/U203244                     | U203244 æ¬§æ‹‰å‡½æ•°                 |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240217171909347](assets/image-20240217171909347.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> ç›´æ¥æ ¹æ®å…¬å¼è®¡ç®— $\varphi(n)$ã€‚
>
> 1.  **åˆ†è§£è´¨å› æ•°**ï¼šé¦–å…ˆå¯¹ `n` è¿›è¡Œè´¨å› æ•°åˆ†è§£ï¼Œæ‰¾å‡ºæ‰€æœ‰çš„è´¨å› å­ $p_i$ã€‚
> 2.  **å¥—ç”¨å…¬å¼**ï¼šåˆå§‹åŒ– `res = n`ï¼Œå¯¹äºæ¯ä¸ªæ‰¾åˆ°çš„è´¨å› å­ `p`ï¼Œæ‰§è¡Œ `res = res / p * (p - 1)`ã€‚è¿™ç­‰ä»·äº `res * (1 - 1/p)`ï¼Œä½†é¿å…äº†æµ®ç‚¹æ•°è¿ç®—ã€‚
> 3.  **ç®—æ³•æµç¨‹**ï¼šå’Œåˆ†è§£è´¨å› æ•°çš„ç®—æ³•å‡ ä¹ä¸€æ ·ï¼Œåªæ˜¯åœ¨æ‰¾åˆ°ä¸€ä¸ªè´¨å› å­ `p` åï¼Œåº”ç”¨æ¬§æ‹‰å‡½æ•°çš„å…¬å¼æ›´æ–° `res`ï¼Œç„¶åæŠŠ `n` ä¸­æ‰€æœ‰çš„å› å­ `p` é™¤å°½ã€‚
> 4.  **æ—¶é—´å¤æ‚åº¦**ï¼šO(âˆšn)ã€‚



>  å®šä¹‰æ³•æ±‚æ¬§æ‹‰å‡½æ•°ï¼ˆæ¨¡æ¿ï¼‰

```c++
int phi(int x)
{
    int res = x;//resåˆå§‹å€¼æ˜¯x
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0)
        {
            res = res / i * (i - 1);//ç›¸å½“äº N * (1 - 1 / p)ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢å°æ•° 
            while (x % i == 0) x /= i;
        }
    if (x > 1) res = res / x * (x - 1);

    return res;
}
```



> **AcWing é¢˜è§£**

```cpp

//äº’è´¨æ˜¯å…¬çº¦æ•°åªæœ‰1çš„ä¸¤ä¸ªæ•´æ•°ï¼Œå«åšäº’è´¨æ•´æ•°ã€‚

#include <iostream>

using namespace std;


int phi(int x)
{
    int res = x;//resåˆå§‹å€¼æ˜¯x!!
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0)
        {
            res = res / i * (i - 1);//ç›¸å½“äº N * (1 - 1 / p)ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢å°æ•° 
            while (x % i == 0) x /= i;
        }
    if (x > 1) res = res / x * (x - 1);

    return res;
}


int main()
{
    int n;
    cin >> n;
    while (n -- )
    {
        int x;
        cin >> x;
        cout << phi(x) << endl;
    }

    return 0;
}
```

</details>

### â³ 3.2 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/T349752 | T349752 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/U398681 | U398681 ã€æ¨¡æ¿ã€‘æ¬§æ‹‰å‡½æ•°çº¿æ€§ç­›/phi |
| æ´›è°· | https://www.luogu.com.cn/problem/U546927 | U546927 çº¿æ€§ç­›æ±‚æ¬§æ‹‰å‡½æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/U578745 | U578745  çº¿æ€§ç­›æ±‚æ¬§æ‹‰å‡½æ•° å¼±åŒ–ç‰ˆ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240219110124715](assets/image-20240219110124715.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> å½“éœ€è¦æ±‚ $1$ åˆ° $n$ æ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°æ—¶ï¼Œå¯ä»¥åœ¨çº¿æ€§ç­›è´¨æ•°çš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ã€‚åˆ©ç”¨æ¬§æ‹‰å‡½æ•°çš„æ€§è´¨ï¼š
>
> 1.  å¦‚æœ `p` æ˜¯è´¨æ•°ï¼Œ$\varphi(p) = p - 1$ã€‚
> 2.  å¦‚æœ `i % p == 0`ï¼Œåˆ™ `i` å’Œ `i*p` å«æœ‰ç›¸åŒçš„è´¨å› å­ã€‚æ­¤æ—¶ $\varphi(i \cdot p) = \varphi(i) \cdot p$ã€‚
> 3.  å¦‚æœ `i % p != 0`ï¼Œåˆ™ `i` å’Œ `p` äº’è´¨ã€‚æ ¹æ®ç§¯æ€§å‡½æ•°æ€§è´¨ï¼Œ$\varphi(i \cdot p) = \varphi(i) \cdot \varphi(p) = \varphi(i) \cdot (p - 1)$ã€‚
>
> åœ¨çº¿æ€§ç­›çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®ä»¥ä¸Šä¸‰ç§æƒ…å†µé€’æ¨è®¡ç®—å‡ºæ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°å€¼ã€‚



> **æ ¸å¿ƒå‡½æ•°ä»£ç **

```c++
int primes[N], cnt;     // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°
int euler[N];           // å­˜å‚¨æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°
bool st[N];         // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰


void get_eulers(int n)
{
    euler[1] = 1;
    for (int i = 2; i <= n; i ++ )
    {
        if (!st[i])
        {
            primes[cnt ++ ] = i;
            euler[i] = i - 1;
        }
        for (int j = 0; primes[j] <= n / i; j ++ )
        {
            int t = primes[j] * i;
            st[t] = true;
            if (i % primes[j] == 0)
            {
                euler[t] = euler[i] * primes[j];
                break;
            }
            euler[t] = euler[i] * (primes[j] - 1);
        }
    }
}
```



> **AcWing é¢˜è§£**

```cpp
#include <iostream>

using namespace std;

typedef long long LL;

const int N = 1000010;


int primes[N], cnt;
int euler[N];//å­˜å‚¨å…ƒç´ çš„æ¬§æ‹‰å‡½æ•° 
bool st[N];


void get_eulers(int n)
{
	// 1 çš„æ¬§æ‹‰å‡½æ•°æ˜¯ 1  
    euler[1] = 1;
    
    //åœ¨çº¿æ€§ç­›æ³•çš„è¿‡ç¨‹ä¸­æ±‚å‡º 1 åˆ° n çš„æ¬§æ‹‰å‡½æ•° 
    for (int i = 2; i <= n; i ++ )
    {
    	//å½“ i æ˜¯è´¨æ•° 
        if (!st[i])
        {
            primes[cnt ++ ] = i;
            //è´¨æ•°çš„æ¬§æ‹‰å‡½æ•°ä¸º i - 1 
            euler[i] = i - 1;
        }
        
        for (int j = 0; primes[j] <= n / i; j ++ )
        {
        	//ç­›æ‰å¯¹åº”primes[j]çš„åˆæ•° 
            int t = primes[j] * i;
            st[t] = true;
            
            //å½“ i % primes[j] == 0 æ—¶ï¼Œprimes[j] æ˜¯ i çš„æœ€å°è´¨å› å­ï¼Œä¹Ÿæ˜¯ primes[j] * i çš„æœ€å°è´¨å› å­  
            if (i % primes[j] == 0)
            {
            	//ä¿®æ­£ primes[j] * i çš„æ¬§æ‹‰å‡½æ•° 
                euler[t] = euler[i] * primes[j];
                break;
            }
            
            //å½“ i % primes[j] ï¼= 0 æ—¶ï¼Œprimes[j] ä¸æ˜¯ i çš„æœ€å°è´¨å› å­ï¼Œä½†æ˜¯ primes[j] * i çš„æœ€å°è´¨å› å­
            //ä¿®æ­£ primes[j] * i çš„æ¬§æ‹‰å‡½æ•°
            euler[t] = euler[i] * (primes[j] - 1);
        }
    }
}


int main()
{
    int n;
    cin >> n;

    get_eulers(n);

    LL res = 0;
    for (int i = 1; i <= n; i ++ ) res += euler[i];

    cout << res << endl;

    return 0;
}
```
</details>

### ğŸ‘‘ 3.3 æ¬§æ‹‰å®šç†å’Œè´¹é©¬å°å®šç†

> **æ¬§æ‹‰å®šç† (Euler's Theorem)**
>
> è‹¥æ­£æ•´æ•° $a$ ä¸ $n$ **äº’è´¨**ï¼ˆ$\gcd(a, n) = 1$ï¼‰ï¼Œåˆ™ï¼š
> $$
> a^{\varphi(n)} \equiv 1 \pmod{n}
> $$
>
> **è´¹é©¬å°å®šç† (Fermat's Little Theorem)**
>
> æ¬§æ‹‰å®šç†çš„ç‰¹ä¾‹ã€‚è‹¥ $p$ æ˜¯ä¸€ä¸ª**è´¨æ•°**ï¼Œä¸”æ•´æ•° $a$ ä¸æ˜¯ $p$ çš„å€æ•°ï¼ˆ$\gcd(a, p) = 1$ï¼‰ï¼Œåˆ™ï¼š
> $$
> a^{p-1} \equiv 1 \pmod{p}
> $$
> è¿™ä¸¤ä¸ªå®šç†æ˜¯æ¨¡è¿ç®—ä¸­è¿›è¡Œé™å¹‚çš„æ ¸å¿ƒå·¥å…·ï¼Œå¸¸ç”¨äºè®¡ç®— $a^b \pmod{n}$ï¼Œç‰¹åˆ«æ˜¯å½“ $b$ éå¸¸å¤§æ—¶ã€‚

---

## ğŸš€ 4. å¿«é€Ÿå¹‚

> **æ ¸å¿ƒæ€æƒ³**ï¼šå¿«é€Ÿå¹‚ï¼ˆä¹Ÿç§°äºŒè¿›åˆ¶å–å¹‚ï¼‰æ˜¯ä¸€ç§åœ¨ $O(\log k)$ æ—¶é—´å†…è®¡ç®— $a^k \pmod{p}$ çš„é«˜æ•ˆç®—æ³•ã€‚å…¶æ ¸å¿ƒæ˜¯å°†æŒ‡æ•° $k$ è¿›è¡ŒäºŒè¿›åˆ¶æ‹†åˆ†ã€‚
>
> ä¾‹å¦‚ï¼Œè®¡ç®— $a^{13}$ï¼Œ$13$ çš„äºŒè¿›åˆ¶æ˜¯ $1101_2$ã€‚
> $$
> a^{13} = a^{8+4+1} = a^8 \cdot a^4 \cdot a^1
> $$
> æˆ‘ä»¬åªéœ€é¢„å¤„ç†å‡º $a^1, a^2, a^4, a^8, \dots$ï¼ˆé€šè¿‡ä¸æ–­å¹³æ–¹å¾—åˆ°ï¼‰ï¼Œç„¶åæ ¹æ® $k$ çš„äºŒè¿›åˆ¶ä½æ˜¯å¦ä¸º 1 æ¥å†³å®šæ˜¯å¦å°†å¯¹åº”çš„é¡¹ä¹˜å…¥ç»“æœã€‚

### ğŸ“œ 4.0 æ´›è°· & ç‰›å®¢é¢˜å•

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| ç‰›å®¢ | [ã€æ¨¡æ¿ã€‘å¿«é€Ÿå¹‚â…  â€– æ•´æ•°](https://www.nowcoder.com/practice/3d624107a6904da1bd0e8c9c85e17167) | **ã€æ¨¡æ¿ã€‘å¿«é€Ÿå¹‚â…  â€– æ•´æ•°** |
| ç‰›å®¢ | [å¿«é€Ÿå¹‚_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/defdedf4fe984c6c91eefa6b00d5f4f0) | **å¿«é€Ÿå¹‚**                 |
| æ´›è°· | https://www.luogu.com.cn/problem/P1226                       | P1226 ã€æ¨¡æ¿ã€‘å¿«é€Ÿå¹‚       |
| æ´›è°· | https://www.luogu.com.cn/problem/U579207                     | U579207 å¿«é€Ÿå¹‚æ±‚é€†å…ƒ       |
| æ´›è°· | https://www.luogu.com.cn/training/53467                      | å¿«é€Ÿå¹‚ã€é€†å…ƒï¼ˆé¢˜å•ï¼‰       |
| æ´›è°· | https://www.luogu.com.cn/training/34972                      | å¿«é€Ÿå¹‚ï¼ˆé¢˜å•ï¼‰             |


### âš¡ 4.1 å¿«é€Ÿå¹‚

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| ç‰›å®¢ | [ã€æ¨¡æ¿ã€‘å¿«é€Ÿå¹‚â…  â€– æ•´æ•°](https://www.nowcoder.com/practice/3d624107a6904da1bd0e8c9c85e17167) | **ã€æ¨¡æ¿ã€‘å¿«é€Ÿå¹‚â…  â€– æ•´æ•°** |
| ç‰›å®¢ | [å¿«é€Ÿå¹‚_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/defdedf4fe984c6c91eefa6b00d5f4f0) | **å¿«é€Ÿå¹‚**                 |
| æ´›è°· | https://www.luogu.com.cn/problem/P1226                       | P1226 ã€æ¨¡æ¿ã€‘å¿«é€Ÿå¹‚       |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240219171741661](assets/image-20240219171741661.png)



> **æ ¸å¿ƒå‡½æ•°ä»£ç **

```c++
LL qmi(int a, int b, int p)
{
    LL res = 1 % p;
    while (b)
    {
        if (b & 1) res = res * a % p;
        a = (LL)a * a % p;
        b >>= 1;
    }
    return res;
}
```



> **AcWing é¢˜è§£**

```cpp
#include <iostream>
using namespace std;

typedef long long LL;

// è®¡ç®— (a^k) % p
LL qmi(int a, int k, int p)
{
    LL res = 1;
    while (k)
    {
        // å¦‚æœ k çš„å½“å‰æœ€ä½ä½æ˜¯ 1ï¼Œåˆ™å°†åº•æ•°ä¹˜å…¥ç»“æœ
        if (k & 1) res = res * a % p;
        // åº•æ•°å¹³æ–¹ï¼Œç”¨äºä¸‹ä¸€è½®è®¡ç®—
        a = (LL)a * a % p;
        // æŒ‡æ•°å³ç§»ä¸€ä½ï¼Œè€ƒå¯Ÿä¸‹ä¸€ä½
        k >>= 1;
    }
    return res;
}

int main()
{
    int n;
    cin >> n;
    while (n -- )
    {
        int a, b, p;
        cin >> a >> b >> p;
        cout << qmi(a, b, p) << endl;
    }
    return 0;
}
```
</details>

### ğŸ”„ 4.2 å¿«é€Ÿå¹‚æ±‚é€†å…ƒ

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U579207                     | U579207 å¿«é€Ÿå¹‚æ±‚é€†å…ƒ |
| æ´›è°· | [https://www.luogu.com.cn/training/53467](https://www.luogu.com.cn/training/53467) | å¿«é€Ÿå¹‚ã€é€†å…ƒï¼ˆé¢˜å•ï¼‰ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240219174812186](assets/image-20240219174812186.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> æ¨¡é€†å…ƒæ˜¯æŒ‡ï¼Œå¯¹äºæ•´æ•° `a` å’Œæ¨¡æ•° `p`ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªæ•´æ•° `x` ä½¿å¾— $a \cdot x \equiv 1 \pmod{p}$ï¼Œåˆ™ç§° `x` æ˜¯ `a` å…³äºæ¨¡ `p` çš„é€†å…ƒã€‚
>
> å½“ **`p` æ˜¯è´¨æ•°** ä¸” `a` ä¸æ˜¯ `p` çš„å€æ•°æ—¶ï¼Œæ ¹æ®**è´¹é©¬å°å®šç†** $a^{p-1} \equiv 1 \pmod{p}$ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºï¼š
> $$ a \cdot a^{p-2} \equiv 1 \pmod{p} $$
> å› æ­¤ï¼Œ$a^{p-2}$ å°±æ˜¯ `a` å…³äºæ¨¡ `p` çš„é€†å…ƒã€‚æˆ‘ä»¬å¯ä»¥ç”¨å¿«é€Ÿå¹‚ç®—æ³•é«˜æ•ˆè®¡ç®— $a^{p-2} \pmod p$ã€‚

> **AcWing é¢˜è§£**
```cpp
#include <iostream>

using namespace std;

typedef long long LL;


LL qmi(int a, int b, int p)
{
    LL res = 1 % p;
    while (b)
    {
        if (b & 1) res = res * a % p;
        a = (LL)a * a % p;
        b >>= 1;
    }
    return res;
}


int main()
{
    int n;
    cin>>n;
    while (n -- )
    {
        int a, p;
        cin>>a>>p;
        /*
        a å’Œ p äº’è´¨å¹¶ä¸” p æ˜¯è´¨æ•°æ—¶ a çš„é€†å…ƒä¸º a^p-2 mod p
        å›  p ä¸ºè´¨æ•°ï¼Œå› å­åªæœ‰ 1 å’Œ pï¼Œæ‰€ä»¥ a å’Œ p å­˜åœ¨é™¤ 1 ä»¥å¤–çš„å…¬å› æ•°å³ä¸äº’è´¨çš„è¯ï¼Œé‚£ä¸ªå…¬å› æ•°åªèƒ½æ˜¯ p
        æ‰€ä»¥åªéœ€è¦åˆ¤æ–­ p æ˜¯å¦ä¸º a çš„å› å­å°±å¯ä»¥ç¡®å®š a å’Œ p æ˜¯å¦äº’è´¨
        */
        if (a % p == 0) puts("impossible");
        else cout<<qmi(a, p - 2, p)<<endl;
    }

    return 0;
}
```
</details>

---

## ğŸ“ 5. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

> **æ ¸å¿ƒæ€æƒ³**ï¼šæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ç”¨äºæ±‚è§£å½¢å¦‚ $a \cdot x + b \cdot y = \gcd(a, b)$ çš„æ–¹ç¨‹çš„ä¸€ç»„æ•´æ•°è§£ $(x, y)$ã€‚å®ƒåœ¨æ ‡å‡†æ¬§å‡ é‡Œå¾—ç®—æ³•çš„é€’å½’å›æº¯è¿‡ç¨‹ä¸­ï¼Œé€’æ¨åœ°æ±‚å‡ºè§£ã€‚
>
> **é€’æ¨å…³ç³»**ï¼š
> è®¾æˆ‘ä»¬é€šè¿‡é€’å½’è°ƒç”¨ `exgcd(b, a % b, x', y')` å¾—åˆ°äº† 
> $$
> b \cdot x' + (a \pmod b) \cdot y' = \gcd(b, a \pmod b)
> $$
> å› ä¸º 
> $$
> a \pmod b = a - \lfloor a/b \rfloor \cdot b
> $$
> 
>
> ä»£å…¥ä¸Šå¼å¹¶æ•´ç†å¯å¾—ï¼š
> $$
> a \cdot y' + b \cdot (x' - \lfloor a/b \rfloor \cdot y') = \gcd(a, b)
> $$
> 
>
> æ•…åŸæ–¹ç¨‹çš„è§£ä¸º $x = y', y = x' - \lfloor a/b \rfloor \cdot y'$ã€‚
>
> | ç‰¹æ€§ | æè¿° |
> | :--- | :--- |
> | **è¾“å…¥** | ä¸¤ä¸ªæ•´æ•° $a$, $b$ |
> | **è¾“å‡º** | ä¸‰å…ƒç»„ $(d, x, y)$ï¼Œæ»¡è¶³ $d = \gcd(a, b) = a \cdot x + b \cdot y$ |
> | **å…³é”®åº”ç”¨** | **æ±‚è§£æ¨¡è¿ç®—ä¸‹çš„ä¹˜æ³•é€†å…ƒ** (å½“ $\gcd(a, m)=1$ æ—¶) |
> | **æ—¶é—´å¤æ‚åº¦** | $O(\log(\min(a, b)))$ï¼Œä¸æ ‡å‡†æ¬§å‡ é‡Œå¾—ç®—æ³•ç›¸åŒï¼Œéå¸¸é«˜æ•ˆ |

### ğŸ“œ 5.0 æ´›è°·é¢˜å•



| æ¥æº | é¢˜ç›®/é¢˜å•                                | è¯´æ˜                              |
| :--- | :--------------------------------------- | :-------------------------------- |
| æ´›è°· | https://www.luogu.com.cn/problem/T270218 | T270218 ã€æ¨¡æ¿ã€‘æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•  |
| æ´›è°· | https://www.luogu.com.cn/problem/T114032 | T114032 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•          |
| æ´›è°· | https://www.luogu.com.cn/problem/U553464 | U553464 æ‰©å±•æ¬§å‡ é‡Œå¾—              |
| æ´›è°· | https://www.luogu.com.cn/problem/P1082   | P1082 [NOIP 2012 æé«˜ç»„] åŒä½™æ–¹ç¨‹ |
| æ´›è°· | https://www.luogu.com.cn/problem/T580848 | T580848 çº¿æ€§åŒä½™æ–¹ç¨‹              |
| æ´›è°· | https://www.luogu.com.cn/training/164481 | æ‹“å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆé¢˜å•ï¼‰          |
| æ´›è°· | https://www.luogu.com.cn/training/5539   | åŒä½™æ–¹ç¨‹-ä»å…¥é—¨åˆ°å…¥åœŸï¼ˆé¢˜å•ï¼‰     |



### âœ’ï¸ 5.1 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/T270218 | T270218 ã€æ¨¡æ¿ã€‘æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• |
| æ´›è°· | https://www.luogu.com.cn/problem/T114032 | T114032 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•         |
| æ´›è°· | https://www.luogu.com.cn/problem/U553464 | U553464 æ‰©å±•æ¬§å‡ é‡Œå¾—             |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240220095303626](assets/image-20240220095303626.png)



![image-20240220100448292](assets/image-20240220100448292.png)



> **æ ¸å¿ƒå‡½æ•°ä»£ç **

```c++
// æ±‚x, yï¼Œä½¿å¾—ax + by = gcd(a, b)
int exgcd(int a, int b, int &x, int &y)
{
    if (!b)
    {
        x = 1; y = 0;
        return a;
    }
    int d = exgcd(b, a % b, y, x);
    y -= (a/b) * x;
    return d;
}
```



> **AcWing é¢˜è§£**

```cpp
#include <iostream>
#include <algorithm>

using namespace std;

int exgcd(int a, int b, int &x, int &y)//å¿…é¡»ä¼ å¼•ç”¨ï¼Œä¸èƒ½ç”¨å…¨å±€å˜é‡
{
	//b ä¸º 0 æ—¶ï¼Œæœ€å¤§å…¬çº¦æ•°ä¸º a ï¼Œæ‰€ä»¥ a x 1 + 0 x 0 = a 
    if (!b)
    {
        x = 1, y = 0;
        return a;
    }
    //b ä¸ä¸º 0 æ—¶ï¼Œè¯¦ç»†è¿‡ç¨‹è§æ‰‹åŠ¨æ¨¡æ‹Ÿ 
    int d = exgcd(b, a % b, y, x);
    y -= a / b * x;//è°ƒç”¨å‡½æ•°æ±‚å¾—æœ€å¤§å…¬çº¦æ•°ä¹‹åå‘ç° y è¦å‡ a / b * x æ‰æ˜¯ b çš„çœŸæ­£çš„ç³»æ•°
    return d;
}

int main()
{
    int n;
    scanf("%d", &n);//æ•°æ®èŒƒå›´æ¯”è¾ƒå¤§æ—¶ç”¨scanfä¼šå¿«å¾ˆå¤š

    while (n -- )
    {
        int a, b;
        scanf("%d%d", &a, &b);
        int x, y;
        exgcd(a, b, x, y);
        printf("%d %d\n", x, y);
    }

    return 0;
}

```
</details>

### â›“ï¸ 5.2 çº¿æ€§åŒä½™æ–¹ç¨‹

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/P1082                       | P1082 [NOIP 2012 æé«˜ç»„] åŒä½™æ–¹ç¨‹ |
| æ´›è°· | https://www.luogu.com.cn/problem/T580848                     | T580848 çº¿æ€§åŒä½™æ–¹ç¨‹              |
| æ´›è°· | [https://www.luogu.com.cn/training/5539](https://www.luogu.com.cn/training/5539) | åŒä½™æ–¹ç¨‹-ä»å…¥é—¨åˆ°å…¥åœŸï¼ˆé¢˜å•ï¼‰ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240220162334884](assets/image-20240220162334884.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> æ±‚è§£å½¢å¦‚ $a \cdot x \equiv b \pmod m$ çš„çº¿æ€§åŒä½™æ–¹ç¨‹ã€‚
>
> 1.  **è½¬åŒ–**ï¼šæ–¹ç¨‹ç­‰ä»·äº $a \cdot x = m \cdot (-y) + b$ï¼Œå³ $a \cdot x + m \cdot y = b$ã€‚
> 2.  **æ±‚è§£**ï¼šè¿™æ­£æ˜¯æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥è§£å†³çš„å½¢å¼ã€‚æˆ‘ä»¬å…ˆç”¨ `exgcd(a, m, x, y)` æ±‚å‡º $a \cdot x_0 + m \cdot y_0 = \gcd(a, m)$ çš„ä¸€ç»„è§£ $(x_0, y_0)$ã€‚
> 3.  **æœ‰è§£æ¡ä»¶**ï¼šåŸæ–¹ç¨‹æœ‰è§£ï¼Œå½“ä¸”ä»…å½“ $b$ æ˜¯ $\gcd(a, m)$ çš„å€æ•°ã€‚å¦‚æœ $b \pmod{\gcd(a,m)} \neq 0$ï¼Œåˆ™æ— è§£ã€‚
> 4.  **æ„é€ è§£**ï¼šå¦‚æœæœ‰è§£ï¼Œä»¤ $d = \gcd(a,m)$ã€‚æˆ‘ä»¬å°† $a \cdot x_0 + m \cdot y_0 = d$ ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥ $b/d$ï¼Œå¾—åˆ° $a \cdot (x_0 \cdot b/d) + m \cdot (y_0 \cdot b/d) = b$ã€‚
> 5.  **é€šè§£**ï¼šæ–¹ç¨‹çš„ä¸€ä¸ªç‰¹è§£æ˜¯ $x = x_0 \cdot (b/d)$ã€‚é€šè§£ä¸º $x' = x + k \cdot (m/d)$ã€‚é¢˜ç›®è¦æ±‚æœ€å°æ­£æ•´æ•°è§£ï¼Œå¯ä»¥é€šè¿‡å–æ¨¡å¾—åˆ° `(x % (m/d) + (m/d)) % (m/d)`ã€‚æ­¤é¢˜æ•°æ®èŒƒå›´ä¸‹ï¼Œç›´æ¥ `x % m` å³å¯ã€‚

> **AcWing é¢˜è§£**
```cpp
#include <iostream>
#include <algorithm>

using namespace std;

typedef long long LL;


int exgcd(int a, int b, int &x, int &y)
{
    if (!b)
    {
        x = 1, y = 0;
        return a;
    }
    int d = exgcd(b, a % b, y, x);
    y -= a / b * x;
    return d;
}


int main()
{
    int n;
    scanf("%d", &n);
    while (n -- )
    {
        int a, b, m;
        scanf("%d%d%d", &a, &b, &m);

        int x, y;
        int d = exgcd(a, m, x, y);
        // b ä¸æ˜¯ a å’Œ m çš„æœ€å¤§å…¬çº¦æ•°çš„å€æ•° ï¼Œæ— è§£ 
        if (b % d) puts("impossible");
        //ax + by = gcd ,ax0 + by0 = b è§£å¾— x0 = x * b / gcd , y0 = y * b / gcdï¼ˆæ‰©å¤§ b / gcd å€ï¼‰
        /*
        ç”±é¢˜å¯çŸ¥ b çš„èŒƒå›´å‡ ä¹å°±æ˜¯ int çš„èŒƒå›´ï¼Œæ‰€ä»¥è¦è½¬æˆ LL ï¼Œé˜²æ­¢x * bç»“æœæº¢å‡ºï¼Œä½†æ˜¯é¢˜ä¸­æ‰€è¯´è¾“å‡ºç­”æ¡ˆå¿…é¡»åœ¨ int èŒƒå›´ä¹‹å†…ï¼Œæ‰€ä»¥ç”¨ %d ä¿è¯è¾“å‡ºç­”æ¡ˆä¸º intï¼ˆ%lld ä¸º long longï¼‰
        */
        else printf("%d\n", (LL)x * b / d % m);
    }

    return 0;
}

```
</details>

---

## ğŸ‡¨ğŸ‡³ 6. ä¸­å›½å‰©ä½™å®šç† (*)

> **æ ¸å¿ƒæ€æƒ³**ï¼šä¸­å›½å‰©ä½™å®šç† (CRT) ç”¨äºæ±‚è§£ä¸€ç»„å½¢å¦‚ $x \equiv a_i \pmod{m_i}$ çš„çº¿æ€§åŒä½™æ–¹ç¨‹ç»„ï¼Œå…¶ä¸­æ¨¡æ•° $m_i$ **ä¸¤ä¸¤äº’è´¨**ã€‚
>
> **è§£æ³•**ï¼š
>
> 1.  ä»¤ $M = \prod m_i$ã€‚
> 2.  å¯¹æ¯ä¸ªæ–¹ç¨‹ï¼Œä»¤ $M_i = M / m_i$ã€‚
> 3.  æ±‚ $M_i$ åœ¨æ¨¡ $m_i$ ä¸‹çš„é€†å…ƒ $M_i^{-1}$ã€‚
> 4.  æœ€ç»ˆè§£ä¸º $x = \sum (a_i \cdot M_i \cdot M_i^{-1}) \pmod M$ã€‚
>
> å½“æ¨¡æ•°ä¸äº’è´¨æ—¶ï¼Œéœ€è¦ä½¿ç”¨**æ‰©å±•ä¸­å›½å‰©ä½™å®šç†**ï¼Œé€šè¿‡ä¸¤ä¸¤åˆå¹¶æ–¹ç¨‹æ¥æ±‚è§£ã€‚



> **è¯¦ç»†ä»‹ç»**
>
> è®¾ $m_1, m_2, \ldots, m_k$ æ˜¯**ä¸¤ä¸¤äº’è´¨**çš„æ­£æ•´æ•°ï¼ˆå³å¯¹äºä»»æ„ $i \neq j$ï¼Œæœ‰ $\gcd(m_i, m_j) = 1$ï¼‰ã€‚
>
> åˆ™å¯¹äºä»»æ„çš„æ•´æ•° $a_1, a_2, \ldots, a_k$ï¼Œä¸‹é¢çš„åŒä½™æ–¹ç¨‹ç»„ï¼š
> $$
> \begin{cases}
> x \equiv a_1 \pmod{m_1} \\
> x \equiv a_2 \pmod{m_2} \\
> \vdots \\
> x \equiv a_k \pmod{m_k}
> \end{cases}
> $$
>
> åœ¨æ¨¡ $M = m_1 \times m_2 \times \cdots \times m_k$ ä¸‹æœ‰**å”¯ä¸€è§£**ã€‚æ±‚è§£æ–¹æ³•ï¼š
>
> 1. è®¡ç®—æ‰€æœ‰æ¨¡æ•°çš„ä¹˜ç§¯ï¼š$M = m_1 \times m_2 \times \cdots \times m_k$
> 2. å¯¹æ¯ä¸ª $i$ï¼Œè®¡ç®—ï¼š$M_i = \frac{M}{m_i}$
> 3. å¯¹æ¯ä¸ª $i$ï¼Œæ±‚ $M_i$ åœ¨æ¨¡ $m_i$ ä¸‹çš„ä¹˜æ³•é€†å…ƒ $y_i$ï¼ˆå³ $M_i y_i \equiv 1 \pmod{m_i}$ï¼‰
> 4. æ–¹ç¨‹ç»„çš„è§£ä¸ºï¼š$x \equiv a_1 M_1 y_1 + a_2 M_2 y_2 + \cdots + a_k M_k y_k \pmod{M}$
>
> **å…¬å¼**ï¼š
> $$
> x \equiv \sum_{i=1}^k a_i M_i y_i \pmod{M}
> $$
>
> 

### ğŸ“œ 6.0 æ´›è°· & ç‰›å®¢é¢˜å•

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| ç‰›å®¢ç«èµ› | [æ›¹å†²å…»çŒª](https://ac.nowcoder.com/acm/problem/50569)        | æ›¹å†²å…»çŒª                                    |
| ç‰›å®¢ç«èµ› | [Strange Way to Express Integers](https://ac.nowcoder.com/acm/problem/50570) | Strange Way to Express Integers             |
| æ´›è°·     | https://www.luogu.com.cn/problem/P1495                       | P1495 ã€æ¨¡æ¿ã€‘ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰/ æ›¹å†²å…»çŒª |
| æ´›è°·     | https://www.luogu.com.cn/problem/P4777                       | P4777 ã€æ¨¡æ¿ã€‘æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆEXCRTï¼‰     |
| ç‰›å®¢ç«èµ› | [ä¸­å›½å‰©ä½™å®šç†](https://ac.nowcoder.com/acm/skill/detail/acm/1620) | ä¸­å›½å‰©ä½™å®šç†ï¼ˆé¢˜å•ï¼‰                        |
| æ´›è°·     | https://www.luogu.com.cn/training/61614                      | (æ‰©å±•)ä¸­å›½å‰©ä½™å®šç†ï¼ˆé¢˜å•ï¼‰                  |
| æ´›è°·     | https://www.luogu.com.cn/training/87157                      | ã€æ•°è®ºã€‘CRT ä¸ ExCRTï¼ˆé¢˜å•ï¼‰                |
| æ´›è°·     | https://www.luogu.com.cn/training/561502                     | ã€”Fancy Zoneã€•ä¸­å›½å‰©ä½™å®šç†ä¸BSGSï¼ˆé¢˜å•ï¼‰    |
| æ´›è°·     | https://www.luogu.com.cn/training/18315                      | ä¸­å›½å‰©ä½™å®šç†ï¼ˆé¢˜å•ï¼‰                        |
|          |                                                              |                                             |



### â“ 6.1 è¡¨è¾¾æ•´æ•°çš„å¥‡æ€ªæ–¹å¼

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | [P4777 ã€æ¨¡æ¿ã€‘æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆEXCRTï¼‰](https://www.luogu.com.cn/problem/P4777) | **P4777** |
| ç‰›å®¢ç«èµ› | [Strange Way to Express Integers](https://ac.nowcoder.com/acm/problem/50570) | Strange Way to Express Integers |
| æ´›è°· | [https://www.luogu.com.cn/training/61614](https://www.luogu.com.cn/training/61614) | (æ‰©å±•)ä¸­å›½å‰©ä½™å®šç†ï¼ˆé¢˜å•ï¼‰ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240220165253585](assets/image-20240220165253585.png)

> **è§£æ³•æ€è·¯ (æ‰©å±•ä¸­å›½å‰©ä½™å®šç†)**ï¼š
>
> ç”±äºæ¨¡æ•°ä¸ä¸€å®šä¸¤ä¸¤äº’è´¨ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸¤ä¸¤åˆå¹¶çš„æ€æƒ³ã€‚
>
> å‡è®¾æˆ‘ä»¬å·²ç»æ±‚å‡ºäº†å‰ $i-1$ ä¸ªæ–¹ç¨‹çš„è§£ï¼Œæ»¡è¶³ $x \equiv a_1 \pmod{m_1}$ã€‚è¿™ä¸ªè§£å¯ä»¥è¡¨ç¤ºä¸º $x = k \cdot m_1 + a_1$ã€‚
> ç°åœ¨è¦æ»¡è¶³ç¬¬ $i$ ä¸ªæ–¹ç¨‹ $x \equiv a_2 \pmod{m_2}$ã€‚
>
> 1.  **è”ç«‹**ï¼š$k \cdot m_1 + a_1 \equiv a_2 \pmod{m_2}$ã€‚
> 2.  **å˜å½¢**ï¼š$k \cdot m_1 \equiv a_2 - a_1 \pmod{m_2}$ã€‚
> 3.  **æ±‚è§£**ï¼šè¿™æ˜¯ä¸€ä¸ªå…³äº $k$ çš„çº¿æ€§åŒä½™æ–¹ç¨‹ï¼Œå¯ä»¥ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚è§£ã€‚
> 4.  **åˆå¹¶**ï¼šè§£å‡º $k$ çš„ä¸€ä¸ªç‰¹è§£ $k_0$ åï¼Œé€šè§£ä¸º $k = k_0 + t \cdot (m_2/d)$ã€‚ä»£å› $x$ çš„è¡¨è¾¾å¼ï¼Œå¾—åˆ°æ–°çš„è§£ $x = (k_0 + t \cdot m_2/d) \cdot m_1 + a_1 = (k_0 \cdot m_1 + a_1) + t \cdot \operatorname{lcm}(m_1, m_2)$ã€‚
> 5.  **æ–°æ–¹ç¨‹**ï¼šè¿™ç­‰ä»·äºä¸€ä¸ªæ–°çš„åŒä½™æ–¹ç¨‹ $x \equiv (k_0 \cdot m_1 + a_1) \pmod{\operatorname{lcm}(m_1, m_2)}$ã€‚
> 6.  **è¿­ä»£**ï¼šé‡å¤æ­¤è¿‡ç¨‹ï¼Œç›´åˆ°åˆå¹¶å®Œæ‰€æœ‰æ–¹ç¨‹ã€‚

> **AcWing é¢˜è§£**
```cpp
#include <iostream>
#include <algorithm>

using namespace std;

typedef long long LL;


LL exgcd(LL a, LL b, LL &x, LL &y)
{
    if (!b)
    {
        x = 1, y = 0;
        return a;
    }

    LL d = exgcd(b, a % b, y, x);
    y -= a / b * x;
    return d;
}


int main()
{
    int n;
    cin >> n;

    LL x = 0, m1, a1;
    cin >> m1 >> a1;
    for (int i = 0; i < n - 1; i ++ )
    {
        LL m2, a2;
        cin >> m2 >> a2;
        LL k1, k2;
        LL d = exgcd(m1, m2, k1, k2);
        if ((a2 - a1) % d)
        {
            x = -1;
            break;
        }

        k1 *= (a2 - a1) / d;
        k1 = (k1 % (m2/d) + m2/d) % (m2/d);

        x = k1 * m1 + a1;

        LL m = abs(m1 / d * m2);
        a1 = k1 * m1 + a1;
        m1 = m;
    }

    if (x != -1) x = (a1 % m1 + m1) % m1;

    cout << x << endl;

    return 0;
}

```


</details>



> ç‰›å®¢ç«èµ›ï¼š[Strange Way to Express Integers](https://ac.nowcoder.com/acm/problem/50570)

```c++
#include <iostream>
using namespace std;
typedef long long LL;
LL exgcd(LL a, LL b, LL& x, LL& y) {
  if (b == 0) {
    x = 1, y = 0;
    return a;
  }
  LL d = exgcd(b, a % b, y, x);
  y -= a / b * x;
  return d;
}
int main() {
  int n;
  while (scanf("%d", &n) != EOF) {
    bool flag = true;
    LL a1, b1, a2, b2;
    scanf("%lld %lld", &a1, &b1);
    for (int i = 1; i <= n - 1; i++) {
      scanf("%lld %lld", &a2, &b2);
      LL k1, k2;
      LL d = exgcd(a1, a2, k1, k2);
      if ((b2 - b1) % d) {
        flag = false;
        // ç»§ç»­è¯»å®Œ
        for (int j = i + 1; j < n; j++) scanf("%lld %lld", &a2, &b2);
        break;
      }
      //    s = k1 * (b2 - b1) / d;
      k1 *= (b2 - b1) / d;
      LL t = a2 / d;
      k1 = (k1 % t + t) % t;
      b1 = a1 * k1 + b1;
      a1 = a1 * a2 / d;  // LCM(a1, a2)
    }
    if (flag) {
      printf("%lld\n", (b1 % a1 + a1) % a1);
    } else {
      printf("-1\n");
    }
  }

  return 0;
}
```





> æ´›è°·ï¼šhttps://www.luogu.com.cn/problem/P4777
>
> æœ‰ä¸ªæµ‹è¯•ç‚¹ä¼šå¡`long long`æº¢å‡ºï¼Œéœ€è¦ç”¨åˆ°`__int128`

```c++
#include <iostream>
using namespace std;
typedef long long LL;
LL exgcd(LL a, LL b, LL& x, LL& y) {
  if (b == 0) {
    x = 1, y = 0;
    return a;
  }
  LL d = exgcd(b, a % b, y, x);
  y -= a / b * x;
  return d;
}
int main() {
  int n;
  scanf("%d", &n);
  bool flag = true;
  LL a1, b1, a2, b2;
  scanf("%lld %lld", &a1, &b1);
  for (int i = 1; i <= n - 1; i++) {
    scanf("%lld %lld", &a2, &b2);
    LL k1, k2;
    LL d = exgcd(a1, a2, k1, k2);
    if ((b2 - b1) % d) { flag = false; }
    __int128 s = (__int128)k1 * (b2 - b1) / d;
    // k1 *= (b2 - b1) / d;
    LL t = a2 / d;
    s = (s % t + t) % t;
    b1 = (__int128)a1 * s + b1;
    a1 = (__int128)a1 * a2 / d;  // LCM(a1, a2)
  }
  if (flag) {
    printf("%lld\n", (b1 % a1 + a1) % a1);
  } else {
    printf("-1\n");
  }

  return 0;
}
```



### ğŸ“œ 6.2 ä¸­å›½å‰©ä½™å®šç†ï¼ˆçº¯æ¨¡æ¿ï¼‰

ç‰›å®¢ç«èµ›ï¼š[æ›¹å†²å…»çŒª](https://ac.nowcoder.com/acm/problem/50569)

æ´›è°·ï¼šhttps://www.luogu.com.cn/problem/P1495

ä»£ç å®ç°ï¼š

```c++
#include <iostream>
using namespace std;
const int N = 14;
int a[N], b[N];
typedef long long LL;
// (a * b) % mod
LL mul_mod(LL a, LL b, LL k) {
  LL result = 0;
  a %= k;
  while (b) {
    if (b & 1) { result = (result + a) % k; }
    b >>= 1;
    a = 2 * a % k;
  }
  return result;
}
LL exgcd(LL a, LL b, LL& x, LL& y) {
  if (b == 0) {
    x = 1, y = 0;
    return a;
  }
  LL d = exgcd(b, a % b, y, x);
  y -= a / b * x;
  return d;
}
// æ±‚æ¨¡é€†å…ƒï¼Œå³æ±‚xä½¿å¾— a * x â‰¡ 1 mod m
LL mod_inverse(LL a, LL m) {
  LL x, y;
  LL d = exgcd(a, m, x, y);
  if (d != 1) { return -1; }
  return (x % m + m) % m;
}
int main() {
  int n;
  scanf("%d", &n);
  LL M = 1;
  for (int i = 0; i < n; i++) {
    scanf("%d %d", a + i, b + i);
    M *= a[i];
  }
  LL result = 0;
  for (int i = 0; i < n; i++) {
    LL Mi = M / a[i];
    LL yi = mod_inverse(Mi, a[i]);
    result = (result + mul_mod(mul_mod(b[i], Mi, M), yi, M)) % M;
  }
  result = (result % M + M) % M;
  printf("%lld", result);
  return 0;
}
```





---

## ğŸŒ€ 7. é«˜æ–¯æ¶ˆå…ƒ (*)

> **æ ¸å¿ƒæ€æƒ³**ï¼šé«˜æ–¯æ¶ˆå…ƒæ³•æ˜¯æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„çš„ç»å…¸ç®—æ³•ã€‚å…¶åŸºæœ¬æ­¥éª¤æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„åˆç­‰è¡Œå˜æ¢ï¼ˆäº¤æ¢ä¸¤è¡Œã€æŸè¡Œä¹˜ä»¥éé›¶æ•°ã€æŸè¡ŒåŠ ä¸Šå¦ä¸€è¡Œçš„å€æ•°ï¼‰å°†å¢å¹¿çŸ©é˜µåŒ–ä¸º**è¡Œé˜¶æ¢¯å½¢çŸ©é˜µ**ï¼Œç„¶åé€šè¿‡**å›ä»£**æ±‚å‡ºæ–¹ç¨‹ç»„çš„è§£ã€‚
>
> **è¿‡ç¨‹**ï¼š
>
> 1.  **æ¶ˆå…ƒ (Elimination)**ï¼šä»ç¬¬ä¸€åˆ—å¼€å§‹ï¼Œé€‰å–ä¸»å…ƒï¼ˆé€šå¸¸æ˜¯å½“å‰åˆ—ç»å¯¹å€¼æœ€å¤§çš„å…ƒç´ æ‰€åœ¨è¡Œï¼‰ï¼Œå°†å…¶äº¤æ¢åˆ°å½“å‰è¡Œã€‚ç„¶åç”¨è¿™ä¸€è¡Œå°†ä¸‹é¢æ‰€æœ‰è¡Œçš„å½“å‰åˆ—å…ƒç´ æ¶ˆä¸º 0ã€‚
> 2.  **å›ä»£ (Back Substitution)**ï¼šä»æœ€åä¸€è¡Œå¼€å§‹ï¼Œé€æ­¥å‘ä¸Šè§£å‡ºæ¯ä¸ªå˜é‡çš„å€¼ã€‚


### ğŸ“œ 7.0 æ´›è°· & ç‰›å®¢é¢˜å•

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| ç‰›å®¢ | [é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/02b6ff112b9b4eb2ad4403e30e0f076a) | **é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„**                   |
| æ´›è°· | https://www.luogu.com.cn/problem/P3389                       | P3389 ã€æ¨¡æ¿ã€‘é«˜æ–¯æ¶ˆå…ƒæ³•                       |
| æ´›è°· | https://www.luogu.com.cn/problem/P2455                       | P2455 [SDOI2006] çº¿æ€§æ–¹ç¨‹ç»„                    |
| æ´›è°· | https://www.luogu.com.cn/training/600407                     | **é«˜æ–¯æ¶ˆå…ƒï¼ˆé¢˜å•ï¼‰**                           |
| æ´›è°· | https://www.luogu.com.cn/training/4919                       | **ã€æ—¥æŠ¥é…å¥—é¢˜å•ã€‘é«˜æ–¯æ¶ˆå…ƒï¼Œçº¿æ€§ä»£æ•°ï¼ˆé¢˜å•ï¼‰** |
|      |                                                              |                                                |


### ğŸ”¢ 7.1 é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| ç‰›å®¢ | [é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/02b6ff112b9b4eb2ad4403e30e0f076a) | **é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„** |
| æ´›è°· | https://www.luogu.com.cn/problem/P3389                       | P3389 ã€æ¨¡æ¿ã€‘é«˜æ–¯æ¶ˆå…ƒæ³•     |
| æ´›è°· | https://www.luogu.com.cn/problem/P2455                       | P2455 [SDOI2006] çº¿æ€§æ–¹ç¨‹ç»„  |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240220165811740](assets/image-20240220165811740.png)

> **AcWing é¢˜è§£**
```cpp
#include <iostream>
#include <cstring>
#include <algorithm>
#include <cmath>

using namespace std;

const int N = 110;
const double eps = 1e-8;

int n;
double a[N][N];

int gauss()  // é«˜æ–¯æ¶ˆå…ƒï¼Œç­”æ¡ˆå­˜äºa[i][n]ä¸­ï¼Œ0 <= i < n
{
    int c, r;
    for (c = 0, r = 0; c < n; c ++ )
    {
        int t = r;
        for (int i = r; i < n; i ++ )  // æ‰¾ç»å¯¹å€¼æœ€å¤§çš„è¡Œ
            if (fabs(a[i][c]) > fabs(a[t][c]))
                t = i;

        if (fabs(a[t][c]) < eps) continue;

        for (int i = c; i <= n; i ++ ) swap(a[t][i], a[r][i]);  // å°†ç»å¯¹å€¼æœ€å¤§çš„è¡Œæ¢åˆ°æœ€é¡¶ç«¯
        for (int i = n; i >= c; i -- ) a[r][i] /= a[r][c];  // å°†å½“å‰è¡Œçš„é¦–ä½å˜æˆ1
        for (int i = r + 1; i < n; i ++ )  // ç”¨å½“å‰è¡Œå°†ä¸‹é¢æ‰€æœ‰çš„åˆ—æ¶ˆæˆ0
            if (fabs(a[i][c]) > eps)
                for (int j = n; j >= c; j -- )
                    a[i][j] -= a[r][j] * a[i][c];

        r ++ ;
    }

    if (r < n)
    {
        for (int i = r; i < n; i ++ )
            if (fabs(a[i][n]) > eps)
                return 2; // æ— è§£
        return 1; // æœ‰æ— ç©·å¤šç»„è§£
    }

    for (int i = n - 1; i >= 0; i -- )
        for (int j = i + 1; j < n; j ++ )
            a[i][n] -= a[i][j] * a[j][n];

    return 0; // æœ‰å”¯ä¸€è§£
}


int main()
{
    scanf("%d", &n);
    for (int i = 0; i < n; i ++ )
        for (int j = 0; j < n + 1; j ++ )
            scanf("%lf", &a[i][j]);

    int t = gauss();
    if (t == 2) puts("No solution");
    else if (t == 1) puts("Infinite group solutions");
    else
    {
        for (int i = 0; i < n; i ++ )
            printf("%.2lf\n", a[i][n]);
    }

    return 0;
}

```
</details>





### ğŸ’¡ 7.2 é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„



![image-20240220170138830](assets/image-20240220170138830.png)

```c++
#include <iostream>
#include <algorithm>

using namespace std;

const int N = 110;


int n;
int a[N][N];


int gauss()
{
    int c, r;
    for (c = 0, r = 0; c < n; c ++ )
    {
        int t = r;
        for (int i = r; i < n; i ++ )
            if (a[i][c])
                t = i;

        if (!a[t][c]) continue;

        for (int i = c; i <= n; i ++ ) swap(a[r][i], a[t][i]);
        for (int i = r + 1; i < n; i ++ )
            if (a[i][c])
                for (int j = n; j >= c; j -- )
                    a[i][j] ^= a[r][j];

        r ++ ;
    }

    if (r < n)
    {
        for (int i = r; i < n; i ++ )
            if (a[i][n])
                return 2;
        return 1;
    }

    for (int i = n - 1; i >= 0; i -- )
        for (int j = i + 1; j < n; j ++ )
            a[i][n] ^= a[i][j] * a[j][n];

    return 0;
}


int main()
{
    cin >> n;

    for (int i = 0; i < n; i ++ )
        for (int j = 0; j < n + 1; j ++ )
            cin >> a[i][j];

    int t = gauss();

    if (t == 0)
    {
        for (int i = 0; i < n; i ++ ) cout << a[i][n] << endl;
    }
    else if (t == 1) puts("Multiple sets of solutions");
    else puts("No solution");

    return 0;
}

```



---

## ğŸ² 8. æ±‚ç»„åˆæ•°

> **æ ¸å¿ƒæ€æƒ³**ï¼šç»„åˆæ•° $C_a^b$ï¼ˆæˆ– $\binom{a}{b}$ï¼‰è¡¨ç¤ºä» $a$ ä¸ªä¸åŒå…ƒç´ ä¸­å–å‡º $b$ ä¸ªå…ƒç´ çš„æ–¹æ¡ˆæ•°ã€‚æ ¹æ®æ•°æ®èŒƒå›´å’Œæ˜¯å¦éœ€è¦å–æ¨¡ï¼Œæœ‰å¤šç§è®¡ç®—æ–¹æ³•ã€‚

### ğŸ“œ 8.0 æ´›è°· & ç‰›å®¢é¢˜å•



### ğŸªœ 8.1 æ–¹æ³•ä¸€ï¼šé€’æ¨æ³•

> **è§£æ³•æ€è·¯**ï¼š
>
> åˆ©ç”¨ç»„åˆæ•°çš„é€’æ¨å…¬å¼ï¼ˆæ¨è¾‰ä¸‰è§’æ€§è´¨ï¼‰ï¼š
> $$
> C_a^b = C_{a-1}^{b-1} + C_{a-1}^b
> $$
>
> -   **é€‚ç”¨åœºæ™¯**ï¼šå½“ `a` å’Œ `b` çš„èŒƒå›´ä¸å¤§ï¼ˆå¦‚ 2000 ä»¥å†…ï¼‰ï¼Œä¸”éœ€è¦å¤šæ¬¡æŸ¥è¯¢æ—¶ã€‚
> -   **æ–¹æ³•**ï¼šé€šè¿‡åŠ¨æ€è§„åˆ’ï¼Œé¢„å¤„ç†å‡ºä¸€ä¸ªäºŒç»´æ•°ç»„ `c[a][b]` å­˜å‚¨æ‰€æœ‰ç»„åˆæ•°çš„å€¼ã€‚
> -   **æ—¶é—´å¤æ‚åº¦**ï¼šé¢„å¤„ç† O(nÂ²)ï¼ŒæŸ¥è¯¢ O(1)ã€‚

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å•                                | è¯´æ˜                                        |
| :--- | :--------------------------------------- | :------------------------------------------ |
| æ´›è°· | https://www.luogu.com.cn/problem/T334372 | T334372 ç»„åˆæ•°ï¼ˆé€’å½’ï¼‰                      |
| æ´›è°· | https://www.luogu.com.cn/problem/T181707 | T181707 è®¡ç®—ç»„åˆæ•° ($n<=20$)                |
| æ´›è°· | https://www.luogu.com.cn/problem/T474685 | T474685 æ±‚ç»„åˆæ•° I<br />($n<= 2000$)        |
| æ´›è°· | https://www.luogu.com.cn/problem/U526513 | U526513 æ±‚ç»„åˆæ•°2ï¼ˆåµŒå¥—ç»„åˆæ•°ï¼‰             |
| æ´›è°· | https://www.luogu.com.cn/problem/U300348 | U300348 ç»„åˆæ•° ($n \le 20$)                 |
| æ´›è°· | https://www.luogu.com.cn/problem/U159710 | U159710 ç»„åˆæ•° ($n \le 1000$, å¤šç»„æŸ¥è¯¢)     |
| æ´›è°· | https://www.luogu.com.cn/problem/U450830 | U450830 ç»„åˆæ•° ($n \le 5000$, å¤šç»„æŸ¥è¯¢)     |
| æ´›è°· | https://www.luogu.com.cn/problem/U569470 | U569470 è®¡ç®—ç»„åˆæ•° ($n \le 2000$, ç»“æœå–æ¨¡) |
| æ´›è°· | https://www.luogu.com.cn/problem/P2822   | P2822 [NOIP 2016 æé«˜ç»„] ç»„åˆæ•°é—®é¢˜         |




<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240221092834023](assets/image-20240221092834023.png)



> **AcWing é¢˜è§£**
```cpp
#include <iostream>
using namespace std;

const int N = 2010, mod = 1e9 + 7;
int c[N][N];

void init()
{
    // c[i] = 1, c[i][i] = 1
    for (int i = 0; i < N; i ++ )
        for (int j = 0; j <= i; j ++ )
            if (!j) c[i][j] = 1;
            else c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod;
}

int main()
{
    init(); // é¢„å¤„ç†

    int n;
    scanf("%d", &n);
    while (n -- )
    {
        int a, b;
        scanf("%d%d", &a, &b);
        printf("%d\n", c[a][b]);
    }

    return 0;
}
```
</details>

### ğŸ­ 8.2 æ–¹æ³•äºŒï¼šé¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒ

> **è§£æ³•æ€è·¯**ï¼š
>
> åˆ©ç”¨å…¬å¼ $C_a^b = \frac{a!}{b!(a-b)!}$ã€‚åœ¨æ¨¡è¿ç®—ä¸‹ï¼Œé™¤æ³•å˜ä¸ºä¹˜ä»¥**æ¨¡é€†å…ƒ**ã€‚
> $$
> C_a^b \equiv a! \cdot (b!)^{-1} \cdot ((a-b)!)^{-1} \pmod p
> $$
> -   **é€‚ç”¨åœºæ™¯**ï¼šæ¨¡æ•° `p` æ˜¯è´¨æ•°ï¼Œ`a` è¾ƒå¤§ï¼ˆå¦‚ 10âµï¼‰ï¼ŒæŸ¥è¯¢æ¬¡æ•°å¤šã€‚
> -   **æ–¹æ³•**ï¼š
>     1.  é¢„å¤„ç† $1!$ åˆ° $N!$ çš„é˜¶ä¹˜å€¼ `fact[]`ã€‚
>     2.  é¢„å¤„ç† $1!$ åˆ° $N!$ çš„é˜¶ä¹˜çš„é€†å…ƒ `infact[]`ã€‚å¯ä»¥å…ˆç”¨å¿«é€Ÿå¹‚æ±‚å‡º `N!` çš„é€†å…ƒï¼Œç„¶ååˆ©ç”¨ $(i!)^{-1} = ((i+1)!)^{-1} \cdot (i+1)$ å€’åºé€’æ¨ã€‚
> -   **æ—¶é—´å¤æ‚åº¦**ï¼šé¢„å¤„ç† O(n log p) æˆ– O(n)ï¼ŒæŸ¥è¯¢ O(1)ã€‚


<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å•                                                    | è¯´æ˜                                       |
| :--- | :--- | :--- |
| ç‰›å®¢ | [ã€æ¨¡æ¿ã€‘ç»„åˆæ•°_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/53f82db091b2452bae5fef4437ffd0bb) | **ã€æ¨¡æ¿ã€‘ç»„åˆæ•°**                         |
| æ´›è°· | https://www.luogu.com.cn/problem/U583220                     | U583220 æ±‚ç»„åˆæ•°II (é˜¶ä¹˜+ æ¨¡æ‹Ÿå…ƒæ±‚è§£)      |
| æ´›è°· | https://www.luogu.com.cn/problem/T474686                     | T474686 æ±‚ç»„åˆæ•°II (é˜¶ä¹˜+ æ¨¡æ‹Ÿå…ƒæ±‚è§£)      |
| æ´›è°· | https://www.luogu.com.cn/problem/U51417                      | U51417 ã€æ¨¡æ¿ã€‘æ±‚ç»„åˆæ•° (é˜¶ä¹˜+ æ¨¡æ‹Ÿå…ƒæ±‚è§£) |
| æ´›è°· | https://www.luogu.com.cn/problem/B3717                       | B3717 ç»„åˆæ•°é—®é¢˜ (é˜¶ä¹˜+ æ¨¡æ‹Ÿå…ƒæ±‚è§£)        |
|      |                                                              |                                            |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240221095734729](assets/image-20240221095734729.png)



> **æ ¸å¿ƒä»£ç å‡½æ•°**

```c++
int qmi(int a, int k, int p)    // å¿«é€Ÿå¹‚æ¨¡æ¿
{
    int res = 1;
    while (k)
    {
        if (k & 1) res = (LL)res * a % p;
        a = (LL)a * a % p;
        k >>= 1;
    }
    return res;
}

// é¢„å¤„ç†é˜¶ä¹˜çš„ä½™æ•°å’Œé˜¶ä¹˜é€†å…ƒçš„ä½™æ•°
fact[0] = infact[0] = 1;
for (int i = 1; i < N; i ++ )
{
    fact[i] = (LL)fact[i - 1] * i % mod;
    infact[i] = (LL)infact[i - 1] * qmi(i, mod - 2, mod) % mod;
}

```




> **AcWing é¢˜è§£**

```cpp
#include <iostream>
using namespace std;

typedef long long LL;
const int N = 100010, mod = 1e9 + 7;

int fact[N], infact[N];

int qmi(int a, int k, int p)
{
    int res = 1;
    while (k)
    {
        if (k & 1) res = (LL)res * a % p;
        a = (LL)a * a % p;
        k >>= 1;
    }
    return res;
}

int main()
{
    fact[0] = infact[0] = 1;
    for (int i = 1; i < N; i++)
    {
        fact[i] = (LL)fact[i - 1] * i % mod;
        infact[i] = (LL)infact[i - 1] * qmi(i, mod - 2, mod) % mod;
    }

    int n;
    scanf("%d", &n);
    while (n -- )
    {
        int a, b;
        scanf("%d%d", &a, &b);
        printf("%d\n", (LL)fact[a] * infact[b] % mod * infact[a - b] % mod);
    }

    return 0;
}
```

</details>



> æ±‚é€†å…ƒçš„ä¼˜åŒ–ç‰ˆæœ¬
>
> é¢˜ç›®ï¼šhttps://www.luogu.com.cn/problem/U51417



> [!important]
>
> å‰ææ¡ä»¶ï¼š
>
> æ‰€æœ‰æ¶‰åŠçš„é€†å…ƒå¿…é¡»å­˜åœ¨ï¼Œå³ $\gcd(n!, M) = 1$ ä¸” $\gcd((n+1)!, M) = 1$ï¼›ç­‰ä»·äºï¼š$\gcd((n+1)!, M) = 1$ï¼ˆå› ä¸º $n! \mid (n+1)!$ï¼‰ï¼›ç‰¹åˆ«åœ°ï¼Œå½“ $M$ æ˜¯è´¨æ•°ä¸” $n+1 < M$ æ—¶ï¼Œæ¡ä»¶è‡ªç„¶æ»¡è¶³ã€‚
>
>
> ä»¥ä¸‹å…¬å¼æˆç«‹ï¼š
>
> $$
> (n!)^{-1} \equiv ((n+1)!)^{-1} \cdot (n+1) \pmod{M}
> $$
>
>
> è¯æ˜è¿‡ç¨‹ï¼š
>
> æˆ‘ä»¬çŸ¥é“é˜¶ä¹˜çš„é€’æ¨å…³ç³»ï¼š
>
> $$
> (n+1)! = (n+1) \cdot n!
> $$
>
> å¯¹ä¸¤è¾¹åœ¨æ¨¡ $M$ ä¸‹å–ä¹˜æ³•é€†å…ƒï¼ˆå‡è®¾é€†å…ƒå­˜åœ¨ï¼‰ï¼š
>
> $$
> ((n+1)!)^{-1} \equiv \big((n+1) \cdot n!\big)^{-1} \pmod{M}
> $$
>
> åˆ©ç”¨æ¨¡é€†å…ƒçš„æ€§è´¨ $(ab)^{-1} \equiv a^{-1} b^{-1} \pmod{M}$ï¼ˆå½“ $a,b$ ä¸ $M$ äº’è´¨æ—¶ï¼‰ï¼š
>
> $$
> ((n+1)!)^{-1} \equiv (n+1)^{-1} \cdot (n!)^{-1} \pmod{M}
> $$
>
> ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥ $(n+1)$ï¼ˆæ³¨æ„ï¼šè¿™é‡Œæ˜¯åŸæ•°ï¼Œä¸æ˜¯é€†å…ƒï¼‰ï¼š
>
> $$
> ((n+1)!)^{-1} \cdot (n+1) \equiv (n+1)^{-1} \cdot (n!)^{-1} \cdot (n+1) \pmod{M}
> $$
>
> ç”±äº $(n+1)^{-1} \cdot (n+1) \equiv 1 \pmod{M}$ï¼Œå³è¾¹åŒ–ç®€ä¸ºï¼š
>
> $$
> ((n+1)!)^{-1} \cdot (n+1) \equiv (n!)^{-1} \pmod{M}
> $$
>
> å³ï¼š
>
> $$
> (n!)^{-1} \equiv ((n+1)!)^{-1} \cdot (n+1) \pmod{M}
> $$
>
> 



> ä»£ç å®ç°é€»è¾‘ï¼š

```c++
// æ­¥éª¤1ï¼šè®¡ç®—æœ€å¤§å€¼çš„é˜¶ä¹˜é€†å…ƒ
infact[N-1] = quickPow(fact[N-1], M-2, M);
// è¿™é‡Œä½¿ç”¨è´¹é©¬å°å®šç†ï¼ša^(M-2) â‰¡ a^(-1) mod M
// è®¡ç®—ï¼š((N-1)!)^(-1) mod M

// æ­¥éª¤2ï¼šåå‘é€’æ¨
for (int i = N-2; i >= 0; i--) {
    infact[i] = (LL)infact[i+1] * (i+1) % M;
    // åº”ç”¨å…¬å¼ï¼š(i!)^(-1) = ((i+1)!)^(-1) Ã— (i+1) mod M
}
```

> å®Œæ•´ä»£ç å®ç°ï¼š



```c++
#include<iostream>
using namespace std;
typedef long long LL;

const int N = 3e7 + 5;  // æœ€å¤§å¯èƒ½çš„å€¼+5ï¼Œç”¨äºæ•°ç»„å¤§å°
const int M = 1e9 + 7;  // æ¨¡æ•°ï¼Œ10^9+7æ˜¯ä¸€ä¸ªè´¨æ•°

int fact[N];    // å­˜å‚¨é˜¶ä¹˜æ•°ç»„ï¼šfact[i] = i! mod M
int infact[N];  // å­˜å‚¨é˜¶ä¹˜çš„é€†å…ƒæ•°ç»„ï¼šinfact[i] = (i!)^(-1) mod M

// å¿«é€Ÿå¹‚å‡½æ•°ï¼šè®¡ç®— a^k mod p
int quickPow(int a, int k, int p){
    int result = 1;
    while(k){
        if(k & 1){  // å¦‚æœkçš„äºŒè¿›åˆ¶æœ€ä½ä½ä¸º1
            result = (LL)result * a % p;
        }
        a = (LL)a * a % p;  // aå¹³æ–¹
        k >>= 1;  // kå³ç§»ä¸€ä½
    }
    return result;
}

// åˆå§‹åŒ–å‡½æ•°ï¼šé¢„å¤„ç†é˜¶ä¹˜å’Œé˜¶ä¹˜é€†å…ƒ
void init(){
    // åˆå§‹åŒ–0çš„é˜¶ä¹˜å’Œé˜¶ä¹˜é€†å…ƒä¸º1
    fact[0] = infact[0] = 1;
    
    // æ­£å‘è®¡ç®—é˜¶ä¹˜æ•°ç»„ï¼šfact[i] = i! mod M
    for(int i = 1; i < N; i++){
        fact[i] = (LL)fact[i - 1] * i % M;
    }

    // --- å…³é”®éƒ¨åˆ†ï¼šé€†å…ƒçš„é«˜æ•ˆæ±‚è§£ ---
    // 1. å…ˆè®¡ç®—æœ€å¤§é˜¶ä¹˜çš„é€†å…ƒï¼š((N-1)!)^(-1) mod M
    //    ä½¿ç”¨è´¹é©¬å°å®šç†ï¼ša^(M-2) â‰¡ a^(-1) mod M
    infact[N - 1] = quickPow(fact[N - 1], M - 2, M);
    
    // 2. åå‘é€’æ¨è®¡ç®—æ‰€æœ‰é˜¶ä¹˜çš„é€†å…ƒ
    //    åˆ©ç”¨å…¬å¼ï¼š(n!)^(-1) â‰¡ ((n+1)!)^(-1) Ã— (n+1) mod M
    for (int i = N - 2; i >= 0; i--) {
        infact[i] = (LL)infact[i + 1] * (i + 1) % M;
    }
}

int main(){
    init();  // é¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒ
    
    int t, n, m, result;
    scanf("%d", &t);
    while(t--){
        scanf("%d%d", &m, &n);
        // è®¡ç®—ç»„åˆæ•°ï¼šC(m,n) = m! / (n! Ã— (m-n)!) mod M
        result = (LL)fact[m] * infact[n] % M * infact[m - n] % M;
        printf("%d\n", result);
    }
    return 0;
}
```



### ğŸŒŸ 8.3 æ–¹æ³•ä¸‰ï¼šå¢å¡æ–¯å®šç† (Lucas Theorem)

> **è§£æ³•æ€è·¯**ï¼š
>
> å¢å¡æ–¯å®šç†ç”¨äºå¤„ç† $a, b$ å¾ˆå¤§ï¼Œä½†æ¨¡æ•° $p$ è¾ƒå°ä¸”ä¸ºè´¨æ•°çš„æƒ…å†µã€‚
>
> **å®šç†**ï¼š
> 
> $$
> C_a^b \equiv C_{\lfloor a/p \rfloor}^{\lfloor b/p \rfloor}  \cdot (lucas)C_{a \pmod p}^{b \pmod p}  \pmod p
> $$
> 
> -   **æ–¹æ³•**ï¼šè¿™æ˜¯ä¸€ä¸ªé€’å½’è¿‡ç¨‹ã€‚å°†æ±‚ $C_a^b$ çš„é—®é¢˜åˆ†è§£ä¸ºæ±‚ $C_{a \pmod p}^{b \pmod p}$ï¼ˆ`p` è¾ƒå°ï¼Œå¯ç›´æ¥ç”¨å®šä¹‰æ³•+é€†å…ƒæ±‚ï¼‰å’Œ $C_{a/p}^{b/p}$ï¼ˆé€’å½’æ±‚è§£ï¼‰ã€‚
> -   **æ—¶é—´å¤æ‚åº¦**ï¼š$O(p \log_p a \cdot \log p)$ï¼Œå…¶ä¸­ $O(p)$ æ˜¯é¢„å¤„ç†é˜¶ä¹˜é€†å…ƒçš„æ—¶é—´ï¼Œ$\log_p a$ æ˜¯é€’å½’æ·±åº¦ã€‚


<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>


| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U583140 | U583140 æ±‚ç»„åˆæ•°III (Lucaså®šç†)  |
| æ´›è°· | https://www.luogu.com.cn/problem/T474691 | T474691 æ±‚ç»„åˆæ•° III (Lucaså®šç†) |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240221104052669](assets/image-20240221104052669.png)



> **æ ¸å¿ƒå‡½æ•°ä»£ç **

```c++

//è‹¥ p æ˜¯è´¨æ•°ï¼ŒC(n, m) = C(n / p, m / p) * C(n % p, m % p) (mod p)


int qmi(int a, int k, int p)
{
    int res = 1;
    while (k)
    {
        if (k & 1) res = (LL)res * a % p;
        a = (LL)a * a % p;
        k >>= 1;
    }
    return res;
}


int C(int a, int b, int p)
{
    if (b > a) return 0;
    int res = 1;
    for (int i = 1, j = a; i <= b; i ++, j -- )
    {   	
        res = (LL)res * j % p;
        res = (LL)res * qmi(i, p - 2, p) % p;
    }
    return res;
}


int lucas(LL a, LL b, int p)
{
	
    if (a < p && b < p) return C(a, b, p);
    return (LL)lucas(a / p, b / p, p) * C(a % p, b % p, p) % p;
}
```



> **AcWing é¢˜è§£**

```cpp
#include <iostream>
#include <algorithm>

using namespace std;

typedef long long LL;


int qmi(int a, int k, int p)
{
    int res = 1;
    while (k)
    {
        if (k & 1) res = (LL)res * a % p;
        a = (LL)a * a % p;
        k >>= 1;
    }
    return res;
}


int C(int a, int b, int p)
{
    if (b > a) return 0;//æ³¨æ„ b > a çš„æƒ…å†µ

    int res = 1;
    for (int i = 1, j = a; i <= b; i ++, j -- )
    {
    	// a åˆ° a - b + 1 æ€»å…± a - b ä¸ªæ•° 
        res = (LL)res * j % p;
        //å†ä¹˜ 1 åˆ° b çš„é€†å…ƒä¹Ÿå°±æ˜¯ b çš„é˜¶ä¹˜çš„é€†å…ƒ 
        res = (LL)res * qmi(i, p - 2, p) % p;
    }
    return res;
}


int lucas(LL a, LL b, int p)
{
	//é€’å½’ç»ˆç‚¹ a < p && b < p
    if (a < p && b < p) return C(a, b, p);
    
    return (LL)lucas(a / p, b / p, p) * C(a % p, b % p, p) % p;
}


int main()
{
    int n;
    cin >> n;

    while (n -- )
    {
        LL a, b;//æ³¨æ„ a å’Œ b çš„ç±»å‹
        int p;
        cin >> a >> b >> p;
        cout << lucas(a, b, p) << endl;
    }

    return 0;
}

```
</details>

### ğŸ”¬ 8.4 æ–¹æ³•å››ï¼šé«˜ç²¾åº¦è®¡ç®—

> **è§£æ³•æ€è·¯**ï¼š
>
> å½“éœ€è¦è®¡ç®—ç»„åˆæ•°çš„ç²¾ç¡®å€¼ï¼Œä¸”ç»“æœå¯èƒ½è¶…å‡º `long long` èŒƒå›´æ—¶ï¼Œéœ€è¦ä½¿ç”¨é«˜ç²¾åº¦ç®—æ³•ã€‚
>
> -   **æ–¹æ³•**ï¼šä¸ºé¿å…ç›´æ¥è®¡ç®—é˜¶ä¹˜å¯¼è‡´ä¸­é—´ç»“æœæº¢å‡ºï¼Œæˆ‘ä»¬å°†ç»„åˆæ•°å…¬å¼ $C_a^b = \frac{a!}{b!(a-b)!}$ è½¬åŒ–ä¸ºè´¨å› æ•°åˆ†è§£çš„å½¢å¼ã€‚
>     1.  **ç­›è´¨æ•°**ï¼šå…ˆç”¨çº¿æ€§ç­›æ‰¾å‡º $1$ åˆ° $a$ ä¹‹é—´çš„æ‰€æœ‰è´¨æ•°ã€‚
>     2.  **è®¡ç®—æŒ‡æ•°**ï¼šå¯¹äºæ¯ä¸ªè´¨æ•° $p$ï¼Œè®¡ç®—å®ƒåœ¨ $a!, b!, (a-b)!$ ä¸­çš„æŒ‡æ•°ã€‚ä¸€ä¸ªæ•° $n!$ ä¸­è´¨å› å­ $p$ çš„æŒ‡æ•°ç­‰äº $\sum_{i=1}^{\infty} \lfloor \frac{n}{p^i} \rfloor$ã€‚
>     3.  $p$ åœ¨ $C_a^b$ ä¸­çš„æŒ‡æ•°å°±æ˜¯ $p$ åœ¨ $a!$ ä¸­çš„æŒ‡æ•°å‡å»å®ƒåœ¨ $b!$ å’Œ $(a-b)!$ ä¸­çš„æŒ‡æ•°ã€‚
>     4.  **é«˜ç²¾åº¦ä¹˜æ³•**ï¼šæœ€åï¼Œå°†æ‰€æœ‰è´¨å› å­åŠå…¶å¯¹åº”çš„æŒ‡æ•°ç”¨é«˜ç²¾åº¦ä¹˜æ³•ç´¯ä¹˜èµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœã€‚


<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>


| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U453736 | U453736 è®¡ç®—ç»„åˆæ•° ($n \le 10^5$, ğŸ’é«˜ç²¾åº¦) |
| æ´›è°· | https://www.luogu.com.cn/problem/U380451 | U380451 æ±‚ç»„åˆæ•°2 ($n\le10^4$, ğŸ’é«˜ç²¾åº¦)    |
| æ´›è°· | https://www.luogu.com.cn/problem/U583210 | U583210 æ±‚ç»„åˆæ•°â…£ ($n\le5000$, ğŸ’é«˜ç²¾åº¦)    |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240221170231204](assets/image-20240221170231204.png)



> **AcWing é¢˜è§£**
```cpp
#include <iostream>
#include <algorithm>
#include <vector>

using namespace std;


const int N = 5010;

int primes[N], cnt;
int sum[N];
bool st[N];

//çº¿æ€§ç­›æ³•ç­›è´¨æ•°
void get_primes(int n)
{
    for (int i = 2; i <= n; i ++ )
    {
        if (!st[i]) primes[cnt ++ ] = i;
        for (int j = 0; primes[j] <= n / i; j ++ )
        {
            st[primes[j] * i] = true;
            if (i % primes[j] == 0) break;
        }
    }
}


//è¿”å› n çš„é˜¶ä¹˜ä¸­è´¨å› å­ p çš„æ¬¡æ•° 
int get(int n, int p)
{
    int res = 0;
    while (n)
    {
        res += n / p;
        n /= p;
    }
    return res;
}


vector<int> mul(vector<int> a, int b)
{
    vector<int> c;
    int t = 0;
 
    for (int i = 0; i < a.size(); i ++ )
    {
        t += a[i] * b;
        c.push_back(t % 10);
        t /= 10;
    }
    while (t)
    {
        c.push_back(t % 10);
        t /= 10;
    }
    return c;
}


int main()
{
    int a, b;
    cin >> a >> b;
    
	//ç­›å‡º 1 åˆ° a çš„è´¨æ•°ï¼Œå› ä¸º b å’Œ a - b éƒ½æ¯” a å°ï¼Œæ‰€ä»¥ 1 åˆ° b å’Œ a - bçš„è´¨æ•°åŒ…å«åœ¨ 1 åˆ° a çš„è´¨æ•°ä¸­ 
    get_primes(a);
    
	//æ±‚å‡º1 åˆ° a ï¼Œ1 åˆ° b å’Œ a - bæ¯ä¸ªè´¨æ•°çš„æ€»æ¬¡æ•° 
    for (int i = 0; i < cnt; i ++ )
    {
        int p = primes[i];
        //C(a,b) ä¸­ p çš„æ€»æ¬¡æ•°ç­‰äº a! ä¸­ p çš„æ¬¡æ•°å‡å» a - b! ä¸­ p çš„æ¬¡æ•°å‡å»b! ä¸­ p çš„æ¬¡æ•° 
        sum[i] = get(a, p) - get(a - b, p) - get(b, p);
    }

    vector<int> res;
    res.push_back(1);
    
	//æŠŠæ¯ä¸ªè´¨æ•°ä¹˜èµ·æ¥ï¼Œå³ä¸Šå›¾æœ€åä¸€æ­¥çš„ç»“æœï¼ˆåˆ†è§£è´¨å› æ•°ï¼‰ 
    for (int i = 0; i < cnt; i ++ )
        for (int j = 0; j < sum[i]; j ++ )
            res = mul(res, primes[i]);
	
	//è¾“å‡ºæœ€ç»ˆç»“æœ 
    for (int i = res.size() - 1; i >= 0; i -- ) printf("%d", res[i]);
    puts("");

    return 0;
}

```
</details>

### ğŸŒ³ 8.5 å¡ç‰¹å…°æ•°

> **æ ¸å¿ƒæ€æƒ³**ï¼šå¡ç‰¹å…°æ•°æ˜¯ä¸€ä¸ªåœ¨å„ç§è®¡æ•°é—®é¢˜ä¸­å‡ºç°çš„æ•°åˆ—ã€‚å®ƒæ»¡è¶³é€’æ¨å…³ç³»ï¼Œå¹¶æœ‰å¤šç§ç»„åˆæ•°è¡¨ç¤ºå½¢å¼ã€‚
>
> **é€šé¡¹å…¬å¼**ï¼š
> $$
> Cat_n = \frac{C_{2n}^n}{n+1} = \frac{1}{n+1}\binom{2n}{n}
> $$
>
> **åº”ç”¨**ï¼šnä¸ªèŠ‚ç‚¹çš„äºŒå‰æ ‘å½¢æ€æ•°ã€nå¯¹æ‹¬å·çš„åˆæ³•åŒ¹é…æ•°ã€å‡¸n+2è¾¹å½¢çš„ä¸‰è§’å‰–åˆ†æ•°ã€å‡ºæ ˆåºåˆ—æ•°ç­‰ã€‚

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U215548 | U215548 å¡ç‰¹å…°æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/U140713 | U140713 å¡ç‰¹å…°æ•° |
| æ´›è°· | https://www.luogu.com.cn/training/507379 | å¡ç‰¹å…°æ•°ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/327894 | ã€æ•°å­¦ã€‘å¡ç‰¹å…°æ•°ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/504110 | Sâ‘¢æ•°å­¦4-7    å¡ç‰¹å…°æ•°7æ˜Ÿï¼ˆé¢˜å•ï¼‰ |

<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240222100819729](assets/image-20240222100819729.png)



![image-20240222102207006](assets/image-20240222102207006.png)



> **è§£æ³•æ€è·¯**ï¼š
>
> æœ¬é¢˜æ˜¯å¡ç‰¹å…°æ•°çš„ç›´æ¥åº”ç”¨ã€‚ä¸€ä¸ªç”± `n` ä¸ª 0 å’Œ `n` ä¸ª 1 ç»„æˆçš„åºåˆ—ï¼Œè¦æ±‚ä»»æ„å‰ç¼€ä¸­ 0 çš„ä¸ªæ•°ä¸å°‘äº 1 çš„ä¸ªæ•°ï¼Œå…¶æ–¹æ¡ˆæ•°æ­£å¥½æ˜¯ç¬¬ `n` ä¸ªå¡ç‰¹å…°æ•° $Cat_n$ã€‚
>
> æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é€šé¡¹å…¬å¼ $Cat_n = \frac{C_{2n}^n}{n+1}$ æ¥è®¡ç®—ã€‚
>
> 1.  è®¡ç®— $C_{2n}^n \pmod p$ã€‚
> 2.  è®¡ç®— $n+1$ å…³äºæ¨¡ $p$ çš„é€†å…ƒ $(n+1)^{-1} \pmod p$ã€‚
> 3.  å°†ä¸¤è€…ç›¸ä¹˜å†å–æ¨¡ã€‚
>
> å…¶ä¸­ $C_{2n}^n$ å’Œé€†å…ƒéƒ½å¯ä»¥ç”¨**å¿«é€Ÿå¹‚**å’Œ**é¢„å¤„ç†é˜¶ä¹˜**çš„æ–¹æ³•ï¼ˆæ–¹æ³•äºŒï¼‰æ¥é«˜æ•ˆè®¡ç®—ã€‚

> **AcWing é¢˜è§£**
>
> 
```cpp

/*ç»™å®šnä¸ª0å’Œnä¸ª1ï¼Œå®ƒä»¬æŒ‰ç…§æŸç§é¡ºåºæ’æˆé•¿åº¦ä¸º2nçš„åºåˆ—
æ»¡è¶³ä»»æ„å‰ç¼€ä¸­0çš„ä¸ªæ•°éƒ½ä¸å°‘äº1çš„ä¸ªæ•°çš„åºåˆ—çš„æ•°é‡ä¸ºï¼š Cat(n) = C(2n, n) / (n + 1)*/


#include <iostream>
#include <algorithm>

using namespace std;

typedef long long LL;

const int N = 100010, mod = 1e9 + 7;


int qmi(int a, int b, int p)
{
    int res = 1;
    while (b)
    {
        if (b & 1) res = (LL)res * a % p;
        a = (LL)a * a % p;
        b >>= 1;
    }
    return res;
}
// C(2n, n) = (2n * (2n-1) * ... * (n+1)) / n!
int C(int a,int b, int p){
	if(b > a) return 0;
	int res = 1;
	for(int i = 1, j = a; i <= b; i++,j--){
		res = (LL)res * j % p;
		res = (LL)res * qmi(i, p - 2, p) % p;
	}
	return res;
} 


int main()
{
    int n;
    cin >> n;

    cout<<(LL)C(2 * n, n, mod) * qmi(n + 1, mod - 2, mod) % mod<<endl;

    return 0;
}

```

</details>

---

## âˆªâˆ© 9. å®¹æ–¥åŸç†

> **æ ¸å¿ƒæ€æƒ³**ï¼šå®¹æ–¥åŸç†ï¼ˆInclusion-Exclusion Principleï¼‰ç”¨äºè®¡ç®—å¤šä¸ªé›†åˆå¹¶é›†çš„å¤§å°ã€‚å…¶æ ¸å¿ƒæ˜¯é€šè¿‡äº¤æ›¿åœ°åŠ å‡å„çº§äº¤é›†çš„å¤§å°ï¼Œæ¥ç²¾ç¡®è®¡ç®—æ€»å…ƒç´ æ•°ï¼Œé¿å…é‡å¤è®¡æ•°ã€‚
>
> **å…¬å¼**ï¼ˆä»¥ä¸‰ä¸ªé›†åˆä¸ºä¾‹ï¼‰ï¼š
> $$
> |A \cup B \cup C| = (|A| + |B| + |C|) - (|A \cap B| + |A \cap C| + |B \cap C|) + |A \cap B \cap C|
> $$
>
> **nä¸ªé›†åˆçš„ä¸€èˆ¬å½¢å¼**:
> $$
> \left| \bigcup_{i=1}^n A_i \right| = \sum_{i} |A_i| - \sum_{i<j} |A_i \cap A_j| + \sum_{i<j<k} |A_i \cap A_j \cap A_k| - \cdots + (-1)^{n+1} \left| \bigcap_{i=1}^n A_i \right|
> $$
> 
>
> ğŸ§  **è®°å¿†å£è¯€**
>
> > "ğŸ”¢ å¥‡åŠ å¶å‡"ï¼šäº¤é›†é¡¹çš„ç¬¦å·éšé›†åˆæ•°é‡çš„å¥‡å¶æ€§å˜åŒ–ï¼ˆå¥‡æ•°åŠ ï¼Œå¶æ•°å‡ï¼‰
>
> â±ï¸ **å¤æ‚åº¦åˆ†æ**
>
> å®¹æ–¥åŸç†çš„æ—¶é—´å¤æ‚åº¦ä¸º **O(2â¿)**ï¼ˆnä¸ºé›†åˆæ•°ï¼‰ï¼Œå› ä¸ºéœ€è¦è®¡ç®—æ‰€æœ‰å¯èƒ½çš„äº¤é›†ç»„åˆï¼ˆå…±2â¿-1é¡¹ï¼‰ï¼Œä»…é€‚åˆå°è§„æ¨¡é—®é¢˜ï¼ˆé€šå¸¸nâ‰¤10ï¼‰ã€‚

### ğŸ“œ 9.0 æ´›è°·é¢˜å•

| æ¥æº | é¢˜ç›®/é¢˜å•                                | è¯´æ˜                 |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U430606 | U430606 æ•´é™¤çš„æ•°     |
| æ´›è°· | https://www.luogu.com.cn/problem/U381835 | U381835 èƒ½è¢«æ•´é™¤çš„æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/U274900 | U274900 èƒ½è¢«æ•´é™¤çš„æ•° |
| æ´›è°· | https://www.luogu.com.cn/training/674529 | å®¹æ–¥åŸç†ä¾‹é¢˜ï¼ˆé¢˜å•ï¼‰ |
| æ´›è°· | https://www.luogu.com.cn/training/106492 | å®¹æ–¥ï¼ˆé¢˜å•ï¼‰         |
| æ´›è°· | https://www.luogu.com.cn/training/187357 | å®¹æ–¥ä¸åæ¼”ï¼ˆé¢˜å•ï¼‰   |


### âœ… 9.1 èƒ½è¢«æ•´é™¤çš„æ•°

<strong>ğŸ”— ç»ƒä¹ å¹³å°</strong>


| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| æ´›è°· | https://www.luogu.com.cn/problem/U430606 | U430606 æ•´é™¤çš„æ•°     |
| æ´›è°· | https://www.luogu.com.cn/problem/U381835 | U381835 èƒ½è¢«æ•´é™¤çš„æ•° |
| æ´›è°· | https://www.luogu.com.cn/problem/U274900 | U274900 èƒ½è¢«æ•´é™¤çš„æ•° |
| æ´›è°· | https://www.luogu.com.cn/training/674529 | å®¹æ–¥åŸç†ä¾‹é¢˜ï¼ˆé¢˜å•ï¼‰ |



<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>


![image-20240222111632771](assets/image-20240222111632771.png)




![image-20240222171707026](assets/image-20240222171707026.png)



> **è§£æ³•æ€è·¯**ï¼š
>
> è®¾ $S_i$ æ˜¯ $1$åˆ° $n$ ä¸­èƒ½è¢« $p_i$ æ•´é™¤çš„æ•°çš„é›†åˆã€‚é—®é¢˜æ±‚ $|S_1 \cup S_2 \cup \dots \cup S_m|$ã€‚
>
> 1.  **åº”ç”¨å®¹æ–¥åŸç†**ï¼š
>     -   åŠ ä¸Šæ‰€æœ‰ $|S_i|$ã€‚$|S_i| = \lfloor n/p_i \rfloor$ã€‚
>     -   å‡å»æ‰€æœ‰ $|S_i \cap S_j|$ã€‚$|S_i \cap S_j| = \lfloor n / \operatorname{lcm}(p_i, p_j) \rfloor$ã€‚å› ä¸º $p_i$ éƒ½æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥ $\operatorname{lcm}(p_i, p_j) = p_i \cdot p_j$ã€‚
>     -   åŠ ä¸Šæ‰€æœ‰ $|S_i \cap S_j \cap S_k| = \lfloor n/(p_i p_j p_k) \rfloor$ã€‚
>     -   ä»¥æ­¤ç±»æ¨...
> 2.  **äºŒè¿›åˆ¶æšä¸¾**ï¼šæˆ‘ä»¬å¯ä»¥ç”¨äºŒè¿›åˆ¶æ•°æ¥æšä¸¾æ‰€æœ‰è´¨æ•°çš„ç»„åˆã€‚ä¸€ä¸ª `m` ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œä» `1` åˆ° `2^m - 1`ï¼Œæ¯ä¸€ä½å¯¹åº”ä¸€ä¸ªè´¨æ•°ã€‚å¦‚æœç¬¬ `j` ä½æ˜¯ `1`ï¼Œå°±è¡¨ç¤ºé€‰ä¸­ç¬¬ `j` ä¸ªè´¨æ•°ã€‚
> 3.  **è®¡ç®—**ï¼š
>     -   éå† `i` ä» `1` åˆ° `(1 << m) - 1`ã€‚
>     -   å¯¹äºæ¯ä¸ª `i`ï¼Œè®¡ç®—å®ƒé€‰ä¸­çš„è´¨æ•°çš„ä¹˜ç§¯ `t` å’Œé€‰ä¸­è´¨æ•°çš„ä¸ªæ•° `s`ã€‚
>     -   å¦‚æœ `s` æ˜¯å¥‡æ•°ï¼Œåˆ™å°† $\lfloor n/t \rfloor$ åŠ åˆ°ç»“æœä¸­ã€‚
>     -   å¦‚æœ `s` æ˜¯å¶æ•°ï¼Œåˆ™å°† $\lfloor n/t \rfloor$ ä»ç»“æœä¸­å‡å»ã€‚

> **AcWing é¢˜è§£**
```cpp
#include <iostream>
#include <algorithm>

using namespace std;

typedef long long LL;

const int N = 20;

int p[N];


int main()
{
    int n, m;
    cin >> n >> m;
	
	//ç”¨ p æ•°ç»„å­˜å‚¨ m ä¸ªè´¨æ•° 
    for (int i = 0; i < m; i ++ ) cin >> p[i];

    int res = 0;
    //å¤–å±‚å¾ªç¯éå†ä»1 åˆ° 1111...(mä¸ª1ï¼Œ2^m - 1)çš„æ¯ä¸€ä¸ªæ•°å­—ï¼Œæ¯ä¸ªæ•°å­—ä»£è¡¨ä¸Šå›¾ä¸­ç¬¬äºŒå¹…å›¾ç­‰å¼å³è¾¹çš„ä¸€ä¸ªåŠ é¡¹ 
    for (int i = 1; i < 1 << m; i ++ )
    {
        int t = 1, s = 0;//t ä¸ºé€‰ä¸­é›†åˆå¯¹åº”è´¨æ•°çš„ä¹˜ç§¯ ï¼Œs ä¸ºé€‰ä¸­é›†åˆçš„æ•°é‡
		 
        //å†…å±‚å¾ªç¯ï¼Œç¡®å®šå½“å‰åŠ é¡¹çš„å…·ä½“å½¢å¼ï¼Œä»æœ€ä½ä½å¼€å§‹éå†å½“å‰æ•°å­—çš„æ¯ä¸€ä½ï¼Œæ¯ä¸ªæ•°å­—éƒ½å½“æˆæœ‰ m ä½ï¼Œçœ‹å½“å‰æ•°å­—æœ‰å¤šå°‘ä¸ª 1ï¼Œç¡®å®šå½“å‰é¡¹æ˜¯å“ªä¸ªé›†åˆæˆ–å“ªå‡ ä¸ªé›†åˆçš„äº¤é›† 
        for (int j = 0; j < m; j ++ )
            if (i >> j & 1)
            {
            	//è‹¥ t * p[j] > n ï¼Œåˆ™ n / t = 0ï¼Œæ— æ„ä¹‰ 
                if ((LL)t * p[j] > n)
                {
                    t = -1;
                    break;
                }
                t *= p[j];//ä¹˜ä¸Šé›†åˆå¯¹åº”çš„è´¨æ•°
                s ++ ;//æœ‰ä¸€ä¸ª 1 ï¼Œé›†åˆæ•°é‡åŠ ä¸€ 
            }

        if (t != -1)
        { 
            //é™¤å¯¹åº”é›†åˆçš„è´¨æ•°çš„ä¹˜ç§¯å°±æ˜¯é›†åˆçš„æ•°é‡
            if (s % 2) res += n / t;//å¥‡æ•°é¡¹ä¸ºæ­£ 
            else res -= n / t;//å¶æ•°é¡¹ä¸ºè´Ÿ 
        }
    }

    cout << res << endl;

    return 0;
}
```
</details>

---

## ğŸ•¹ï¸ 10. åšå¼ˆè®º

> **æ ¸å¿ƒæ€æƒ³**ï¼šåšå¼ˆè®ºç ”ç©¶çš„æ˜¯å†³ç­–è€…ä¹‹é—´çš„ç­–ç•¥äº’åŠ¨ã€‚åœ¨ç®—æ³•ç«èµ›ä¸­ï¼Œé€šå¸¸æŒ‡**å…¬å¹³ç»„åˆæ¸¸æˆ (ICG)**ï¼Œå…¶ç‰¹ç‚¹æ˜¯ï¼šä¸¤åç©å®¶äº¤æ›¿è¡ŒåŠ¨ï¼›åœ¨ä»»æ„æ—¶åˆ»ï¼Œå¯æ‰§è¡Œçš„åˆæ³•è¡ŒåŠ¨ä¸è½®åˆ°å“ªåç©å®¶æ— å…³ï¼›ä¸èƒ½è¡ŒåŠ¨çš„ç©å®¶åˆ¤è´Ÿã€‚
>
> -   **å¿…èƒœæ€ (N-state)**ï¼šå­˜åœ¨ä¸€ç§èµ°æ³•ï¼Œå¯ä»¥åˆ°è¾¾ä¸€ä¸ªå¿…è´¥æ€ã€‚
> -   **å¿…è´¥æ€ (P-state)**ï¼šæ— è®ºæ€ä¹ˆèµ°ï¼Œéƒ½åªèƒ½åˆ°è¾¾å¿…èƒœæ€ã€‚
>
> **Nim æ¸¸æˆ**ï¼š
>
> -   **è§„åˆ™**ï¼šæœ‰ `n` å †çŸ³å­ï¼Œä¸¤äººè½®æµä»ä»»æ„ä¸€å †ä¸­å–ä»»æ„æ•°é‡ï¼ˆè‡³å°‘ä¸€ä¸ªï¼‰çš„çŸ³å­ï¼Œå–èµ°æœ€åä¸€ä¸ªçŸ³å­è€…èƒœã€‚
> -   **Nim å’Œ**ï¼šæ‰€æœ‰å †çŸ³å­æ•°é‡çš„å¼‚æˆ–å’Œï¼Œ$A_1 \oplus A_2 \oplus \dots \oplus A_n$ã€‚
> -   **ç»“è®º**ï¼šNim å’Œ **ä¸ä¸º 0**ï¼Œåˆ™å…ˆæ‰‹**å¿…èƒœ**ï¼›Nim å’Œ **ä¸º 0**ï¼Œåˆ™å…ˆæ‰‹**å¿…è´¥**ã€‚
>
> **SG å‡½æ•°**ï¼š
>
> -   **Mex (Minimum Excluded value)**ï¼š`mex(S)` æ˜¯ä¸å±äºé›†åˆ `S` çš„æœ€å°éè´Ÿæ•´æ•°ã€‚
> -   **SG(x)**ï¼šä¸€ä¸ªæ¸¸æˆçŠ¶æ€ `x` çš„ SG å‡½æ•°å€¼å®šä¹‰ä¸ºå…¶æ‰€æœ‰åç»§çŠ¶æ€ `y` çš„ SG å€¼çš„ `mex`ã€‚`SG(x) = mex({SG(y_1), SG(y_2), ...})`ã€‚
> -   **ç»“è®º**ï¼š`SG(x) != 0`ï¼ŒçŠ¶æ€ `x` æ˜¯å¿…èƒœæ€ï¼›`SG(x) == 0`ï¼ŒçŠ¶æ€ `x` æ˜¯å¿…è´¥æ€ã€‚
> -   **æ¸¸æˆå’Œçš„ SG å€¼**ï¼šå¤šä¸ªç‹¬ç«‹æ¸¸æˆçš„å’Œçš„ SG å€¼ï¼Œç­‰äºå„ä¸ªæ¸¸æˆ SG å€¼çš„å¼‚æˆ–å’Œã€‚$SG(G) = SG(G_1) \oplus SG(G_2) \oplus \dots$

### ğŸ“œ 10.0 æ´›è°· & LeetCode é¢˜å•

| æ¥æº | é¢˜ç›®/é¢˜å• | è¯´æ˜ |
| :--- | :--- | :--- |
| leetcode | [292. Nim æ¸¸æˆ](https://leetcode.cn/problems/nim-game/)      | 292. Nim æ¸¸æˆ                           |
| ç‰›å®¢     | [Nimæ¸¸æˆ_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/bb574ea90ed2495680fef88d59238231) | Nimæ¸¸æˆ                                 |
| ç‰›å®¢     | [ã€æ¨¡æ¿ã€‘Nimæ¸¸æˆ_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/8a43384a6a1c42eb9c7cbe47fb600db9) | ã€æ¨¡æ¿ã€‘Nimæ¸¸æˆ                         |
| æ´›è°·     | https://www.luogu.com.cn/problem/P2197                       | P2197 ã€æ¨¡æ¿ã€‘Nim æ¸¸æˆ                  |
| æ´›è°·     | https://www.luogu.com.cn/problem/T407141                     | T407141 0x3A-åšå¼ˆè®ºä¸SGå‡½æ•°-å°é˜¶nimæ¸¸æˆ |
| æ´›è°·     | https://www.luogu.com.cn/problem/U413951                     | U413951 NIMæ¸¸æˆï¼ˆå°é˜¶Nimæ¸¸æˆï¼‰          |
| æ´›è°·     | https://www.luogu.com.cn/problem/U583675                     | U583675 Nimæ¸¸æˆ-é›†åˆ                    |
| æ´›è°·     | https://www.luogu.com.cn/problem/T580886                     | T580886 æ‹†åˆ†-Nimæ¸¸æˆ                    |

### ğŸ—¿ 10.1 Nim æ¸¸æˆ

<details>
<summary><strong>ğŸ”— ç»ƒä¹ å¹³å°</strong></summary>

- **LeetCode**: [292. Nim æ¸¸æˆ](https://leetcode.cn/problems/nim-game/)
- **ç‰›å®¢**: [ã€æ¨¡æ¿ã€‘Nimæ¸¸æˆ](https://www.nowcoder.com/practice/8a43384a6a1c42eb9c7cbe47fb600db9)
- **æ´›è°·**: [P2197 ã€æ¨¡æ¿ã€‘Nim æ¸¸æˆ](https://www.luogu.com.cn/problem/P2197)

</details>


<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240222175803606](assets/image-20240222175803606.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> è¿™æ˜¯æœ€ç»å…¸çš„å…¬å¹³ç»„åˆæ¸¸æˆã€‚æ ¹æ® **Bouton's theorem**ï¼ŒNim æ¸¸æˆçš„èƒœè´ŸçŠ¶æ€å®Œå…¨ç”±æ‰€æœ‰å †çŸ³å­æ•°é‡çš„**å¼‚æˆ–å’Œ**ï¼ˆNim Sumï¼‰å†³å®šã€‚
>
> 1.  **å¿…è´¥æ€**ï¼šå½“æ‰€æœ‰çŸ³å­æ•°çš„å¼‚æˆ–å’Œä¸º `0` æ—¶ï¼Œå½“å‰å±€é¢ä¸ºå¿…è´¥æ€ã€‚å› ä¸ºæ— è®ºæ€ä¹ˆå–ï¼Œéƒ½ä¼šä½¿å¼‚æˆ–å’Œå˜ä¸ºé `0`ã€‚
> 2.  **å¿…èƒœæ€**ï¼šå½“å¼‚æˆ–å’Œä¸ä¸º `0` æ—¶ï¼Œå½“å‰å±€é¢ä¸ºå¿…èƒœæ€ã€‚å› ä¸ºæ€»å­˜åœ¨ä¸€ç§å–æ³•ï¼Œä½¿å¾—å–å®Œåæ–°çš„å¼‚æˆ–å’Œå˜ä¸º `0`ï¼Œä»è€Œå°†å¿…è´¥æ€ç•™ç»™å¯¹æ‰‹ã€‚
> 3.  **ç®—æ³•**ï¼šç›´æ¥è®¡ç®—æ‰€æœ‰å †çŸ³å­æ•°é‡çš„å¼‚æˆ–å’Œï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸º `0` å³å¯ã€‚

> **AcWing é¢˜è§£**

```cpp
#include <iostream>
using namespace std;

int main()
{
    int n;
    scanf("%d", &n);

    int res = 0;
    while (n -- )
    {
        int x;
        scanf("%d", &x);
        res ^= x;
    }
    
    // Nim å’Œä¸ä¸º 0ï¼Œå…ˆæ‰‹å¿…èƒœ
    if (res) puts("Yes");
    else puts("No");

    return 0;
}
```


</details>

### ğŸªœ 10.2 å°é˜¶-Nim æ¸¸æˆ

<details>
<summary><strong>ğŸ”— ç»ƒä¹ å¹³å°</strong></summary>

- **æ´›è°·**: [T407141 å°é˜¶nimæ¸¸æˆ](https://www.luogu.com.cn/problem/T407141)
- **æ´›è°·**: [U413951 NIMæ¸¸æˆï¼ˆå°é˜¶Nimæ¸¸æˆï¼‰](https://www.luogu.com.cn/problem/U413951)

</details>

<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240222180647209](assets/image-20240222180647209.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> è¿™æ˜¯ Nim æ¸¸æˆçš„ä¸€ä¸ªå·§å¦™å˜ä½“ã€‚çŸ³å­åªèƒ½ä»é«˜å°é˜¶ç§»å‘ä½å°é˜¶ã€‚
>
> 1.  **å…³é”®æ´å¯Ÿ**ï¼šä½äº**å¶æ•°**å°é˜¶ï¼ˆ2, 4, 6...ï¼‰ä¸Šçš„çŸ³å­æ˜¯â€œå®‰å…¨â€çš„ã€‚å¦‚æœå¯¹æ‰‹å°†çŸ³å­ä»å¥‡æ•°å°é˜¶ç§»åŠ¨åˆ°å¶æ•°å°é˜¶ï¼Œä½ å¯ä»¥ç«‹å³å°†è¿™äº›çŸ³å­å†ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå¶æ•°å°é˜¶ï¼Œå¯¹æ‰‹çš„æ“ä½œè¢«æ— æ•ˆåŒ–ã€‚æœ€ç»ˆï¼Œå°†çŸ³å­ç§»åŠ¨åˆ°ç¬¬ 0 çº§å°é˜¶ç›¸å½“äºç§»å‡ºæ¸¸æˆã€‚
> 2.  **ç­‰ä»·æ¨¡å‹**ï¼šå› æ­¤ï¼Œå¶æ•°å°é˜¶ä¸Šçš„çŸ³å­å¯¹æ¸¸æˆèƒœè´Ÿæ²¡æœ‰å½±å“ã€‚æ•´ä¸ªæ¸¸æˆç­‰ä»·äºä¸€ä¸ªåªåœ¨**å¥‡æ•°**å°é˜¶ï¼ˆ1, 3, 5...ï¼‰ä¸Šè¿›è¡Œçš„æ ‡å‡† Nim æ¸¸æˆã€‚
> 3.  **ç®—æ³•**ï¼šæˆ‘ä»¬åªå…³å¿ƒæ‰€æœ‰ä½äº**å¥‡æ•°ç¼–å·**å°é˜¶ä¸Šçš„çŸ³å­å †ã€‚è®¡ç®—è¿™äº›å †çš„ Nim å’Œï¼ˆå¼‚æˆ–å’Œï¼‰ã€‚
>     -   å¦‚æœå¥‡æ•°å°é˜¶çš„ Nim å’Œä¸ä¸º `0`ï¼Œå…ˆæ‰‹å¿…èƒœã€‚
>     -   å¦‚æœä¸º `0`ï¼Œå…ˆæ‰‹å¿…è´¥ã€‚

> **AcWing é¢˜è§£**

```cpp

//å¥‡æ•°å°é˜¶ä¸Šçš„å€¼çš„å¼‚æˆ–å€¼ä¸ºé0ï¼Œåˆ™å…ˆæ‰‹å¿…èƒœï¼Œåä¹‹å¿…è´¥ï¼

#include <iostream>
#include <algorithm>

using namespace std;

const int N = 100010;

int main()
{
    int n;
    scanf("%d", &n);

    int res = 0;
    for (int i = 1; i <= n; i ++ )
    {
        int x;
        scanf("%d", &x);
        //å¥‡æ•°äºŒè¿›åˆ¶å½¢å¼æœ€ä½ä½ä¸º 1 ï¼Œ&1 åä¸º 1ï¼Œå¶æ•°ä¸º 0 
        if (i & 1) res ^= x;
    }

    if (res) puts("Yes");
    else puts("No");

    return 0;
}

```
</details>


### ğŸ§© 10.3 é›†åˆ-Nim æ¸¸æˆ (SG å‡½æ•°)

<details>
<summary><strong>ğŸ”— ç»ƒä¹ å¹³å°</strong></summary>

- **æ´›è°·**: [U583675 Nimæ¸¸æˆ-é›†åˆ](https://www.luogu.com.cn/problem/U583675)

</details>

<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240223094335090](assets/image-20240223094335090.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> è¿™æ˜¯ä¸€ä¸ªå¤šä¸ªç‹¬ç«‹æ¸¸æˆçš„å’Œï¼Œæ¯å †çŸ³å­æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸¸æˆã€‚ä¸æ ‡å‡† Nim æ¸¸æˆä¸åŒçš„æ˜¯ï¼Œæ¯æ¬¡å¯å–èµ°çš„çŸ³å­æ•°é‡å—é™äºä¸€ä¸ªé›†åˆ `S`ã€‚
>
> 1.  **SG å®šç†**ï¼šæ ¹æ® Sprague-Grundy å®šç†ï¼Œæ•´ä¸ªæ¸¸æˆçš„ SG å€¼æ˜¯æ¯å †çŸ³å­çš„ SG å€¼çš„å¼‚æˆ–å’Œã€‚
> 2.  **å•ä¸ªæ¸¸æˆ SG å€¼**ï¼šå¯¹äºä¸€å † `x` ä¸ªçŸ³å­çš„æ¸¸æˆï¼Œå…¶åç»§çŠ¶æ€æ˜¯ `x - s_i`ï¼ˆå…¶ä¸­ `s_i` æ˜¯é›†åˆ `S` ä¸­çš„å…ƒç´ ä¸” `x >= s_i`ï¼‰ã€‚æ ¹æ® SG å‡½æ•°å®šä¹‰ï¼š
>     $$sg(x) = \text{mex}(\{sg(x - s_i) \mid s_i \in S, x \ge s_i\})$$
> 3.  **è®¡ç®—æ–¹æ³•**ï¼šæˆ‘ä»¬å¯ä»¥ç”¨**è®°å¿†åŒ–æœç´¢**ï¼ˆæˆ–åŠ¨æ€è§„åˆ’ï¼‰æ¥è®¡ç®— `sg(x)` çš„å€¼ï¼Œ`f[x]` å­˜å‚¨ `sg(x)`ã€‚
>     -   `sg(0)` çš„åç»§çŠ¶æ€ä¸ºç©ºé›†ï¼Œ`sg(0) = mex(\emptyset) = 0`ã€‚
>     -   è®¡ç®— `sg(x)` æ—¶ï¼Œæ”¶é›†æ‰€æœ‰åç»§çŠ¶æ€ `x-s_i` çš„ `sg` å€¼ï¼Œæ”¾å…¥ä¸€ä¸ª `set` ä¸­ï¼Œç„¶åæ±‚è¿™ä¸ª `set` çš„ `mex` å€¼ã€‚
> 4.  **æœ€ç»ˆåˆ¤æ–­**ï¼šè®¡ç®—æ‰€æœ‰å †çš„ `sg` å€¼çš„å¼‚æˆ–å’Œï¼Œå¦‚æœä¸ä¸º `0`ï¼Œåˆ™å…ˆæ‰‹å¿…èƒœã€‚

> **AcWing é¢˜è§£**
```cpp
#include <cstring>
#include <iostream>
#include <algorithm>
#include <unordered_set>

using namespace std;

const int N = 110, M = 10010;

int n, k;
int s[N], f[M];//s å­˜å‚¨çš„æ˜¯å¯æ‹¿å–çš„çŸ³å­æ•°é‡ï¼Œf å­˜å‚¨çš„æ˜¯å­˜å‚¨å·²ç»è®¡ç®—è¿‡çš„çŠ¶æ€ï¼ˆçŸ³å­æ•°é‡ï¼‰çš„ Nim å€¼ï¼Œé¿å…é‡å¤è®¡ç®— 


int sg(int x)
{
    if (f[x] != -1) return f[x];
    
	// S è¦åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰ ï¼Œå› ä¸ºæ¯æ¬¡é€’å½’ S éƒ½æ˜¯é’ˆå¯¹å½“å‰çŠ¶æ€çš„ï¼ŒSç”¨äºå½“å‰çŠ¶æ€ä¹‹åçš„çŠ¶æ€çš„sgå€¼ 
    unordered_set<int> S;
    
    //é€’å½’è®¡ç®—å½“å‰çŠ¶æ€ x å¯ä»¥åˆ°è¾¾çš„ä¹‹åçš„æ‰€æœ‰çŠ¶æ€çš„å€¼æ’å…¥ Sï¼ˆx èƒ½å¦å‡å¯æ‹¿å–çŸ³å­æ•°é‡é›†åˆ S ä¸­çš„å…ƒç´ ï¼‰ 
    for (int i = 0; i < k; i ++ )
    {
        int sum = s[i];
        if (x >= sum) S.insert(sg(x - sum));
    }
	
	//é€’å½’å®Œä¹‹åå°±å‰©å½“å‰çŠ¶æ€ x æ²¡æœ‰å€¼ï¼ˆä¸åœ¨ S é›†åˆä¸­ï¼‰äº†ï¼Œéå†è‡ªç„¶æ•°ï¼Œå¦‚æœæœ‰ä¸åœ¨ S ä¸­çš„è‡ªç„¶æ•°ä¾¿æ˜¯å½“å‰çŠ¶æ€ x çš„ sg å€¼ 
    for (int i = 0; ; i ++ )
        if (!S.count(i))
            return f[x] = i;
}


int main()
{
    cin >> k;
    for (int i = 0; i < k; i ++ ) cin >> s[i];
    cin >> n;

    memset(f, -1, sizeof f);

    int res = 0;
    for (int i = 0; i < n; i ++ )
    {
        int x;
        cin >> x;
        res ^= sg(x);
    }

    if (res) puts("Yes");
    else puts("No");

    return 0;
}
```
</details>


### ğŸ’¥ 10.4 æ‹†åˆ†-Nim æ¸¸æˆ (SG å‡½æ•°)

<details>
<summary><strong>ğŸ”— ç»ƒä¹ å¹³å°</strong></summary>

- **æ´›è°·**: [T580886 æ‹†åˆ†-Nimæ¸¸æˆ](https://www.luogu.com.cn/problem/T580886)

</details>

<details>
<summary><strong>ğŸ¯ AcWing é¢˜ç›®ä¸é¢˜è§£</strong></summary>

![image-20240223103605920](assets/image-20240223103605920.png)

![image-20240223103805594](assets/image-20240223103805594.png)

> **è§£æ³•æ€è·¯**ï¼š
>
> è¿™æ˜¯ä¸€ä¸ªæ‹†åˆ†æ¸¸æˆã€‚ä¸€å †çŸ³å­å¯ä»¥è¢«æ‹†åˆ†æˆä¸¤å †éç©ºçŸ³å­ï¼Œè¿™ç›¸å½“äºå½“å‰æ¸¸æˆç»“æŸï¼Œå˜æˆäº†ä¸¤ä¸ªæ–°çš„ç‹¬ç«‹æ¸¸æˆçš„å’Œã€‚
>
> 1.  **SG å®šç†**ï¼šå½“ä¸€ä¸ªæ¸¸æˆå¯ä»¥åˆ†è§£ä¸ºå¤šä¸ªå­æ¸¸æˆçš„å’Œæ—¶ï¼ŒåŸæ¸¸æˆçš„ SG å€¼ç­‰äºæ‰€æœ‰å­æ¸¸æˆ SG å€¼çš„å¼‚æˆ–å’Œã€‚
> 2.  **çŠ¶æ€è½¬ç§»**ï¼šå¯¹äºä¸€å † `x` ä¸ªçŸ³å­çš„æ¸¸æˆï¼Œä¸€ä¸ªåˆæ³•çš„ç§»åŠ¨æ˜¯å°†å…¶æ‹†åˆ†ä¸º `i` å’Œ `j` ä¸¤å †ï¼Œå…¶ä¸­ `i > 0`, `j > 0` ä¸” `i + j = x`ã€‚è¿™ä¸ªæ“ä½œçš„åç»§çŠ¶æ€æ˜¯ `æ¸¸æˆi + æ¸¸æˆj`ã€‚
> 3.  **è®¡ç®— SG å€¼**ï¼šæ ¹æ® SG å®šç†ï¼Œåç»§çŠ¶æ€çš„ SG å€¼ä¸º `sg(i) ^ sg(j)`ã€‚å› æ­¤ï¼Œ`x` çš„ SG å€¼ä¸ºï¼š
>     $$sg(x) = \text{mex}(\{sg(i) \oplus sg(j) \mid i+j=x, i,j > 0\})$$
> 4.  **è®¡ç®—æ–¹æ³•**ï¼šåŒæ ·ä½¿ç”¨è®°å¿†åŒ–æœç´¢ã€‚è®¡ç®— `sg(x)` æ—¶ï¼Œéœ€è¦éå†æ‰€æœ‰å¯èƒ½çš„æ‹†åˆ† `(i, x-i)`ï¼Œè®¡ç®— `sg(i) ^ sg(x-i)`ï¼Œå°†è¿™äº›å€¼æ”¾å…¥ `set`ï¼Œç„¶åæ±‚ `mex`ã€‚
> 5.  **æœ€ç»ˆåˆ¤æ–­**ï¼šæ•´ä¸ªæ¸¸æˆæ˜¯å¤šå †çŸ³å­çš„å’Œï¼Œæ‰€ä»¥æœ€ç»ˆèƒœè´Ÿç”±åˆå§‹æ—¶æ‰€æœ‰å †çš„ `sg` å€¼çš„å¼‚æˆ–å’Œå†³å®šã€‚

> **AcWing é¢˜è§£**
```cpp
#include <cstring>
#include <iostream>
#include <algorithm>
#include <unordered_set>

using namespace std;

const int N = 110;


int n;
int f[N];


int sg(int x)
{
    if (f[x] != -1) return f[x];

    unordered_set<int> S;
    
    //x > i >= j
    for (int i = 0; i < x; i ++ )
        for (int j = 0; j <= i; j ++ )
            S.insert(sg(i) ^ sg(j));

    for (int i = 0;; i ++ )
        if (!S.count(i))
            return f[x] = i;
}


int main()
{
    cin >> n;

    memset(f, -1, sizeof f);

    int res = 0;
    while (n -- )
    {
        int x;
        cin >> x;
        res ^= sg(x);
    }

    if (res) puts("Yes");
    else puts("No");

    return 0;
}
```

</details>