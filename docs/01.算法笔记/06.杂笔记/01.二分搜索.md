---
title: äºŒåˆ†æœç´¢
date: 2025-11-24 19:58:00
tags: [ç®—æ³•ç¬”è®°, Data Structure]
categories: [ç®—æ³•ç¬”è®°]
description: æœ¬ç¬”è®°ç³»ç»Ÿæ•´ç†äº† **äº”å¤§ç»å…¸äºŒåˆ†æŸ¥æ‰¾åœºæ™¯**ï¼Œå¹¶ä¸ºæ¯ä¸ªåœºæ™¯æä¾›äº†å¤šç§æ ¸å¿ƒå®ç°ã€‚æ— è®ºä½ æ˜¯åˆå­¦è€…è¿˜æ˜¯æƒ³å·©å›ºæ·±åŒ–ï¼Œéƒ½èƒ½ä»ä¸­è·ç›Šã€‚
permalink: /algorithms/misc/binary-search
coverImg: /cover-images/cover_4.webp

---
<!-- /home/bg12.webp -->

# ğŸ¯ äºŒåˆ†æŸ¥æ‰¾å®Œå…¨æŒæ¡æ‰‹å†Œ (äº”å¤§åœºæ™¯ + å¤šç§å†™æ³•è¯¦è§£)

æœ¬ç¬”è®°ç³»ç»Ÿæ•´ç†äº† **äº”å¤§ç»å…¸äºŒåˆ†æŸ¥æ‰¾åœºæ™¯**ï¼Œå¹¶ä¸ºæ¯ä¸ªåœºæ™¯æä¾›äº†å¤šç§æ ¸å¿ƒå®ç°ã€‚æ— è®ºä½ æ˜¯åˆå­¦è€…è¿˜æ˜¯æƒ³å·©å›ºæ·±åŒ–ï¼Œéƒ½èƒ½ä»ä¸­è·ç›Šã€‚

æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ä¸¤ç§ä¸»æµçš„å®ç°æ€è·¯ï¼š

1.  **`[l, r]` é—­åŒºé—´å†™æ³•**ï¼š
    *   **å®šä¹‰**ï¼šæœç´¢åŒºé—´åŒ…å«å·¦å³ä¸¤ä¸ªç«¯ç‚¹ï¼Œå¾ªç¯æ¡ä»¶ä¸º `while (l <= r)`ã€‚
    *   **ç‰¹ç‚¹**ï¼šé€»è¾‘ç›´è§‚ï¼Œæ¯æ¬¡å°†æœç´¢ç©ºé—´ä¸¥æ ¼æ’é™¤ `mid` ååˆ†ä¸ºä¸¤éƒ¨åˆ† (`l = mid + 1` æˆ– `r = mid - 1`)ã€‚é€šå¸¸éœ€è¦ä¸€ä¸ªè¾…åŠ©å˜é‡ `ans` æ¥è®°å½•æ»¡è¶³æ¡ä»¶çš„æ½œåœ¨ç­”æ¡ˆã€‚

2.  **`[l, r)` å·¦é—­å³å¼€å†™æ³•**ï¼š
    *   **å®šä¹‰**ï¼šæœç´¢åŒºé—´åŒ…å«å·¦ç«¯ç‚¹ä½†ä¸åŒ…å«å³ç«¯ç‚¹ï¼Œå¾ªç¯æ¡ä»¶ä¸º `while (l < r)`ã€‚
    *   **ç‰¹ç‚¹**ï¼šä»£ç æ›´ç´§å‡‘ï¼Œé€»è¾‘ä¸ C++ STL (`lower_bound`, `upper_bound`) é«˜åº¦ä¸€è‡´ã€‚å½“ `mid` å¯èƒ½æ˜¯ç­”æ¡ˆæ—¶ï¼Œæˆ‘ä»¬ä¼šä¿ç•™å®ƒ (`r = mid`)ï¼Œæœ€ç»ˆ `l` (æˆ– `r`) å°±æ˜¯ç­”æ¡ˆæ‰€åœ¨çš„ä½ç½®ã€‚



> å‚è€ƒé“¾æ¥ï¼š
>
> https://labuladong.online/algo/essential-technique/binary-search-framework/

---

## ğŸ”‘0 å‰ç½®çŸ¥è¯†è¦ç‚¹

### ğŸ›¡ï¸0.1 é˜²æ­¢æ•´æ•°æº¢å‡º
è®¡ç®— `mid` æ—¶ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ `l + (r - l) / 2` çš„å½¢å¼ï¼Œå¯ä»¥æœ‰æ•ˆé¿å… `l + r` åœ¨æ•°å€¼è¾ƒå¤§æ—¶è¶…å‡ºæ•´å‹ä¸Šé™ã€‚

```cpp
// æ ‡å‡†å†™æ³• (é˜²æº¢å‡º)
int mid = l + ((r - l) / 2);

// åœ¨æŸäº›åœºæ™¯ (å¦‚å¯»æ‰¾å³è¾¹ç•Œ) ä¸­ï¼Œéœ€è¦å‘ä¸Šå–æ•´ï¼Œé˜²æ­¢æ­»å¾ªç¯
int mid = l + ((r - l + 1) / 2);
```

### ğŸ†š0.2 ä¸¤ç§å†™æ³•çš„æ ¸å¿ƒåŒºåˆ«

| ç‰¹æ€§ | å†™æ³• Aï¼š`[l, r]` (é—­åŒºé—´) | å†™æ³• Bï¼š`[l, r)` (å·¦é—­å³å¼€) |
| :--- | :--- | :--- |
| ğŸ” **åˆå§‹åŒ–** | `l = 0`, `r = nums.size() - 1` | `l = 0`, `r = nums.size()` |
| ğŸ›‘ **å¾ªç¯æ¡ä»¶** | `while (l <= r)` | `while (l < r)` |
| âª **å‘å·¦æ”¶ç¼©** | `r = mid - 1` (mid å·²æ£€æŸ¥, æ’é™¤) | `r = mid` (mid å¯èƒ½æ˜¯ç­”æ¡ˆ, ä¿ç•™) |
| â© **å‘å³æ”¶ç¼©** | `l = mid + 1` (mid å·²æ£€æŸ¥, æ’é™¤) | `l = mid + 1` (mid å·²æ£€æŸ¥, æ’é™¤) |

---

## 1ï¸âƒ£ 1 åœºæ™¯ä¸€ï¼šç²¾ç¡®æŸ¥æ‰¾ (Equal)

**ğŸ¯ ç›®æ ‡**ï¼šåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ `nums[i] == target` çš„ç¡®åˆ‡ä¸‹æ ‡ã€‚
**â†©ï¸ è¿”å›**ï¼šå¦‚æœæ‰¾åˆ°ï¼Œè¿”å›å…¶ä¸‹æ ‡ï¼›è‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› `-1`ã€‚

### 1.1 `[l, r]` é—­åŒºé—´å†™æ³• (æ¨è)

> **æ€è·¯è§£æ**ï¼šè¿™æ˜¯æœ€æ ‡å‡†çš„äºŒåˆ†æŸ¥æ‰¾ã€‚åœ¨ `[l, r]` åŒºé—´å†…å¯»æ‰¾ç›®æ ‡ã€‚æ‰¾åˆ° `mid` åï¼Œå¦‚æœ `nums[mid]` å°±æ˜¯ `target`ï¼Œåˆ™å¤§åŠŸå‘Šæˆã€‚å¦‚æœ `nums[mid]` å°äº `target`ï¼Œè¯´æ˜ç›®æ ‡åœ¨å³ä¾§ï¼Œå› æ­¤ä¸‹ä¸€è½®æœç´¢ `[mid + 1, r]`ï¼›åä¹‹åˆ™æœç´¢ `[l, mid - 1]`ã€‚

```cpp
int findEqual(vector<int>& nums, int target) {
  int l = 0, r = nums.size() - 1;
  while (l <= r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] == target) {
      return mid;  // æ‰¾åˆ°ç›´æ¥è¿”å›
    } else if (nums[mid] < target) {
      l = mid + 1;
    } else {
      r = mid - 1;
    }
  }
  return -1;
}
```

### 1.2 `[l, r)` å·¦é—­å³å¼€å†™æ³•

> **æ€è·¯è§£æ**ï¼šåœ¨ `[l, r)` åŒºé—´å†…å¯»æ‰¾ã€‚å½“ `nums[mid] < target` æ—¶ï¼Œç›®æ ‡ä¸€å®šåœ¨ `[mid + 1, r)` å†…ã€‚å½“ `nums[mid] > target` æ—¶ï¼Œç›®æ ‡å¯èƒ½åœ¨ `[l, mid)` å†…ã€‚æ­¤å†™æ³•åœ¨æœªæ‰¾åˆ°ç›®æ ‡æ—¶ï¼Œå¾ªç¯ç»ˆæ­¢å `l` å’Œ `r` ä¼šé‡åˆï¼Œä½†è¯¥ä½ç½®ä¸ä¸€å®šæ˜¯ç›®æ ‡ï¼Œå› æ­¤éœ€è¦é¢å¤–åˆ¤æ–­æˆ–ç›´æ¥è¿”å› `-1`ã€‚

```cpp
int findEqual(vector<int>& nums, int target) {
  int l = 0, r = nums.size();
  while (l < r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] == target) {
      return mid;
    } else if (nums[mid] < target) {
      l = mid + 1;
    } else {
      r = mid;  // å³è¾¹ç•Œå˜æˆ mid
    }
  }
  return -1; // å¾ªç¯ç»“æŸæ—¶ l == rï¼Œä½†æœªæ‰¾åˆ° target
}
```

---

## 2ï¸âƒ£2 åœºæ™¯äºŒï¼šç¬¬ä¸€ä¸ª `>= target` çš„ä½ç½® (Lower Bound)

### 2.1 æƒ…å†µä¸€ï¼šæ‰¾ä¸åˆ°æ—¶è¿”å› `n` (åŒ C++ STL)

**ğŸ¯ ç›®æ ‡**ï¼šæ‰¾åˆ° **æœ€å°** çš„ä¸‹æ ‡ `i`ï¼Œä½¿å¾— `nums[i] >= target`ã€‚
**â†©ï¸ è¿”å›**ï¼šè‹¥å­˜åœ¨ï¼Œè¿”å›è¯¥ä¸‹æ ‡ï¼›è‹¥æ‰€æœ‰æ•°éƒ½å°äº `target`ï¼Œè¿”å›æ•°ç»„å¤§å° `n`ã€‚

#### 2.1.1 `[l, r]` é—­åŒºé—´å†™æ³•

> **å†™æ³• 1ï¼šans è¾…åŠ©å˜é‡æ³•**
> **æ€è·¯è§£æ**ï¼šå½“ `nums[mid] >= target` æ—¶ï¼Œ`mid` æ˜¯ä¸€ä¸ªæ½œåœ¨ç­”æ¡ˆã€‚æˆ‘ä»¬ç”¨ `ans` è®°å½•å®ƒï¼Œç„¶åå‘å·¦åŠéƒ¨åˆ† `[l, mid - 1]` è¿›ä¸€æ­¥å‹ç¼©ï¼Œå°è¯•å¯»æ‰¾æ›´é å·¦çš„å¥½ç­”æ¡ˆã€‚

```cpp
int lowerBound_v1(vector<int>& nums, int target) {
    int n = nums.size();
    int l = 0, r = n - 1;
    int ans = n; // é»˜è®¤è¿”å› n (è¶Šç•Œä½ç½®)

    while (l <= r) {
        int mid = l + (r - l) / 2;

        if (nums[mid] >= target) {
            ans = mid;   // è®°å½•å½“å‰ä½ç½®
            r = mid - 1; // ç»§ç»­å¾€å·¦æ‰¾
        } else {
            l = mid + 1;
        }
    }
    return ans;
}
```

> **å†™æ³• 2ï¼šæ··åˆå†™æ³• (é—­åŒºé—´åˆå§‹åŒ–ï¼Œå¼€åŒºé—´å¾ªç¯)**
> **æ€è·¯è§£æ**ï¼šè¿™ç§å†™æ³• `while (l < r)` ä¿è¯å¾ªç¯ç»“æŸå `l == r`ã€‚å¦‚æœ `nums[mid] >= target`ï¼Œè¯´æ˜ç­”æ¡ˆåœ¨ `mid` æˆ–å…¶å·¦ä¾§ï¼Œæ‰€ä»¥ `r = mid`ï¼›å¦åˆ™ç­”æ¡ˆåœ¨å³ä¾§ï¼Œ`l = mid + 1`ã€‚å¾ªç¯ç»“æŸåï¼Œ`l` æŒ‡å‘çš„å°±æ˜¯ç¬¬ä¸€ä¸ª `>= target` çš„å€™é€‰ä½ç½®ï¼Œæœ€åéœ€è¦æ£€æŸ¥è¯¥ä½ç½®æ˜¯å¦çœŸçš„æ»¡è¶³æ¡ä»¶ã€‚

```cpp
int lowerBound_v2(const vector<int>& nums, int target) {
  int n = nums.size();
  int l = 0, r = n - 1; // æ³¨æ„è¿™é‡Œ r çš„åˆå§‹åŒ–
  while (l < r) {
    int mid = l + (r - l) / 2;
    if (nums[mid] >= target) {
      r = mid;
    } else {
      l = mid + 1;
    }
  }
  // å¾ªç¯ç»“æŸæ—¶ l == rï¼Œéœ€è¦æ£€æŸ¥ nums[l] æ˜¯å¦çœŸçš„ >= target
  if (nums[l] < target) { return n; }
  return l;
}
```

#### 2.1.2 `[l, r)` å·¦é—­å³å¼€å†™æ³• (STL åŸç†)

> **æ€è·¯è§£æ**ï¼šå½“ `nums[mid] >= target` æ—¶ï¼Œ`mid` å¯èƒ½æ˜¯æœ€ç»ˆç­”æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å³è¾¹ç•Œæ”¶ç¼©åˆ° `r = mid` ä¿ç•™ `mid`ã€‚å¦åˆ™ï¼Œ`mid` å¤ªå°ï¼Œå»å³è¾¹æ‰¾ `l = mid + 1`ã€‚å¾ªç¯ç»“æŸåï¼Œ`l` æŒ‡å‘çš„å°±æ˜¯ç¬¬ä¸€ä¸ª `>= target` çš„ä½ç½®ã€‚è¿™æ˜¯æœ€ä¼˜é›…çš„ `lower_bound` å®ç°ã€‚

```cpp
int lowerBound_v3(vector<int>& nums, int target) {
  int l = 0, r = nums.size();

  while (l < r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] >= target) {
      r = mid;  // å¯èƒ½æ˜¯ç­”æ¡ˆï¼Œæ”¶ç¼©å³è¾¹ç•Œåˆ° mid
    } else {
      l = mid + 1;
    }
  }
  return l;  // å¾ªç¯ç»“æŸæ—¶ l == r
}
```

### 2.2 æƒ…å†µäºŒï¼šæ‰¾ä¸åˆ°æ—¶è¿”å› `-1`

**ğŸ¯ ç›®æ ‡**ï¼šæ‰¾åˆ° **æœ€å°** çš„ä¸‹æ ‡ `i`ï¼Œä½¿å¾— `nums[i] == target`ï¼ˆè¿™é‡ŒåŸç¬”è®°ä¼¼ä¹æ„ä¸ºæ‰¾ç¬¬ä¸€ä¸ªç­‰äºï¼Œæˆ‘ä»¬æŒ‰æ­¤ç†è§£ï¼‰ã€‚
**â†©ï¸ è¿”å›**ï¼šè‹¥ä¸å­˜åœ¨ï¼Œè¿”å› `-1`ã€‚

#### 2.2.1 `[l, r]` é—­åŒºé—´å†™æ³•

> **å†™æ³• 1: ans è¾…åŠ©å˜é‡æ³• + éªŒè¯**
> **æ€è·¯è§£æ**ï¼šå…ˆç”¨ `ans` å˜é‡æ‰¾åˆ°ç¬¬ä¸€ä¸ª `>= target` çš„ä½ç½®ï¼Œç„¶åéªŒè¯è¯¥ä½ç½®çš„å€¼æ˜¯å¦æ°å¥½ç­‰äº `target`ã€‚

```cpp
int lowerBound_v1(vector<int>& nums, int target) {
  int n = nums.size();
  int l = 0, r = n - 1;
  int ans = -1;  // é»˜è®¤è¿”å› -1

  while (l <= r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] >= target) {
      ans = mid;    // è®°å½•å½“å‰ä½ç½®
      r = mid - 1;  // ç»§ç»­å¾€å·¦æ‰¾
    } else {
      l = mid + 1;
    }
  }
  // ans å¯èƒ½æ˜¯ â‰¥ target çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œéœ€éªŒè¯æ˜¯å¦ç­‰äº target
  if (ans != -1 && ans < n && nums[ans] == target) { return ans; }
  return -1;
}
```

> **å†™æ³• 2: æ··åˆå†™æ³• + éªŒè¯**
> **æ€è·¯è§£æ**ï¼šåŒæ ·æ˜¯å…ˆæ‰¾åˆ°å€™é€‰ä½ç½® `l`ï¼Œç„¶åæ£€æŸ¥ `nums[l]` æ˜¯å¦ç­‰äº `target`ã€‚

```cpp
int lowerBound_v2(const vector<int>& nums, int target) {
  int n = nums.size();
  int l = 0, r = n - 1;
  while (l < r) {
    int mid = l + (r - l) / 2;
    if (nums[mid] >= target) {
      r = mid;
    } else {
      l = mid + 1;
    }
  }
  // å¦‚æœæœ€å nums[l] != targetï¼Œè¯´æ˜åº”è¿”å› -1
  return nums[l] == target ? l : -1;
}
```

#### 2.2.2 `[l, r)` å·¦é—­å³å¼€å†™æ³•

> **æ€è·¯è§£æ**ï¼šå…ˆç”¨æ ‡å‡†çš„ `lower_bound` æ‰¾åˆ°ç¬¬ä¸€ä¸ª `>= target` çš„ä½ç½® `l`ï¼Œç„¶åæ£€æŸ¥è¯¥ä½ç½®æ˜¯å¦è¶Šç•Œä»¥åŠå€¼æ˜¯å¦ç­‰äº `target`ã€‚

```cpp
int lowerBound_v3(vector<int>& nums, int target) {
  int l = 0, r = nums.size();
  while (l < r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] >= target) {
      r = mid;  // å¯èƒ½æ˜¯ç­”æ¡ˆï¼Œæ”¶ç¼©å³è¾¹ç•Œ
    } else {
      l = mid + 1;
    }
  }
  if (l < 0 || l >= nums.size()) { return -1; }
  return nums[l] == target ? l : -1;
}
```

---

## 3ï¸âƒ£3 åœºæ™¯ä¸‰ï¼šç¬¬ä¸€ä¸ª `> target` çš„ä½ç½® (Upper Bound)

**ğŸ¯ ç›®æ ‡**ï¼šæ‰¾åˆ° **æœ€å°** çš„ä¸‹æ ‡ `i`ï¼Œä½¿å¾— `nums[i] > target`ã€‚
**â†©ï¸ è¿”å›**ï¼šè‹¥å­˜åœ¨ï¼Œè¿”å›è¯¥ä¸‹æ ‡ï¼›è‹¥æ‰€æœ‰æ•°éƒ½å°äºç­‰äº `target`ï¼Œè¿”å›æ•°ç»„å¤§å° `n`ã€‚

### 3.1 `[l, r]` é—­åŒºé—´å†™æ³•

> **å†™æ³• 1: ans è¾…åŠ©å˜é‡æ³•**
> **æ€è·¯è§£æ**ï¼šé€»è¾‘ä¸ `lower_bound` å®Œå…¨ç›¸åŒï¼Œä»…å°†åˆ¤æ–­æ¡ä»¶ä» `>=` æ”¹ä¸º `>`ã€‚

```cpp
int upperBound_v1(vector<int>& nums, int target) {
  int n = nums.size();
  int l = 0, r = n - 1;
  int ans = n;

  while (l <= r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] > target) {
      ans = mid;    // è®°å½•å½“å‰ä½ç½®
      r = mid - 1;  // ç»§ç»­å¾€å·¦æ‰¾
    } else { // nums[mid] <= target
      l = mid + 1;
    }
  }
  return ans;
}
```

> **å†™æ³• 2: æ··åˆå†™æ³•**
> **æ€è·¯è§£æ**ï¼šä¸ `lower_bound` çš„æ··åˆå†™æ³•ç±»ä¼¼ï¼Œå¾ªç¯ç»“æŸå `l` æŒ‡å‘å€™é€‰ä½ç½®ï¼Œæœ€åéœ€è¦æ ¹æ® `nums[l]` çš„å€¼å†³å®šè¿”å› `l` è¿˜æ˜¯ `l+1`ã€‚

```cpp
int upperBound_v2(vector<int>& nums, int target) {
  int n = nums.size();
  if (n == 0) return 0;

  int l = 0, r = n - 1;
  while (l < r) {
    int mid = l + (r - l) / 2;
    if (nums[mid] > target) {
      r = mid;  // å¯èƒ½æ˜¯ç­”æ¡ˆ
    } else { // nums[mid] <= target
      l = mid + 1;
    }
  }
  // å¾ªç¯ç»“æŸ l==rï¼Œè‹¥ nums[l] > targetï¼Œl å°±æ˜¯ç­”æ¡ˆï¼Œå¦åˆ™ç­”æ¡ˆæ˜¯ l+1
  return nums[l] > target ? l : l + 1;
}
```

### 3.2 `[l, r)` å·¦é—­å³å¼€å†™æ³•

> **æ€è·¯è§£æ**ï¼š`upper_bound` çš„æ ‡å‡†ä¼˜é›…å®ç°ã€‚åˆ¤æ–­æ¡ä»¶å˜ä¸º `nums[mid] > target` æ—¶æ”¶ç¼©å³è¾¹ç•Œã€‚

```cpp
int upperBound_v3(vector<int>& nums, int target) {
  int l = 0, r = nums.size();

  while (l < r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] > target) {
      r = mid;
    } else {
      l = mid + 1;
    }
  }
  return l;
}
```

---

## 4ï¸âƒ£4 åœºæ™¯å››ï¼šæœ€åä¸€ä¸ª `<= target` çš„ä½ç½®

**ğŸ¯ ç›®æ ‡**ï¼šæ‰¾åˆ° **æœ€å¤§** çš„ä¸‹æ ‡ `i`ï¼Œä½¿å¾— `nums[i] <= target`ã€‚
**â†©ï¸ è¿”å›**ï¼šè‹¥å­˜åœ¨ï¼Œè¿”å›è¯¥ä¸‹æ ‡ï¼›è‹¥æ‰€æœ‰æ•°éƒ½å¤§äº `target`ï¼Œè¿”å› `-1`ã€‚

### 4.1 `[l, r]` ç›´æ¥æŸ¥æ‰¾æ³•

> **å†™æ³• 1: ans è¾…åŠ©å˜é‡æ³•**
> **æ€è·¯è§£æ**ï¼šå½“ `nums[mid] <= target` æ—¶ï¼Œ`mid` æ˜¯ä¸€ä¸ªæ½œåœ¨ç­”æ¡ˆã€‚æˆ‘ä»¬ç”¨ `ans` è®°å½•å®ƒï¼Œç„¶åå‘å³åŠéƒ¨åˆ† `[mid + 1, r]` å¯»æ‰¾ï¼Œå°è¯•æ‰¾åˆ°æ›´é å³çš„å¥½ç­”æ¡ˆã€‚

```cpp
int lastLessEqual_v1(vector<int>& nums, int target) {
  int l = 0, r = nums.size() - 1;
  int ans = -1;  // é»˜è®¤ä¸º -1

  while (l <= r) {
    int mid = l + (r - l) / 2;

    if (nums[mid] <= target) {
      ans = mid;    // è®°å½•ä½ç½®
      l = mid + 1;  // å¾€å³æ‰¾æ›´å¤§çš„ä¸‹æ ‡
    } else {
      r = mid - 1;
    }
  }
  return ans;
}
```

> **å†™æ³• 2: æ”¹å˜ mid è®¡ç®—æ–¹å¼**
> **æ€è·¯è§£æ**ï¼šè¿™ç§å†™æ³• `mid` å‘ä¸Šå–æ•´ `(r - l + 1) / 2`ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢å½“ `l = r - 1` æ—¶ `mid = l`ï¼Œè‹¥æ­¤æ—¶ `l = mid` ä¼šå¯¼è‡´æ­»å¾ªç¯ã€‚å½“ `nums[mid] <= target`ï¼Œç­”æ¡ˆåœ¨ `mid` æˆ–å…¶å³ä¾§ï¼Œæ‰€ä»¥ `l = mid`ã€‚

```cpp
int lastLessEqual_v2(vector<int>& nums, int target) {
  int l = 0, r = nums.size() - 1;
  if (nums.empty()) return -1;
  while (l < r) {
    int mid = l + (r - l + 1) / 2; // å‘ä¸Šå–æ•´
    if (nums[mid] <= target) {
      l = mid;  // å¯èƒ½æ˜¯ç­”æ¡ˆï¼Œå‘å³æ”¶ç¼© [mid, r]
    } else {
      r = mid - 1;
    }
  }
  // å¾ªç¯ç»ˆæ­¢æ—¶ l == rï¼Œéœ€æœ€ååˆ¤æ–­
  return (nums[l] <= target) ? l : -1;
}
```

### 4.2 `[l, r)` è½¬æ¢æ³• (åˆ©ç”¨ Upper Bound)

> **ğŸ’¡ æ ¸å¿ƒæ€æƒ³**ï¼š
> å¯»æ‰¾ â€œæœ€åä¸€ä¸ª `<= target` çš„æ•°â€ï¼Œç­‰ä»·äºå¯»æ‰¾ â€œç¬¬ä¸€ä¸ª `> target` çš„æ•°â€ çš„ **å‰ä¸€ä¸ªä½ç½®**ã€‚è¿™æ˜¯éå¸¸å·§å¦™çš„è½¬æ¢ã€‚

```cpp
int lastLessEqual_v3(vector<int>& nums, int target) {
  // 1. å…ˆç”¨ upper_bound æ‰¾åˆ°ç¬¬ä¸€ä¸ª > target çš„ä½ç½® l
  int l = 0, r = nums.size();
  while (l < r) {
    int mid = l + (r - l) / 2;
    if (nums[mid] > target) {
      r = mid;
    } else {
      l = mid + 1;
    }
  }
  // 2. è¿™ä¸ªä½ç½® l çš„å‰ä¸€ä¸ªä½ç½® (l-1) å°±æ˜¯ç­”æ¡ˆ
  // å¦‚æœ l=0 (æ‰€æœ‰æ•°éƒ½ > target)ï¼Œè¿”å› -1ï¼Œé€»è¾‘æ­£ç¡®
  return l - 1;
}
```

---

## 5ï¸âƒ£5 åœºæ™¯äº”ï¼šæœ€åä¸€ä¸ª `< target` çš„ä½ç½®

**ğŸ¯ ç›®æ ‡**ï¼šæ‰¾åˆ° **æœ€å¤§** çš„ä¸‹æ ‡ `i`ï¼Œä½¿å¾— `nums[i] < target`ã€‚
**â†©ï¸ è¿”å›**ï¼šè‹¥å­˜åœ¨ï¼Œè¿”å›è¯¥ä¸‹æ ‡ï¼›è‹¥æ‰€æœ‰æ•°éƒ½å¤§äºç­‰äº `target`ï¼Œè¿”å› `-1`ã€‚

### 5.1 `[l, r]` ç›´æ¥æŸ¥æ‰¾æ³•

> **æ€è·¯è§£æ**ï¼šä¸åœºæ™¯å››éå¸¸ç›¸ä¼¼ï¼Œä»…å°†æ¡ä»¶ä» `<=` æ”¹ä¸º `<`ã€‚æ»¡è¶³ `nums[mid] < target` æ—¶ï¼Œè®°å½•ç­”æ¡ˆå¹¶å‘å³å¯»æ‰¾ã€‚

```cpp
int lastLess_v1(vector<int>& nums, int target) {
    int l = 0, r = nums.size() - 1;
    int ans = -1;

    while (l <= r) {
        int mid = l + (r - l) / 2;

        if (nums[mid] < target) {
            ans = mid;   // è®°å½•ä½ç½®
            l = mid + 1; // å¾€å³æ‰¾
        } else { // nums[mid] >= target
            r = mid - 1;
        }
    }
    return ans;
}
```

### 5.2 `[l, r)` è½¬æ¢æ³• (åˆ©ç”¨ Lower Bound)

> **ğŸ’¡ æ ¸å¿ƒæ€æƒ³**ï¼š
> å¯»æ‰¾ â€œæœ€åä¸€ä¸ª `< target` çš„æ•°â€ï¼Œç­‰ä»·äºå¯»æ‰¾ â€œç¬¬ä¸€ä¸ª `>= target` çš„æ•°â€ çš„ **å‰ä¸€ä¸ªä½ç½®**ã€‚

```cpp
int lastLess_v2(vector<int>& nums, int target) {
    // 1. å…ˆç”¨ lower_bound æ‰¾åˆ°ç¬¬ä¸€ä¸ª >= target çš„ä½ç½® l
    int l = 0, r = nums.size();
    while (l < r) {
        int mid = l + (r - l) / 2;
        if (nums[mid] >= target) {
            r = mid;
        } else {
            l = mid + 1;
        }
    }
    // 2. è¿™ä¸ªä½ç½® l çš„å‰ä¸€ä¸ªä½ç½® (l-1) å°±æ˜¯ç­”æ¡ˆ
    return l - 1;
}
```

---

## ğŸ“6 æ€»ç»“é€ŸæŸ¥è¡¨

| åœºæ™¯ | æ ¸å¿ƒç¬¦å· | `[l, r]` é—­åŒºé—´æ€è·¯ (ans è®°å½•æ³•) | `[l, r)` ä¼˜é›…æ€è·¯ (è¿”å› l æˆ– l-1) |
| :--- | :---: | :--- | :--- |
| **1. ç²¾ç¡®æŸ¥æ‰¾** | `==` | æ‰¾åˆ° `target` ç›´æ¥ `return mid` | æ‰¾åˆ° `target` ç›´æ¥ `return mid` |
| **2. ç¬¬ä¸€ä¸ª â‰¥** (Lower Bound)| `>=` | `ans = mid; r = mid - 1;` (å¾€å·¦å‹ç¼©) | **ç›´æ¥æ³•**: `r = mid`ï¼Œè¿”å› `l` |
| **3. ç¬¬ä¸€ä¸ª >** (Upper Bound)| `>` | `ans = mid; r = mid - 1;` (å¾€å·¦å‹ç¼©) | **ç›´æ¥æ³•**: `r = mid`ï¼Œè¿”å› `l` |
| **4. æœ€åä¸€ä¸ª â‰¤** | `<=` | `ans = mid; l = mid + 1;` (å¾€å³è´ªå¿ƒ) | **è½¬æ¢æ³•**: æ‰¾ **ç¬¬ä¸€ä¸ª `>`** çš„ä½ç½®ï¼Œè¿”å› `l - 1` |
| **5. æœ€åä¸€ä¸ª <** | `<` | `ans = mid; l = mid + 1;` (å¾€å³è´ªå¿ƒ) | **è½¬æ¢æ³•**: æ‰¾ **ç¬¬ä¸€ä¸ª `â‰¥`** çš„ä½ç½®ï¼Œè¿”å› `l - 1` |

> ### ğŸš€ **è®°å¿†å£è¯€**
> *   **æ‰¾ç¬¬ä¸€ä¸ª** (>=, >)ï¼šæ»¡è¶³æ¡ä»¶æ—¶ï¼Œç­”æ¡ˆå¯èƒ½åœ¨å·¦è¾¹ï¼Œæ‰€ä»¥ `ans` è®°å½•ï¼Œ`r` å‘å·¦ç¼©ï¼›æˆ–è€…ç”¨ `[l,r)` å†™æ³•ï¼Œ`r = mid`ã€‚
> *   **æ‰¾æœ€åä¸€ä¸ª** (<, <=)ï¼šæ»¡è¶³æ¡ä»¶æ—¶ï¼Œç­”æ¡ˆå¯èƒ½åœ¨å³è¾¹ï¼Œæ‰€ä»¥ `ans` è®°å½•ï¼Œ`l` å‘å³æ‰©ï¼›æˆ–è€…**ä¼˜é›…åœ°è½¬æ¢ä¸ºæ‰¾ â€œç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„â€ çš„å‰ä¸€ä¸ªä½ç½®**ã€‚





## ğŸ› ï¸7 C++ STL å®ç°



C++ æ ‡å‡†åº“ `<algorithm>` æä¾›äº†ä¸¤ä¸ªå¼ºå¤§çš„å‡½æ•°ï¼Œ`lower_bound` ä¸ `upper_bound`ï¼Œå®Œç¾å®ç°äº†æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„åœºæ™¯ï¼Œä¸”æ•ˆç‡æé«˜ã€‚**å®ƒä»¬éƒ½è¦æ±‚ä½œç”¨çš„åŒºé—´æ˜¯å·²æ’åºçš„**ã€‚

### ğŸ“Œ 7.1`lower_bound`

-   **åŠŸèƒ½**ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ª **ä¸å°äº (>=)** `value` çš„å…ƒç´ ã€‚
-   **å¯¹åº”åœºæ™¯**ï¼šåœºæ™¯äºŒï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª `>= target` çš„ä½ç½®ã€‚
-   **å‡½æ•°ç­¾å**ï¼š`ForwardIterator lower_bound(ForwardIterator first, ForwardIterator last, const T& value);`
-   **å‚æ•°**ï¼š
    -   `first`: æŒ‡å‘åºåˆ—èµ·å§‹ä½ç½®çš„è¿­ä»£å™¨ã€‚
    -   `last`: æŒ‡å‘åºåˆ—**ç»“æŸä½ç½®ä¹‹å**çš„è¿­ä»£å™¨ï¼ˆæ„æˆ `[first, last)` å·¦é—­å³å¼€åŒºé—´ï¼‰ã€‚
    -   `value`: è¦æŸ¥æ‰¾çš„å€¼ã€‚
-   **è¿”å›å€¼**ï¼šè¿”å›ä¸€ä¸ªæŒ‡å‘ç›®æ ‡çš„è¿­ä»£å™¨ã€‚å¦‚æœæ‰€æœ‰å…ƒç´ éƒ½å°äº `value`ï¼Œåˆ™è¿”å› `last`ã€‚

ç¤ºä¾‹ä»£ç 

```cpp
#include <algorithm>  // åŒ…å« lower_bound
#include <iostream>
#include <vector>
using namespace std;
int main() {
  vector<int> nums = {10, 20, 30, 30, 30, 40, 50};
  int target = 30;

  // æŸ¥æ‰¾ç¬¬ä¸€ä¸ª >= target çš„å…ƒç´ 
  auto it = lower_bound(nums.begin(), nums.end(), target);

  if (it != nums.end()) {
    // ç›´æ¥ä½¿ç”¨è¿­ä»£å™¨å‡æ³•è®¡ç®—ä¸‹æ ‡ï¼ˆé€‚ç”¨äºéšæœºè®¿é—®è¿­ä»£å™¨ï¼‰
    long long index = it - nums.begin();
    cout << "ç¬¬ä¸€ä¸ª >= " << target << " çš„å…ƒç´ æ˜¯: " << *it << endl;
    cout << "å®ƒçš„ä¸‹æ ‡æ˜¯: " << index << endl;  // è¾“å‡ºä¸‹æ ‡ 2
  } else {
    cout << "æ²¡æœ‰æ‰¾åˆ° >= " << target << " çš„å…ƒç´ ã€‚" << endl;
  }
  return 0;
}
```

### ğŸ“Œ7.2 `upper_bound`

-   **åŠŸèƒ½**ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ª **ä¸¥æ ¼å¤§äº (>)** `value` çš„å…ƒç´ ã€‚
-   **å¯¹åº”åœºæ™¯**ï¼šåœºæ™¯ä¸‰ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª `> target` çš„ä½ç½®ã€‚
-   **å‡½æ•°ç­¾å**ï¼š`ForwardIterator upper_bound(ForwardIterator first, ForwardIterator last, const T& value);`
-   **å‚æ•°**ï¼šåŒ `lower_bound`ã€‚
-   **è¿”å›å€¼**ï¼šè¿”å›ä¸€ä¸ªæŒ‡å‘ç›®æ ‡çš„è¿­ä»£å™¨ã€‚å¦‚æœæ‰€æœ‰å…ƒç´ éƒ½å°äºç­‰äº `value`ï¼Œåˆ™è¿”å› `last`ã€‚

ç¤ºä¾‹ä»£ç 

```cpp
#include <algorithm>
#include <iostream>
#include <vector>
using namespace std;
int main() {
  vector<int> nums = {10, 20, 30, 30, 30, 40, 50};
  int target = 30;

  // æŸ¥æ‰¾ç¬¬ä¸€ä¸ª > 30 çš„å…ƒç´ 
  auto it = upper_bound(nums.begin(), nums.end(), target);

  if (it != nums.end()) {
    long long index = it - nums.begin();
    cout << "ç¬¬ä¸€ä¸ª > " << target << " çš„å…ƒç´ æ˜¯: " << *it << endl;  // è¾“å‡º 40
    cout << "å®ƒçš„ä¸‹æ ‡æ˜¯: " << index << endl;  // è¾“å‡ºä¸‹æ ‡ 5
  } else {
    cout << "æ²¡æœ‰æ‰¾åˆ° > " << target << " çš„å…ƒç´ ã€‚" << endl;
  }
  return 0;
}
```


