---
title: å¿«é€Ÿæ’åºä¸‰ç§å®ç°æ–¹å¼å¯¹æ¯”åˆ†æ
date: 2025-11-28 15:27:00
categories:
  - ç®—æ³•ç¬”è®°
  - AcWingBase
tags:
  - ç®—æ³•ç¬”è®°
  - C++
  - Algorithm
  - Data Structure
description: æœ¬æ–‡å¯¹æ¯”åˆ†æäº†ä¸‰ç§å¿«é€Ÿæ’åºçš„å®ç°æ–¹å¼ï¼ŒåŒ…æ‹¬åŸºäºå€¼çš„éšæœº Partitionã€ç»å…¸ Hoare åˆ†åŒºå’Œä¸‰è·¯å¿«æ’ï¼Œè¯¦ç»†ä»‹ç»äº†å„è‡ªçš„ä»£ç å®ç°ã€ä¼˜ç¼ºç‚¹åŠé€‚ç”¨åœºæ™¯ï¼Œå¸®åŠ©è¯»è€…é€‰æ‹©åˆé€‚çš„å¿«é€Ÿæ’åºæ–¹æ³•ã€‚
permalink: /algorithms/misc/quick-sort-comparison
coverImg: /home/bg13.webp
---



# å¿«é€Ÿæ’åºä¸‰ç§å®ç°æ–¹å¼å¯¹æ¯”åˆ†æ

> **è¯´æ˜**ï¼šä»¥ä¸‹ä¸‰ç§æ–¹æ³•å‡åŸºäº C++ å®ç°ï¼Œé€‚ç”¨äºæ ‡å‡†å¿«é€Ÿæ’åºåœºæ™¯ã€‚æ‰€æœ‰ä»£ç å‡å¯åœ¨æœ¬åœ°ç¼–è¯‘è¿è¡Œï¼Œå¹¶åœ¨ Typora ä¸­å®Œç¾æ¸²æŸ“ã€‚



| æ¥æº | é¢˜ç›®/é¢˜å•                                                    | è¯´æ˜                     |
| ---- | ------------------------------------------------------------ | ------------------------ |
| ç‰›å®¢ | https://www.nowcoder.com/practice/3385982ae71d4a1ca8bf3d03614c0325 | **å¿«é€Ÿæ’åº**             |
| ç‰›å®¢ | https://www.nowcoder.com/practice/34731183c31e4276b2d081590b2f3a4b | **æ’åºï¼ˆå¿«é€Ÿæ’åºï¼‰**     |
| æ´›è°· | https://www.luogu.com.cn/problem/T588555                     | T588555 å¿«é€Ÿæ’åº         |
| æ´›è°· | https://www.luogu.com.cn/problem/U223702                     | U223702 å¿«é€Ÿæ’åº         |
| æ´›è°· | https://www.luogu.com.cn/problem/T292012                     | T292012 ã€æ¨¡æ¿ã€‘å¿«é€Ÿæ’åº |
| æ´›è°· | https://www.luogu.com.cn/problem/T588555                     | T588555 å¿«é€Ÿæ’åº         |
| æ´›è°· | https://www.luogu.com.cn/problem/T318859                     | T318859 Quick Sortå¿«æ’   |

---

## ä¸€ã€æ€»ä½“æ¦‚è§ˆ

| ç‰¹æ€§               | `quickSort1`                  | `quickSort2`           | `quickSort3`                         |
| ------------------ | ----------------------------- | ---------------------- | ------------------------------------ |
| **åˆ†åŒºæ–¹å¼**       | åŸºäºå€¼çš„å•å‘æ‰«æ + éšæœº pivot | åŒå‘æŒ‡é’ˆï¼ˆHoare åˆ†åŒºï¼‰ | ä¸‰è·¯å¿«æ’ï¼ˆDijkstra ä¸‰åˆ†æ³•ï¼‰          |
| **Pivot é€‰æ‹©**     | éšæœºé€‰å–å…ƒç´ **å€¼**            | ä¸­é—´ä½ç½®å…ƒç´            | ä¸­é—´ä½ç½®å…ƒç´                          |
| **é‡å¤å…ƒç´ ä¼˜åŒ–**   | âŒ                             | âŒ                      | âœ…                                    |
| **å¹³å‡æ—¶é—´å¤æ‚åº¦** | $O(n \log n)$                 | $O(n \log n)$          | $O(n \log n)$ï¼Œå¤§é‡é‡å¤æ—¶æ¥è¿‘ $O(n)$ |
| **æ˜¯å¦æ¨è**       | âš ï¸ è°¨æ…                        | âœ… æ¨è                 | âœ…ï¼ˆä¿®æ­£åï¼‰                          |

---

## äºŒã€æ–¹æ³•ä¸€ï¼š`quickSort1` â€”â€” åŸºäºå€¼çš„éšæœº Partitionï¼ˆLomuto å˜ç§ï¼‰

### âœ… å®Œæ•´å¯è¿è¡Œä»£ç 

```cpp
#include <cmath>
#include <iostream>
using namespace std;
const int N = 1e5 + 5;
int nums[N];

// Partition å‡½æ•°ï¼šå°† <= x çš„å…ƒç´ ç§»åˆ°å·¦è¾¹ï¼Œå¹¶ç¡®ä¿ä¸€ä¸ª x è½åœ¨æœ€ç»ˆä½ç½®
int Partition(int l, int r, int x) {
  int a = l, xi = l;
  for (int i = l; i <= r; i++) {
    if (nums[i] <= x) {
      swap(nums[a], nums[i]);
      if (nums[a] == x) { xi = a; }
      a++;
    }
  }
  swap(nums[xi], nums[a - 1]);  // å°†ä¸€ä¸ª x æ”¾åˆ°æ­£ç¡®ä½ç½®
  return a - 1;
}

void quickSort1(int l, int r) {
  if (l >= r) return;
  // éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹æ ‡ï¼Œå–å…¶å€¼ä½œä¸º pivot
  int rand_index = l + rand() % (r - l + 1);
  int x = nums[rand_index];
  int p = Partition(l, r, x);
  quickSort1(l, p - 1);
  quickSort1(p + 1, r);
}

int main() {
  srand(time(0));  // åˆå§‹åŒ–éšæœºç§å­
  int n;
  scanf("%d", &n);
  for (int i = 0; i < n; i++) { scanf("%d", &nums[i]); }
  quickSort1(0, n - 1);
  for (int i = 0; i < n; i++) { printf("%d ", nums[i]); }
  return 0;
}
```

### âš ï¸ æ³¨æ„äº‹é¡¹
- è™½ç„¶å¼•å…¥äº†éšæœºåŒ–ï¼Œä½†å¯¹**é‡å¤å…ƒç´ å¤„ç†ä¸å®Œå–„**ã€‚
- åœ¨æç«¯é‡å¤æ•°æ®ä¸‹å¯èƒ½æ€§èƒ½é€€åŒ–æˆ–è¡Œä¸ºå¼‚å¸¸ã€‚
- ä¸å»ºè®®ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚

---

## ä¸‰ã€æ–¹æ³•äºŒï¼š`quickSort2` â€”â€” ç»å…¸ Hoare åˆ†åŒºï¼ˆåŒå‘æŒ‡é’ˆï¼‰

### âœ… å®Œæ•´å¯è¿è¡Œä»£ç 

```cpp
#include <cstdio>
#include <iostream>
using namespace std;
const int N = 1e5 + 5;
int nums[N];

void quickSort2(int l, int r) {
  if (l >= r) return;
  int i = l - 1, j = r + 1;
  // int x = nums[l + ((r - l) >> 1)];  // å–ä¸­é—´å…ƒç´ ä¸º pivot
  int x = nums[l + rand() % (r - l + 1)];  // éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹æ ‡ ä¸º pivot (æ¨è)
  while (i < j) {
    do { i++; } while (nums[i] < x);
    do { j--; } while (nums[j] > x);
    if (i < j) { swap(nums[i], nums[j]); }
  }
  // æ³¨æ„ï¼šHoare åˆ†åŒºè¿”å›çš„æ˜¯ jï¼Œé€’å½’ [l, j] å’Œ [j+1, r]
  quickSort2(l, j);
  quickSort2(j + 1, r);
}

int main() {
  int n;
  scanf("%d", &n);
  for (int i = 0; i < n; i++) { scanf("%d", &nums[i]); }
  quickSort2(0, n - 1);
  for (int i = 0; i < n; i++) { printf("%d ", nums[i]); }
  return 0;
}
```

### âœ… ä¼˜ç‚¹
- ä»£ç ç®€æ´ï¼Œæ•ˆç‡é«˜ã€‚
- ä¸­é—´é€‰ pivot å¯¹æœ‰åº/é€†åºæ•°ç»„è¡¨ç°è‰¯å¥½ã€‚
- æ˜¯ç»å…¸ä¸”å¹¿æ³›ä½¿ç”¨çš„å¿«æ’å®ç°ã€‚

---

## å››ã€æ–¹æ³•ä¸‰ï¼š`quickSort3` â€”â€” ä¸‰è·¯å¿«æ’ï¼ˆThree-way QuickSortï¼‰

> **é‡è¦**ï¼šåŸå§‹ä»£ç å­˜åœ¨ä¸¥é‡è¶Šç•Œ Bugï¼Œä»¥ä¸‹ä¸º**ä¿®æ­£åçš„æ­£ç¡®ç‰ˆæœ¬**ã€‚

### âœ… å®Œæ•´å¯è¿è¡Œä»£ç 

```cpp
#include <cstdio>
#include <iostream>
using namespace std;

const int N = 1e5 + 5;
int nums[N];

void quickSort3(int l, int r) {
  if (l >= r) return;
  // int x = nums[l + ((r - l) >> 1)];  // pivot å€¼
  int x = nums[l + rand() % (r - l + 1)];  // éšæœºç”Ÿæˆä½ç½®å– pivot å€¼ï¼ˆæ¨èï¼‰
  int lt = l;                        // [l, lt-1] ä¸º < x çš„åŒºåŸŸ
  int gt = r;                        // [gt+1, r] ä¸º > x çš„åŒºåŸŸ
  int i = l;                         // å½“å‰æ‰«ææŒ‡é’ˆ

  while (i <= gt) {
    if (nums[i] < x) {
      swap(nums[i], nums[lt]);
      lt++;
      i++;
    } else if (nums[i] > x) {
      swap(nums[i], nums[gt]);
      gt--;
      // æ³¨æ„ï¼šæ­¤å¤„ i ä¸è‡ªå¢ï¼Œå› ä¸ºä» gt æ¢æ¥çš„å…ƒç´ æœªè¢«æ£€æŸ¥
    } else {
      i++;  // ç­‰äº xï¼Œç›´æ¥è·³è¿‡
    }
  }

  // é€’å½’å¤„ç† < x å’Œ > x çš„éƒ¨åˆ†ï¼Œ== x çš„éƒ¨åˆ†å·²å°±ä½
  quickSort3(l, lt - 1);
  quickSort3(gt + 1, r);
}

int main() {
  int n;
  scanf("%d", &n);
  for (int i = 0; i < n; i++) { scanf("%d", &nums[i]); }
  quickSort3(0, n - 1);
  for (int i = 0; i < n; i++) { printf("%d ", nums[i]); }
  return 0;
}
```

### âœ… ä¼˜åŠ¿åœºæ™¯
- è¾“å…¥åŒ…å«**å¤§é‡é‡å¤å…ƒç´ **ï¼ˆå¦‚ `[5,5,5,1,5,9,5]`ï¼‰ã€‚
- æ—¶é—´å¤æ‚åº¦å¯æ¥è¿‘ $O(n)$ã€‚
- æ˜¯å¤„ç†â€œé‡å¤å¯†é›†å‹â€æ•°æ®çš„æœ€ä½³å¿«æ’å˜ç§ã€‚

---

## äº”ã€æ€»ç»“ä¸ä½¿ç”¨å»ºè®®

| æ–¹æ³•         | é€‚ç”¨åœºæ™¯                   | æ˜¯å¦æ¨è           |
| ------------ | -------------------------- | ------------------ |
| `quickSort1` | æ•™å­¦æ¼”ç¤ºï¼ˆå±•ç¤ºéšæœºåŒ–æ€æƒ³ï¼‰ | âŒ ä¸æ¨èï¼ˆæœ‰ç¼ºé™·ï¼‰ |
| `quickSort2` | é€šç”¨æ’åºã€ç«èµ›ã€ä¸€èˆ¬åº”ç”¨   | âœ… å¼ºçƒˆæ¨è         |
| `quickSort3` | å«å¤§é‡é‡å¤å…ƒç´ çš„æ•°æ®       | âœ… æ¨è             |

> ğŸ’¡ **æœ€ä½³å®è·µ**ï¼š  
> - æ—¥å¸¸ä½¿ç”¨ â†’ `quickSort2`  
> - å·²çŸ¥æ•°æ®é‡å¤ç‡é«˜ â†’ `quickSort3`ï¼ˆä¿®æ­£ç‰ˆï¼‰  
> - ç”Ÿäº§ç¯å¢ƒ â†’ ç›´æ¥ä½¿ç”¨ `std::sort`ï¼ˆåŸºäº Introsortï¼Œæ›´å¥å£®ï¼‰

